<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Frameset//EN""http://www.w3.org/TR/REC-html40/frameset.dtd">
<HTML>
<HEAD>
<!--Generated by UnDox 1.0.3 Copyright (c) 2000 Epic Games. UnDox created and mainteained by Bruce Shankle - bruce@epicgames.com -->
<TITLE>
XIII.XIIIPlayerController
</TITLE>
<LINK REL ="stylesheet" TYPE="text/css" HREF="stylesheet.css" TITLE="Style">
</HEAD>
<BODY BGCOLOR="white" vlink="#0000FF" alink="#0000FF">
<H2>
<FONT SIZE="-1">
XIII</FONT>
<BR>
Class  XIIIPlayerController</H2>
<FONT SIZE="-1">source: C:\XIII\XIII\Classes\XIIIPlayerController.uc</FONT>
<PRE>
<a href="Core.Object.html">Core.Object</a>
   |
   +--<a href="Engine.Actor.html">Engine.Actor</a>
      |
      +--<a href="Engine.Controller.html">Engine.Controller</a>
         |
         +--<a href="Engine.PlayerController.html">Engine.PlayerController</a>
            |
            +--<b>XIII.XIIIPlayerController</b>
</PRE>
<TABLE><TR><TD><B>Direct Known Subclasses:</B><a href="XIIIMP.XIIIMPPlayerController.html">XIIIMPPlayerController</a></TD></TR></TABLE>
<hr/>class <b>XIIIPlayerController</b><br>
extends <a href="Engine.PlayerController.html">Engine.PlayerController</a>
<p/>
<xmp>//-----------------------------------------------------------
//
//-----------------------------------------------------------
</xmp><br><TABLE BORDER="1" CELLPADDING="3" CELLSPACING="0" WIDTH="100%">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TD COLSPAN=2><FONT SIZE="+2">
<B>Variables</B></FONT></TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<a href="Engine.Actor.html">Actor</a></CODE></FONT></TD>
<TD><CODE><B><A HREF="#L54">CamView </A></B></CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   Used for viewing through a cam. </TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L30">CamViewMode </A></B></CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   time cumul </TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<a href="XIII.HookPoint.html">HookPoint</a></CODE></FONT></TD>
<TD><CODE><B><A HREF="#L47">ClimbHookPoint </A></B></CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   HP to use when climbing up at top of the rope </TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;eDrawType</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L53">DT_mem </A></B></CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   Used for viewing through a cam. </TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;vector</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L59">DoorClimbMove </A></B></CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   Movement if climbing door to check the end of climb. </TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;vector</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L57">DoorLockedNormal </A></B></CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   used for climbing doors </TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;vector</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L58">DoorLockedPos </A></B></CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   used for climbing doors </TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<a href="Engine.Actor.html">Actor</a></CODE></FONT></TD>
<TD><CODE><B><A HREF="#L56">DoorToClimb </A></B></CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   Door that is climbed </TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<a href="Engine.ForceFeedbackController.html">ForceFeedbackController</a></CODE></FONT></TD>
<TD><CODE><B><A HREF="#L83">FFController </A></B></CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   For ForceFeedBack controls </TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;color</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L3935">FilterColor </A></B></CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   La couleur courante. </TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;float</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L3937">FilterColorSpeed </A></B></CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   La vitesse de convergence. </TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;color</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L3936">FilterColorWanted </A></B></CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   La couleur vers laquelle le moteur doit converger. </TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<a href="XIII.Hook.html">Hook</a></CODE></FONT></TD>
<TD><CODE><B><A HREF="#L46">HookUsed </A></B></CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   the hook used when in Hooked State </TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<a href="XIII.XIIIPlayerInteraction.html">XIIIPlayerInteraction</a></CODE></FONT></TD>
<TD><CODE><B><A HREF="#L62">MyInteraction </A></B></CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   used for climbing doors </TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;string</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L91">MyInteractionClass </A></B></CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   because color.a is int & we need float </TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;vector</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L60">OldDoorClimbPos </A></B></CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   used for climbing doors </TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<a href="XIII.XIIIItems.html">XIIIItems</a></CODE></FONT></TD>
<TD><CODE><B><A HREF="#L37">OldItem </A></B></CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   to memorize Item when climbing doors </TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;byte</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L36">OldWeap </A></B></CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   to memorize weapon when switching weapons/items modes </TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<a href="XIII.OnoFalling.html">OnoFalling</a></CODE></FONT></TD>
<TD><CODE><B><A HREF="#L70">OnoF </A></B></CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   used for climbing doors </TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;float</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L41">SniperPitch </A></B></CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   Used for the breath movement in sniping zoom. </TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;float</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L40">SniperYaw </A></B></CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   Used for the breath movement in sniping zoom. </TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;string</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L34">StatsMem </A></B></CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   the string that will be used to memorize stats on clients </TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<a href="XIII.HookNavPoint.html">HookNavPoint</a></CODE></FONT></TD>
<TD><CODE><B><A HREF="#L48">TargetHookClimb </A></B></CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   HNP to climb to </TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<a href="Engine.VideoPlayer.html">VideoPlayer</a></CODE></FONT></TD>
<TD><CODE><B><A HREF="#L84">VP </A></B></CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   Used to play videos </TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;float</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L89">VignetteAlpha </A></B></CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   because color.a is int & we need float </TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;float</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L87">VignetteAlphaDecFactor </A></B></CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   Used for flash SFXs (FlashBang </TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;float</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L86">VignetteFlashDecFactor </A></B></CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   Used for flash SFXs (FlashBang) </TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;float</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L88">VignetteSFXduration </A></B></CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   Used for flash SFXs (FlashBang </TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<a href="XIII.XIIIPorte.html">XIIIPorte</a></CODE></FONT></TD>
<TD><CODE><B><A HREF="#L38">aDoor </A></B></CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   Door to be lockpicked </TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;bool</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L11">bAltZoomingSystem </A></B></CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   Used to block weapon switch while climbing doors. </TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;bool</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L23">bCheckTurnSpeed </A></B></CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   check turning speed </TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;bool</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L23">bCheckTurnSpeed </A></B></CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   check turning speed </TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;bool</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L13">bFixedCrosshair </A></B></CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   Player is hooked (to use it in walk/swim </TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;bool</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L14">bFloatingCrosshair </A></B></CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   Player is hooked (to use it in walk/swim </TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;bool</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L12">bHooked </A></B></CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   Player is hooked (to use it in walk/swim </TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;bool</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L16">bMenuIsActive </A></B></CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   If true, no other display allowed </TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;bool</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L20">bOkForMoving </A></B></CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   Used to wait for first rendered frame (first postrender called) to activate player movement (else will be able to move while init). </TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;bool</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L8">bPickingUp </A></B></CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   Bool to validate the GameInfo HandlePickupQuery </TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;bool</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L10">bPressedDuck </A></B></CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   Used to block weapon switch while climbing doors. </TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;bool</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L19">bRenderPortal </A></B></CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   if true, then rotation will be assisted by a 'lock' when strafing around target (Halo-like) </TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;bool</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L17">bRotationAssist </A></B></CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   if true, then rotation will be assisted by a 'lock' when strafing around target (Halo-like) </TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;bool</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L5">bTurnWanted </A></B></CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   For 90/180 turns </TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;bool</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L7">bWaitForWeaponMode </A></B></CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   true if waiting for a changedweapon order </TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;bool</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L9">bWeaponBlock </A></B></CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   Used to block weapon switch while climbing doors. </TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;bool</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L6">bWeaponMode </A></B></CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   true if weapons are active, false if items are active </TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;float</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L29">fCamViewPercent </A></B></CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   time cumul </TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;float</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L97">fCrosshairSize </A></B></CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   0 = off, 1 = On on target, 2 = always on. </TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;float</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L42">fSniperPrecision </A></B></CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   Used for the breath movement in sniping zoom. </TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;float</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L26">fTurnDeltaTime </A></B></CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   time cumul </TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;float</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L26">fTurnDeltaTime </A></B></CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   time cumul </TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L25">fTurnInc </A></B></CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   store turning values (90/180/270/360/720</TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;float</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L24">fTurnSpeed[5] </A></B></CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   store turning values (90/180/270/360/720</TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;float</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L24">fTurnSpeed[5] </A></B></CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   store turning values (90/180/270/360/720</TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;float</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L51">fTyrolSpeed </A></B></CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   For Tyrol Behaviour </TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;sound</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L63">hCLimbDoorSound </A></B></CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   used for climbing doors </TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;sound</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L72">hCamViewBeginUseSound </A></B></CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   used for climbing doors </TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;sound</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L73">hCamViewInUseSound </A></B></CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   used for climbing doors </TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;sound</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L64">hEndClimbDoorSound </A></B></CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   used for climbing doors </TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;sound</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L76">hEndClimbLadderSound </A></B></CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   used for climbing doors </TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;sound</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L94">hTyrolEndSound </A></B></CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   because color.a is int & we need float </TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;sound</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L93">hTyrolStartSound </A></B></CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   because color.a is int & we need float </TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L96">iCrosshairMode </A></B></CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   0 = off, 1 = On on target, 2 = always on. </TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L69">iGameEndedRandEffect </A></B></CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   used for climbing doors </TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<a href="XIII.MultiViewport.html">MultiViewport</a></CODE></FONT></TD>
<TD><CODE><B><A HREF="#L31">multiViewport </A></B></CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   time cumul </TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;rotator</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L68">rGameEndedCamRot </A></B></CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   used for climbing doors </TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;vector</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L67">vGameEndedCamLoc </A></B></CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   used for climbing doors </TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;vector</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L43">vSniperOffset </A></B></CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   Used for the breath movement in sniping zoom. </TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;vector</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L44">vSniperOffsetSpeed </A></B></CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   Used for the breath movement in sniping zoom. </TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;vTyrolEnd,</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L50">vTyrolDir </A></B></CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   For Tyrol Behaviour </TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;vector</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L80">vWeaponFeedBack </A></B></CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   to simulate weapon feed back while firing </TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;vector</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L81">vWeaponFeedBackReturn </A></B></CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   to return to normal pos after firing </TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<a href="Engine.XboxLiveManager.html">XboxLiveManager</a></CODE></FONT></TD>
<TD><CODE><B><A HREF="#L33">xboxlive </A></B></CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   time cumul </TD></TR>
</TD></TR><TABLE><br>
<TABLE BORDER="1" CELLPADDING="3" CELLSPACING="0" WIDTH="100%">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TD COLSPAN=2><FONT SIZE="+2">
<B>States</B></FONT></TD>
</TR>
<TR><TD><a href="#STATE_Kicked">Kicked</a>, <a href="#STATE_NoMove">NoMove</a>, <a href="#STATE_NoRotation">NoRotation</a>, <a href="#STATE_WaitForFirstDisplay">WaitForFirstDisplay</a>, <a href="#STATE_NoControl">NoControl</a>, <a href="#STATE_PlayingVideo">PlayingVideo</a>, <a href="#STATE_GameEndedSuccess">GameEndedSuccess</a>, <a href="#STATE_GameEndedFalling">GameEndedFalling</a>, <a href="#STATE_GameEndedDrown">GameEndedDrown</a>, <a href="#STATE_GameEndedDeath">GameEndedDeath</a>, <a href="#STATE_GameEnded">GameEnded</a>, <a href="#STATE_ClimbToHookNavPoint">ClimbToHookNavPoint</a>, <a href="#STATE_OldItem">OldItem</a>, <a href="#STATE_OldItem">OldItem</a>, <a href="#STATE_PlayerGunning">PlayerGunning</a>, <a href="#STATE_ClimbDoor">ClimbDoor</a>, <a href="#STATE_MayClimbDoor">MayClimbDoor</a>, <a href="#STATE_CameraView">CameraView</a>, <a href="#STATE_BossView">BossView</a>, <a href="#STATE_Tyroling">Tyroling</a>, <a href="#STATE_Hooked">Hooked</a>, <a href="#STATE_PlayerSwimming">PlayerSwimming</a>, <a href="#STATE_PlayerWalking">PlayerWalking</a>, <a href="#STATE_PlayerClimbing">PlayerClimbing</a></TD></TR><TABLE>
<A NAME="function_summary"/>
<TABLE BORDER="1" CELLPADDING="3" CELLSPACING="0" WIDTH="100%">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TD COLSPAN=2><FONT SIZE="+2">
<B>Function Summary</B></FONT></TD>
</TR>
<br><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L307">AAM</A></B>(int i)</CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<pre>//_____________________________________________________________________________
</pre></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L1764">ActivateItem</A></B>()</CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<pre>//_____________________________________________________________________________
// The player wants to active selected item
</pre></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;rotator</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L953">AdjustAim</A></B>(<a href="Engine.Ammunition.html">Ammunition</a> FiredAmmunition, vector projStart, int AimCalcMode)</CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<pre>// ELR computes AimSpot and return rotator(AimSpot - projStart)
//Simulated function rotator AdjustAim(float projSpeed, vector projStart, int aimerror, bool bLeadTarget, bool bWarnTarget, bool bTossed, bool bTrySplash)
// AimCalcMode is used as 0 = weapon firing, 1 = interface aim anticipation
</pre></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L906">AdjustView</A></B>(float DeltaTime)</CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<pre>//_____________________________________________________________________________
// ELR made zooming speed higher
</pre></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;bool</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L1913">AllowHooking</A></B>()</CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<pre>//_____________________________________________________________________________
</pre></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L1128">AltFire</A></B>(optional float)</CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<pre>//_____________________________________________________________________________
</pre></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L339">AutoPickup</A></B>(bool b)</CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<pre>//_____________________________________________________________________________
</pre></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L448">BehindView</A></B>(Bool B)</CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<pre>//____________________________________________________________________________
// ELR Override this
</pre></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;bool</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L1775">CanUseLockPick</A></B>()</CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<pre>//_____________________________________________________________________________
// ELR - Do we still pick the lock ? return true if no.
</pre></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L1806">CancelPickLock</A></B>()</CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<pre>//_____________________________________________________________________________
// ELR - Do we still pick the lock ? return true if no.
</pre></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L192">ChangeSkin</A></B>(string NewSkinCode)</CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<pre>//_____________________________________________________________________________
</pre></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;bool</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L1784">CheckPickLock</A></B>()</CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<pre>//_____________________________________________________________________________
// ELR - Do we still pick the lock ? return true if no.
</pre></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<br/>simulated</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L221">ClientAddDamageWarn</A></B>(int RelativeHitLoc)</CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<pre>//____________________________________________________________________
</pre></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L2513">ClientGameEnded</A></B>()</CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<pre>//_____________________________________________________________________________
</pre></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L763">ClientRestart</A></B>()</CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<pre>//_____________________________________________________________________________
</pre></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L464">ClientSetBehindView</A></B>(bool B)</CODE></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L896">ClientTargetHighLight</A></B>(int Alpha, float TargetHighLight, float Duration)</CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<pre>//_____________________________________________________________________________
</pre></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L331">CrosshairMode</A></B>(int i)</CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<pre>//_____________________________________________________________________________
exec </pre></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L363">CrosshairSize</A></B>(Float f)</CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<pre>//_____________________________________________________________________________
</pre></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L322">DBInput</A></B>(bool b)</CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<pre>//_____________________________________________________________________________
exec </pre></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L315">DBTurn</A></B>()</CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<pre>//_____________________________________________________________________________
exec </pre></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L284">DetailLevel</A></B>(int i)</CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<pre>//_____________________________________________________________________________
</pre></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L696">DisplayDebug</A></B>(<a href="Engine.Canvas.html">Canvas</a> C, out float, out float)</CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<pre>//_____________________________________________________________________________
</pre></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L379">DoHideHUD</A></B>(bool B)</CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<pre>//_____________________________________________________________________________
</pre></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L982">Duck</A></B>(optional float)</CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<pre>//_____________________________________________________________________________
</pre></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L227">EnterStartState</A></B>()</CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<pre>//_____________________________________________________________________________
</pre></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L1069">Fire</A></B>(optional float)</CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<pre>//_____________________________________________________________________________
// The player wants to fire.
</pre></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L347">FixCrosshairMode</A></B>(int i)</CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<pre>//_____________________________________________________________________________
exec </pre></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L354">FloatCrosshairMode</A></B>(int i)</CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<pre>//_____________________________________________________________________________
exec </pre></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L275">FlowerPower</A></B>(int i)</CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<pre>//_____________________________________________________________________________
</pre></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L1054">ForceReload</A></B>()</CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<pre>//_____________________________________________________________________________
// can't reload if have grabbed corpse/pawn
</pre></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L2387">GoClimbHookNavPoint</A></B>(<a href="XIII.HookPoint.html">HookPoint</a> HP, <a href="XIII.HookNavPoint.html">HookNavPoint</a> HNP)</CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<pre>//_____________________________________________________________________________
// at top of a rope, climb up to the hooknavpoint
</pre></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L2378">GoHooking</A></B>(<a href="XIII.Hook.html">Hook</a> H)</CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<pre>//_____________________________________________________________________________
// ELR - Here we send the controller into hooked state
</pre></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L1927">GoTyroling</A></B>(<a href="XIII.XIIITyrolNavPoint.html">XIIITyrolNavPoint</a> StartPoint, <a href="XIII.XIIITyrolNavPoint.html">XIIITyrolNavPoint</a> EndPoint, float TyrolSpeed)</CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<pre>//_____________________________________________________________________________
// Set up the tyroling params, called by TyrolTrigger
</pre></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L268">GoreLevel</A></B>(int i)</CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<pre>//_____________________________________________________________________________
</pre></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L1580">Grab</A></B>()</CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<pre>//_____________________________________________________________________________
</pre></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L1216">HideWeapon</A></B>()</CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<pre>//_____________________________________________________________________________
// ELR hide/unhide Weapon (Used by the DecoWeapon to hide weapon then put it back when used)
</pre></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L242">ImBoss</A></B>()</CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<pre>//_____________________________________________________________________________
exec </pre></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L2448">Jump</A></B>(optional float)</CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<pre>//_____________________________________________________________________________
// Normal gameplay execs
// Type the name of the exec function at the console to execute it
</pre></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L291">KillTarget</A></B>(int i)</CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<pre>//_____________________________________________________________________________
</pre></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L371">LogInteraction</A></B>()</CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<pre>//_____________________________________________________________________________
exec </pre></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L249">LogInteractives</A></B>()</CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<pre>//_____________________________________________________________________________
exec </pre></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<br/>simulated</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L2480">MatchStarting</A></B>()</CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<pre>//_____________________________________________________________________________
// called when gameplay actually starts
</pre></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;bool</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L2398">NearWall</A></B>(float walldist)</CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<pre>//_____________________________________________________________________________
// ELR
</pre></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L1284">NextWeapon</A></B>()</CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<pre>//_____________________________________________________________________________
</pre></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L594">PawnDied</A></B>()</CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<pre>//_____________________________________________________________________________
// ::DBUG::
</pre></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L1231">PrevWeapon</A></B>()</CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<pre>//_____________________________________________________________________________
</pre></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L988">QuickHeal</A></B>()</CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<pre>//_____________________________________________________________________________
</pre></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L1044">ReLoad</A></B>()</CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<pre>//_____________________________________________________________________________
// ELR Use the ForceReload function of base weapons functions
</pre></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<br/>simulated</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L785">RenderScreenOverlays</A></B>(<a href="Engine.Canvas.html">Canvas</a> C)</CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<pre>//_____________________________________________________________________________
</pre></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L755">RestartLevel</A></B>()</CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<pre>//_____________________________________________________________________________
</pre></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L2366">RestoreView</A></B>()</CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<pre>//_____________________________________________________________________________
</pre></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<a href="Engine.Actor.html">Actor</a></CODE></FONT></TD>
<TD><CODE><B><A HREF="#L1873">ReturnTrace</A></B>(out vector, out vector, vector End, vector Start, bool bActor, optional vector, optional out, optional int)</CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<pre>//_____________________________________________________________________________
// ::TODO:: put in native (may not optimize the trace but everytinh else & called each frame so...)
</pre></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L637">RumbleFX</A></B>(int FXNum)</CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<pre>//_____________________________________________________________________________
// Setup the ForceFeedbackController
</pre></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L1945">SearchPawn</A></B>(<a href="XIII.XIIIPawn.html">XIIIPawn</a> P)</CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<pre>//_____________________________________________________________________________
</pre></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L117">SelectWeapon</A></B>(byte F)</CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<pre>//_____________________________________________________________________________
// The player wants to switch to weapon group number F.
</pre></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L213">ServerUpdateSkin</A></B>(string NewSkinCode)</CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<pre>//_____________________________________________________________________________
</pre></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L2340">SetCamView</A></B>(<a href="Engine.Actor.html">Actor</a> C, optional float)</CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<pre>//_____________________________________________________________________________
</pre></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L2354">SetCamViewPortal</A></B>(<a href="Engine.Actor.html">Actor</a> C, optional float)</CODE></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L612">SetRumbleFX</A></B>(bool B)</CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<pre>//_____________________________________________________________________________
// Setup the ForceFeedbackController
</pre></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L299">SetZoomSystem</A></B>(bool B)</CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<pre>//_____________________________________________________________________________
exec </pre></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L974">ShowInfo</A></B>()</CODE></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L965">ShowMenu</A></B>()</CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<pre>//_____________________________________________________________________________
</pre></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L690">SpawnDefaultHUD</A></B>()</CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<pre>//_____________________________________________________________________________
// SpawnDefaultHUD()
// Spawn a HUD (make sure that PlayerController always has valid HUD, even if
//  ClientSetHUD() hasn't been called
</pre></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L2510">StatUpdate</A></B>()</CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<pre>//_____________________________________________________________________________
</pre></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L1339">SwitchWeapon</A></B>(byte F)</CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<pre>//_____________________________________________________________________________
// we want the player to switch to weapon group number F.
</pre></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<br/>simulated</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L1163">SwitchWeaponMode</A></B>()</CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<pre>//_____________________________________________________________________________
// ELR hide/unhide Weapon
</pre></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L387">Teleport</A></B>(name N)</CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<pre>//_____________________________________________________________________________
exec </pre></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L406">TeleportNext</A></B>()</CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<pre>/*
exec </pre></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L1376">TestNI</A></B>()</CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<pre>//_____________________________________________________________________________
exec </pre></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;bool</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L2414">TryClimbDoor</A></B>(<a href="Engine.Actor.html">Actor</a> pDoorLocked, vector pDoorLockedPos, vector pDoorLockedNormal)</CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<pre>//_____________________________________________________________________________
</pre></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<a href="Engine.Powerups.html">Powerups</a></CODE></FONT></TD>
<TD><CODE><B><A HREF="#L1833">TryInteractWithDoor</A></B>(<a href="Engine.Actor.html">Actor</a> A)</CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<pre>//_____________________________________________________________________________
// return the inventory object to be used to interact with A
// should be used w/ Grab Controller function to automatically get the item out.
</pre></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<a href="Engine.Powerups.html">Powerups</a></CODE></FONT></TD>
<TD><CODE><B><A HREF="#L1854">TryInteractWithTrigger</A></B>(<a href="Engine.Actor.html">Actor</a> A)</CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<pre>//_____________________________________________________________________________
// return the inventory object to be used to interact with A
// should be used w/ Grab Controller function to automatically get the item out.
</pre></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;bool</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L1815">TryPickLock</A></B>()</CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<pre>//_____________________________________________________________________________
// ELR - Here we define if the controller allow the use of a lockpick
</pre></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;bool</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L1920">TryTyroling</A></B>()</CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<pre>//_____________________________________________________________________________
// ELR - check if we can send the controller into Tyrol state
</pre></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L1992">TurnAround</A></B>()</CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<pre>//_____________________________________________________________________________
// ELR Added to make b180Left and b180Right working.
// (Actually used as b90Left and b90Right :)
</pre></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L1117">UnFire</A></B>(optional float)</CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<pre>//_____________________________________________________________________________
// The player Release fire.
</pre></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L2034">UpdateRotation</A></B>(float DeltaTime, float maxPitch)</CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<pre>//_____________________________________________________________________________
</pre></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L1561">WeaponZoom</A></B>()</CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<pre>//_____________________________________________________________________________
</pre></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L1491">cNextItem</A></B>()</CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<pre>//_____________________________________________________________________________
// ELR Just to cancel it in some states
</pre></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L1420">cPrevItem</A></B>()</CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<pre>//_____________________________________________________________________________
// ELR Just to cancel it in some states
</pre></TD></TR>
</table>

<br><br><center>
<a name="STATE_Kicked">
<A NAME="State Kicked"/>
<TABLE BORDER="1" CELLPADDING="3" CELLSPACING="0" WIDTH="100%">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TD COLSPAN=2><FONT SIZE="+2">
<B>State Kicked Function Summary</B></FONT></TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L4245">PlayerMove</A></B>(float DeltaTime)</CODE></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L4244">UpdateRotation</A></B>(float DeltaTime, float maxPitch)</CODE></TD></TR>
</table>

<br/><br/><center>
<a name="STATE_NoMove">
<A NAME="State NoMove"/>
<TABLE BORDER="1" CELLPADDING="3" CELLSPACING="0" WIDTH="100%">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TD COLSPAN=2><FONT SIZE="+2">
<B>State NoMove Function Summary</B></FONT></TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L4189">PlayerMove</A></B>(float DeltaTime)</CODE></TD></TR>
</table>

<br/><br/><center>
<a name="STATE_NoRotation">
<A NAME="State NoRotation"/>
<TABLE BORDER="1" CELLPADDING="3" CELLSPACING="0" WIDTH="100%">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TD COLSPAN=2><FONT SIZE="+2">
<B>State NoRotation Function Summary</B></FONT></TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L4162">UpdateRotation</A></B>(float DeltaTime, float maxPitch)</CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<pre>// Anticrash if target actor was a breakable mover
//      Log("NoControl End State");
    }

    </pre></TD></TR>
</table>

<br/><br/><center>
<a name="STATE_WaitForFirstDisplay">
<A NAME="State WaitForFirstDisplay"/>
<TABLE BORDER="1" CELLPADDING="3" CELLSPACING="0" WIDTH="100%">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TD COLSPAN=2><FONT SIZE="+2">
<B>State WaitForFirstDisplay Function Summary</B></FONT></TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L4138">PlayerMove</A></B>(float DeltaTime)</CODE></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L4137">UpdateRotation</A></B>(float DeltaTime, float maxPitch)</CODE></TD></TR>
</table>

<br/><br/><center>
<a name="STATE_NoControl">
<A NAME="State NoControl"/>
<TABLE BORDER="1" CELLPADDING="3" CELLSPACING="0" WIDTH="100%">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TD COLSPAN=2><FONT SIZE="+2">
<B>State NoControl Function Summary</B></FONT></TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L4081">PlayerMove</A></B>(float DeltaTime)</CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<pre>//      Log("NoControl End State");
    }


    event PlayerCalcView(out actor ViewActor, out vector CameraLocation, out rotator CameraRotation )
    {
      Log("NoControl PlayerCalcView");
    	ViewActor = ViewTarget;
      CameraLocation = Location;
      CameraRotation = Rotation;
    }
*/</pre></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L4056">UpdateRotation</A></B>(float DeltaTime, float maxPitch)</CODE></TD></TR>
</table>

<br/><br/><center>
<a name="STATE_PlayingVideo">
<A NAME="State PlayingVideo"/>
<TABLE BORDER="1" CELLPADDING="3" CELLSPACING="0" WIDTH="100%">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TD COLSPAN=2><FONT SIZE="+2">
<B>State PlayingVideo Function Summary</B></FONT></TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L4026">Fire</A></B>(optional float)</CODE></TD></TR>
</table>

<br/><br/><center>
<a name="STATE_GameEndedSuccess">
<A NAME="State GameEndedSuccess"/>
<TABLE BORDER="1" CELLPADDING="3" CELLSPACING="0" WIDTH="100%">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TD COLSPAN=2><FONT SIZE="+2">
<B>State GameEndedSuccess Function Summary</B></FONT></TD>
</TR>
</table>

<br/><br/><center>
<a name="STATE_GameEndedFalling">
<A NAME="State GameEndedFalling"/>
<TABLE BORDER="1" CELLPADDING="3" CELLSPACING="0" WIDTH="100%">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TD COLSPAN=2><FONT SIZE="+2">
<B>State GameEndedFalling Function Summary</B></FONT></TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L3941">EndState</A></B>()</CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<pre>// dont replay the GameEnded BeginState()
</pre></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L3929">BeginState</A></B>()</CODE></TD></TR>
</table>

<br/><br/><center>
<a name="STATE_GameEndedDrown">
<A NAME="State GameEndedDrown"/>
<TABLE BORDER="1" CELLPADDING="3" CELLSPACING="0" WIDTH="100%">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TD COLSPAN=2><FONT SIZE="+2">
<B>State GameEndedDrown Function Summary</B></FONT></TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L3913">BeginState</A></B>()</CODE></TD></TR>
</table>

<br/><br/><center>
<a name="STATE_GameEndedDeath">
<A NAME="State GameEndedDeath"/>
<TABLE BORDER="1" CELLPADDING="3" CELLSPACING="0" WIDTH="100%">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TD COLSPAN=2><FONT SIZE="+2">
<B>State GameEndedDeath Function Summary</B></FONT></TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L3856">BeginState</A></B>()</CODE></TD></TR>
</table>

<br/><br/><center>
<a name="STATE_GameEnded">
<A NAME="State GameEnded"/>
<TABLE BORDER="1" CELLPADDING="3" CELLSPACING="0" WIDTH="100%">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TD COLSPAN=2><FONT SIZE="+2">
<B>State GameEnded Function Summary</B></FONT></TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L3693">BeginState</A></B>()</CODE></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L3688">Timer</A></B>()</CODE></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L3655">FindGoodView</A></B>()</CODE></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L3628">ServerMove</A></B>(float TimeStamp, vector InAccel, vector ClientLoc, bool NewbRun, bool NewbDuck, bool NewbJumpStatus, eDoubleClickDir DoubleClickMove, byte ClientRoll, int View, optional byte, optional int)</CODE></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L3592">PlayerMove</A></B>(float DeltaTime)</CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<pre>
    {
      Fire(F);
    }
*/</pre></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L3586">AltFire</A></B>(optional float)</CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<pre>
    {
      if ( Role < ROLE_Authority)
        return;
      if ( !bFrozen )
        ServerReStartGame();
      else if ( TimerRate <= 0 )
        SetTimer(1.5, false);
    }

    exec </pre></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L3576">Fire</A></B>(optional float)</CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<pre>/*
    exec </pre></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L3570">AltFire</A></B>(optional float)</CODE></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L3566">Fire</A></B>(optional float)</CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<pre>// ELR E3 CHEAT
</pre></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L3560">ServerReStartGame</A></B>()</CODE></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;bool</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L3547">IsInLethalVolume</A></B>(out optional)</CODE></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L3545">ThrowWeapon</A></B>()</CODE></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L3544">PawnDied</A></B>()</CODE></TD></TR>
</table>

<br/><br/><center>
<a name="STATE_ClimbToHookNavPoint">
<A NAME="State ClimbToHookNavPoint"/>
<TABLE BORDER="1" CELLPADDING="3" CELLSPACING="0" WIDTH="100%">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TD COLSPAN=2><FONT SIZE="+2">
<B>State ClimbToHookNavPoint Function Summary</B></FONT></TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L3515">ProcessMove</A></B>(float DeltaTime, vector NewAccel, eDoubleClickDir DoubleClickMove, rotator DeltaRot)</CODE></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L3510">EndState</A></B>()</CODE></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L3505">BeginState</A></B>()</CODE></TD></TR>
</table>

<br/><br/><center>
<a name="STATE_OldItem">
<A NAME="State OldItem"/>
<TABLE BORDER="1" CELLPADDING="3" CELLSPACING="0" WIDTH="100%">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TD COLSPAN=2><FONT SIZE="+2">
<B>State OldItem Function Summary</B></FONT></TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L3491">Fire</A></B>(float value)</CODE></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L3489">AltFire</A></B>(float value)</CODE></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L3488">Grab</A></B>()</CODE></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L3477">PlayerMove</A></B>(float DeltaTime)</CODE></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L3468">Leave</A></B>()</CODE></TD></TR>
</table>

<br/><br/><center>
<a name="STATE_OldItem">
<A NAME="State OldItem"/>
<TABLE BORDER="1" CELLPADDING="3" CELLSPACING="0" WIDTH="100%">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TD COLSPAN=2><FONT SIZE="+2">
<B>State OldItem Function Summary</B></FONT></TD>
</TR>
</table>

<br/><br/><center>
<a name="STATE_PlayerGunning">
<A NAME="State PlayerGunning"/>
<TABLE BORDER="1" CELLPADDING="3" CELLSPACING="0" WIDTH="100%">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TD COLSPAN=2><FONT SIZE="+2">
<B>State PlayerGunning Function Summary</B></FONT></TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L3423">EndState</A></B>()</CODE></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L3387">BeginState</A></B>()</CODE></TD></TR>
</table>

<br/><br/><center>
<a name="STATE_ClimbDoor">
<A NAME="State ClimbDoor"/>
<TABLE BORDER="1" CELLPADDING="3" CELLSPACING="0" WIDTH="100%">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TD COLSPAN=2><FONT SIZE="+2">
<B>State ClimbDoor Function Summary</B></FONT></TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L3332">ProcessMove</A></B>(float DeltaTime, vector NewAccel, eDoubleClickDir DoubleClickMove, rotator DeltaRot)</CODE></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L3307">EndState</A></B>()</CODE></TD></TR>
</table>

<br/><br/><center>
<a name="STATE_MayClimbDoor">
<A NAME="State MayClimbDoor"/>
<TABLE BORDER="1" CELLPADDING="3" CELLSPACING="0" WIDTH="100%">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TD COLSPAN=2><FONT SIZE="+2">
<B>State MayClimbDoor Function Summary</B></FONT></TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L3283">Timer</A></B>()</CODE></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L3260">BeginState</A></B>()</CODE></TD></TR>
</table>

<br/><br/><center>
<a name="STATE_CameraView">
<A NAME="State CameraView"/>
<TABLE BORDER="1" CELLPADDING="3" CELLSPACING="0" WIDTH="100%">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TD COLSPAN=2><FONT SIZE="+2">
<B>State CameraView Function Summary</B></FONT></TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L3239">EndState</A></B>()</CODE></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L3232">BeginState</A></B>()</CODE></TD></TR>
</table>

<br/><br/><center>
<a name="STATE_BossView">
<A NAME="State BossView"/>
<TABLE BORDER="1" CELLPADDING="3" CELLSPACING="0" WIDTH="100%">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TD COLSPAN=2><FONT SIZE="+2">
<B>State BossView Function Summary</B></FONT></TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L3216">EndState</A></B>()</CODE></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L3215">BeginState</A></B>()</CODE></TD></TR>
</table>

<br/><br/><center>
<a name="STATE_Tyroling">
<A NAME="State Tyroling"/>
<TABLE BORDER="1" CELLPADDING="3" CELLSPACING="0" WIDTH="100%">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TD COLSPAN=2><FONT SIZE="+2">
<B>State Tyroling Function Summary</B></FONT></TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L3183">ProcessMove</A></B>(float DeltaTime, vector NewAccel, eDoubleClickDir DoubleClickMove, rotator DeltaRot)</CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<pre>//__________________
</pre></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L3103">PlayerMove</A></B>(float DeltaTime)</CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<pre>//__________________
</pre></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L3096">EndState</A></B>()</CODE></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L3092">BeginState</A></B>()</CODE></TD></TR>
</table>

<br/><br/><center>
<a name="STATE_Hooked">
<A NAME="State Hooked"/>
<TABLE BORDER="1" CELLPADDING="3" CELLSPACING="0" WIDTH="100%">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TD COLSPAN=2><FONT SIZE="+2">
<B>State Hooked Function Summary</B></FONT></TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L3018">ProcessMove</A></B>(float DeltaTime, vector NewAccel, eDoubleClickDir DoubleClickMove, rotator DeltaRot)</CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<pre>// ELR 2nd ProcessMove, trying to get rid of vel/acc and setting the player's pos
    </pre></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L2926">PlayerMove</A></B>(float DeltaTime)</CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<pre>//_________________
    </pre></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L2919">EndState</A></B>()</CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<pre>
    {
      Pawn.bCanCrouch=False;
      Pawn.bCanClimbLadders=False;
      bPressedDuck=false;
    }
    </pre></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L2913">BeginState</A></B>()</CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<pre>extends PlayerWalking
{
    </pre></TD></TR>
</table>

<br/><br/><center>
<a name="STATE_PlayerSwimming">
<A NAME="State PlayerSwimming"/>
<TABLE BORDER="1" CELLPADDING="3" CELLSPACING="0" WIDTH="100%">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TD COLSPAN=2><FONT SIZE="+2">
<B>State PlayerSwimming Function Summary</B></FONT></TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L2902">EndState</A></B>()</CODE></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L2896">BeginState</A></B>()</CODE></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;bool</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L2857">NotifyPhysicsVolumeChange</A></B>(<a href="Engine.PhysicsVolume.html">PhysicsVolume</a> NewVolume)</CODE></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L2830">PlayerMove</A></B>(float DeltaTime)</CODE></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L2802">ProcessMove</A></B>(float DeltaTime, vector NewAccel, eDoubleClickDir DoubleClickMove, rotator DeltaRot)</CODE></TD></TR>
</table>

<br/><br/><center>
<a name="STATE_PlayerWalking">
<A NAME="State PlayerWalking"/>
<TABLE BORDER="1" CELLPADDING="3" CELLSPACING="0" WIDTH="100%">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TD COLSPAN=2><FONT SIZE="+2">
<B>State PlayerWalking Function Summary</B></FONT></TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L2673">PlayerMove</A></B>(float DeltaTime)</CODE></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L2576">ProcessMove</A></B>(float DeltaTime, vector NewAccel, eDoubleClickDir DoubleClickMove, rotator DeltaRot)</CODE></TD></TR>
</table>

<br/><br/><center>
<a name="STATE_PlayerClimbing">
<A NAME="State PlayerClimbing"/>
<TABLE BORDER="1" CELLPADDING="3" CELLSPACING="0" WIDTH="100%">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TD COLSPAN=2><FONT SIZE="+2">
<B>State PlayerClimbing Function Summary</B></FONT></TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L2550">ProcessMove</A></B>(float DeltaTime, vector NewAccel, eDoubleClickDir DoubleClickMove, rotator DeltaRot)</CODE></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L2538">EndState</A></B>()</CODE></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L2527">BeginState</A></B>()</CODE></TD></TR>
</table>

<br/><br/><center>
<hr/><center><FONT SIZE="-1">
Source Code</FONT>
</center><hr/>
<table width="90%" bgcolor="#000000"><tr><td><font color="#00FF00"><pre><code>
<a name="L1"><font color="white">00001</font>	//-----------------------------------------------------------
<a name="L2"><font color="white">00002</font>	//
<a name="L3"><font color="white">00003</font>	//-----------------------------------------------------------
<a name="L4"><font color="white">00004</font>	class XIIIPlayerController extends PlayerController;
<a name="L5"><font color="white">00005</font>	
<a name="L6"><font color="white">00006</font>	var bool bTurnWanted;           // For 90/180 turns
<a name="L7"><font color="white">00007</font>	var bool bWeaponMode;           // true if weapons are active, false if items are active
<a name="L8"><font color="white">00008</font>	var bool bWaitForWeaponMode;    // true if waiting for a changedweapon order
<a name="L9"><font color="white">00009</font>	var bool bPickingUp;            // Bool to validate the GameInfo HandlePickupQuery
<a name="L10"><font color="white">00010</font>	var bool bWeaponBlock;          // Used to block weapon switch while climbing doors.
<a name="L11"><font color="white">00011</font>	var bool bPressedDuck;
<a name="L12"><font color="white">00012</font>	var config bool bAltZoomingSystem;
<a name="L13"><font color="white">00013</font>	var bool bHooked;               // Player is hooked (to use it in walk/swim
<a name="L14"><font color="white">00014</font>	var config bool bFixedCrosshair;
<a name="L15"><font color="white">00015</font>	var config bool bFloatingCrosshair;
<a name="L16"><font color="white">00016</font>	
<a name="L17"><font color="white">00017</font>	var bool bMenuIsActive;         // If true, no other display allowed
<a name="L18"><font color="white">00018</font>	var config bool bRotationAssist;// if true, then rotation will be assisted by a 'lock' when strafing around target (Halo-like)
<a name="L19"><font color="white">00019</font>	// SE XBox Specific, for Cameras portal rendering
<a name="L20"><font color="white">00020</font>	var bool bRenderPortal;
<a name="L21"><font color="white">00021</font>	var bool bOkForMoving;          // Used to wait for first rendered frame (first postrender called) to activate player movement (else will be able to move while init).
<a name="L22"><font color="white">00022</font>	
<a name="L23"><font color="white">00023</font>	/*
<a name="L24"><font color="white">00024</font>	var config bool bCheckTurnSpeed;// check turning speed
<a name="L25"><font color="white">00025</font>	var float fTurnSpeed[5];        // store turning values (90/180/270/360/720)
<a name="L26"><font color="white">00026</font>	var int fTurnInc;
<a name="L27"><font color="white">00027</font>	var float fTurnDeltaTime;       // time cumul
<a name="L28"><font color="white">00028</font>	*/
<a name="L29"><font color="white">00029</font>	
<a name="L30"><font color="white">00030</font>	var float fCamViewPercent;
<a name="L31"><font color="white">00031</font>	var int CamViewMode;
<a name="L32"><font color="white">00032</font>	var MultiViewport multiViewport;
<a name="L33"><font color="white">00033</font>	// SE Xbox End
<a name="L34"><font color="white">00034</font>	var XboxLiveManager xboxlive;
<a name="L35"><font color="white">00035</font>	var string StatsMem;            // the string that will be used to memorize stats on clients
<a name="L36"><font color="white">00036</font>	
<a name="L37"><font color="white">00037</font>	var byte OldWeap;               // to memorize weapon when switching weapons/items modes
<a name="L38"><font color="white">00038</font>	var XIIIItems OldItem;          // to memorize Item when climbing doors
<a name="L39"><font color="white">00039</font>	var XIIIPorte aDoor;            // Door to be lockpicked
<a name="L40"><font color="white">00040</font>	
<a name="L41"><font color="white">00041</font>	var float SniperYaw;            // Used for the breath movement in sniping zoom.
<a name="L42"><font color="white">00042</font>	var float SniperPitch;          // Used for the breath movement in sniping zoom.
<a name="L43"><font color="white">00043</font>	var float fSniperPrecision;     // Used for the breath movement in sniping zoom.
<a name="L44"><font color="white">00044</font>	var vector vSniperOffset;       // Used for the breath movement in sniping zoom.
<a name="L45"><font color="white">00045</font>	var vector vSniperOffsetSpeed;  // Used for the breath movement in sniping zoom.
<a name="L46"><font color="white">00046</font>	
<a name="L47"><font color="white">00047</font>	var Hook HookUsed;              // the hook used when in Hooked State
<a name="L48"><font color="white">00048</font>	var HookPoint ClimbHookPoint;   // HP to use when climbing up at top of the rope
<a name="L49"><font color="white">00049</font>	var HookNavPoint TargetHookClimb; // HNP to climb to
<a name="L50"><font color="white">00050</font>	
<a name="L51"><font color="white">00051</font>	var vector vTyrolStart, vTyrolEnd, vTyrolDir;     // For Tyrol Behaviour
<a name="L52"><font color="white">00052</font>	var float fTyrolSpeed;                            // For Tyrol Behaviour
<a name="L53"><font color="white">00053</font>	
<a name="L54"><font color="white">00054</font>	var eDrawType DT_mem;           // Used for viewing through a cam.
<a name="L55"><font color="white">00055</font>	var actor CamView;              // Used for viewing through a cam.
<a name="L56"><font color="white">00056</font>	
<a name="L57"><font color="white">00057</font>	var actor DoorToClimb;          // Door that is climbed
<a name="L58"><font color="white">00058</font>	var vector DoorLockedNormal;    // used for climbing doors
<a name="L59"><font color="white">00059</font>	var vector DoorLockedPos;       // used for climbing doors
<a name="L60"><font color="white">00060</font>	var vector DoorClimbMove;       // Movement if climbing door to check the end of climb.
<a name="L61"><font color="white">00061</font>	var vector OldDoorClimbPos;     // used for climbing doors
<a name="L62"><font color="white">00062</font>	
<a name="L63"><font color="white">00063</font>	var XIIIPlayerInteraction MyInteraction;
<a name="L64"><font color="white">00064</font>	var sound hCLimbDoorSound;
<a name="L65"><font color="white">00065</font>	var sound hEndClimbDoorSound;
<a name="L66"><font color="white">00066</font>	
<a name="L67"><font color="white">00067</font>	// EndGame Vars
<a name="L68"><font color="white">00068</font>	var vector vGameEndedCamLoc;
<a name="L69"><font color="white">00069</font>	var rotator rGameEndedCamRot;
<a name="L70"><font color="white">00070</font>	var int iGameEndedRandEffect;
<a name="L71"><font color="white">00071</font>	var OnoFalling OnoF;
<a name="L72"><font color="white">00072</font>	
<a name="L73"><font color="white">00073</font>	var sound hCamViewBeginUseSound;
<a name="L74"><font color="white">00074</font>	var sound hCamViewInUseSound;
<a name="L75"><font color="white">00075</font>	//var sound hCamViewEndUseSound;
<a name="L76"><font color="white">00076</font>	
<a name="L77"><font color="white">00077</font>	var sound hEndClimbLadderSound;
<a name="L78"><font color="white">00078</font>	//var sound hEnteringWaterSound;
<a name="L79"><font color="white">00079</font>	//var sound hExitingWaterSound;
<a name="L80"><font color="white">00080</font>	
<a name="L81"><font color="white">00081</font>	var vector vWeaponFeedBack;       // to simulate weapon feed back while firing
<a name="L82"><font color="white">00082</font>	var vector vWeaponFeedBackReturn; // to return to normal pos after firing
<a name="L83"><font color="white">00083</font>	
<a name="L84"><font color="white">00084</font>	var ForceFeedbackController FFController;   // For ForceFeedBack controls
<a name="L85"><font color="white">00085</font>	var VideoPlayer VP;               // Used to play videos
<a name="L86"><font color="white">00086</font>	
<a name="L87"><font color="white">00087</font>	var float VignetteFlashDecFactor; // Used for flash SFXs (FlashBang)
<a name="L88"><font color="white">00088</font>	var float VignetteAlphaDecFactor; // Used for flash SFXs (FlashBang
<a name="L89"><font color="white">00089</font>	var float VignetteSFXduration;    // Used for flash SFXs (FlashBang
<a name="L90"><font color="white">00090</font>	var float VignetteAlpha;          // because color.a is int &amp; we need float
<a name="L91"><font color="white">00091</font>	
<a name="L92"><font color="white">00092</font>	var string MyInteractionClass;
<a name="L93"><font color="white">00093</font>	
<a name="L94"><font color="white">00094</font>	var sound hTyrolStartSound;
<a name="L95"><font color="white">00095</font>	var sound hTyrolEndSound;
<a name="L96"><font color="white">00096</font>	
<a name="L97"><font color="white">00097</font>	var globalconfig int iCrosshairMode;    // 0 = off, 1 = On on target, 2 = always on.
<a name="L98"><font color="white">00098</font>	var globalconfig float fCrosshairSize;
<a name="L99"><font color="white">00099</font>	
<a name="L100"><font color="white">00100</font>	//_____________________________________________________________________________
<a name="L101"><font color="white">00101</font>	// ELR Replicate things
<a name="L102"><font color="white">00102</font>	replication
<a name="L103"><font color="white">00103</font>	{
<a name="L104"><font color="white">00104</font>	    // Variables the server should send to the client.
<a name="L105"><font color="white">00105</font>	    reliable if ( Role==ROLE_Authority )
<a name="L106"><font color="white">00106</font>	      bWeaponMode, bWaitForWeaponMode, ClientTargetHighLight;
<a name="L107"><font color="white">00107</font>	
<a name="L108"><font color="white">00108</font>	    // Functions the server should send to the client.
<a name="L109"><font color="white">00109</font>	  	unreliable if( Role==ROLE_Authority )
<a name="L110"><font color="white">00110</font>	      ClientViewFeedBackSetup, ClientAddDamageWarn;
<a name="L111"><font color="white">00111</font>	
<a name="L112"><font color="white">00112</font>	  	reliable if( Role&lt;ROLE_Authority )
<a name="L113"><font color="white">00113</font>	  	  ServerUpdateSkin;
<a name="L114"><font color="white">00114</font>	}
<a name="L115"><font color="white">00115</font>	
<a name="L116"><font color="white">00116</font>	//_____________________________________________________________________________
<a name="L117"><font color="white">00117</font>	// The player wants to switch to weapon group number F.
<a name="L118"><font color="white">00118</font>	exec function SelectWeapon( byte F )
<a name="L119"><font color="white">00119</font>	{
<a name="L120"><font color="white">00120</font>	    local weapon newWeapon;
<a name="L121"><font color="white">00121</font>	
<a name="L122"><font color="white">00122</font>	    if ( Pawn.region.Zone.FlashEffectDesc.IsActivated )
<a name="L123"><font color="white">00123</font>	      return;
<a name="L124"><font color="white">00124</font>	    if ( (Pawn.PendingWeapon != none) &amp;&amp; (DecoWeapon(Pawn.PendingWeapon) != none) )
<a name="L125"><font color="white">00125</font>	      return;
<a name="L126"><font color="white">00126</font>	    if ( (Level.Pauser!=None) || (Pawn == None) || (Pawn.Inventory == None) )
<a name="L127"><font color="white">00127</font>	      return;
<a name="L128"><font color="white">00128</font>	
<a name="L129"><font color="white">00129</font>	    if ( (Pawn.Weapon != None) &amp;&amp; (Pawn.Weapon.Inventory != None) )
<a name="L130"><font color="white">00130</font>	      newWeapon = Pawn.Weapon.Inventory.WeaponSelect(F);
<a name="L131"><font color="white">00131</font>	    else
<a name="L132"><font color="white">00132</font>	      newWeapon = None;
<a name="L133"><font color="white">00133</font>	    if ( newWeapon == None )
<a name="L134"><font color="white">00134</font>	      newWeapon = Pawn.Inventory.WeaponSelect(F);
<a name="L135"><font color="white">00135</font>	
<a name="L136"><font color="white">00136</font>	    if ( newWeapon == None )
<a name="L137"><font color="white">00137</font>	      return;
<a name="L138"><font color="white">00138</font>	
<a name="L139"><font color="white">00139</font>	//    Log(&quot;SelectWeapon&quot;@NewWeapon);
<a name="L140"><font color="white">00140</font>	    if ( Pawn.Weapon == None )
<a name="L141"><font color="white">00141</font>	    {
<a name="L142"><font color="white">00142</font>	//      Log(&quot;  No Weapon&quot;);
<a name="L143"><font color="white">00143</font>	      if ( bWeaponMode )
<a name="L144"><font color="white">00144</font>	      {
<a name="L145"><font color="white">00145</font>	        if ( Pawn.Weapon != newWeapon )
<a name="L146"><font color="white">00146</font>	        {
<a name="L147"><font color="white">00147</font>	          Pawn.PendingWeapon = newWeapon;
<a name="L148"><font color="white">00148</font>	          Pawn.ChangedWeapon();
<a name="L149"><font color="white">00149</font>	        }
<a name="L150"><font color="white">00150</font>	      }
<a name="L151"><font color="white">00151</font>	      else if ( !bWaitForWeaponMode )
<a name="L152"><font color="white">00152</font>	      {
<a name="L153"><font color="white">00153</font>	        XIIIBaseHud(MyHud).fDrawWeaponsTimer = Level.TimeSeconds+2.0;
<a name="L154"><font color="white">00154</font>	        bWaitForWeaponMode = true;
<a name="L155"><font color="white">00155</font>	        Pawn.Weapon = NewWeapon;
<a name="L156"><font color="white">00156</font>	        SwitchWeaponMode();
<a name="L157"><font color="white">00157</font>	      }
<a name="L158"><font color="white">00158</font>	    }
<a name="L159"><font color="white">00159</font>	    else
<a name="L160"><font color="white">00160</font>	    {
<a name="L161"><font color="white">00161</font>	      if ( bWeaponMode )
<a name="L162"><font color="white">00162</font>	      {
<a name="L163"><font color="white">00163</font>	        if ( Pawn.Weapon != newWeapon )
<a name="L164"><font color="white">00164</font>	        {
<a name="L165"><font color="white">00165</font>	          Pawn.PendingWeapon = newWeapon;
<a name="L166"><font color="white">00166</font>	          if ( !Pawn.Weapon.PutDown() )
<a name="L167"><font color="white">00167</font>	            Pawn.PendingWeapon = None;
<a name="L168"><font color="white">00168</font>	        }
<a name="L169"><font color="white">00169</font>	      }
<a name="L170"><font color="white">00170</font>	      else
<a name="L171"><font color="white">00171</font>	      {
<a name="L172"><font color="white">00172</font>	        XIIIBaseHud(MyHud).fDrawWeaponsTimer = Level.TimeSeconds+2.0;
<a name="L173"><font color="white">00173</font>	        bWaitForWeaponMode = true;
<a name="L174"><font color="white">00174</font>	        Pawn.Weapon = NewWeapon;
<a name="L175"><font color="white">00175</font>	        SwitchWeaponMode();
<a name="L176"><font color="white">00176</font>	      }
<a name="L177"><font color="white">00177</font>	    }
<a name="L178"><font color="white">00178</font>	}
<a name="L179"><font color="white">00179</font>	
<a name="L180"><font color="white">00180</font>	//_____________________________________________________________________________
<a name="L181"><font color="white">00181</font>	simulated event IAmKicked()
<a name="L182"><font color="white">00182</font>	{
<a name="L183"><font color="white">00183</font>	    GotoState('Kicked', 'Begin');
<a name="L184"><font color="white">00184</font>	    Pawn.bTearOff = true;
<a name="L185"><font color="white">00185</font>	    bTearOff = true;
<a name="L186"><font color="white">00186</font>	    Pawn.Died( None, class'DTSuicided', Pawn.Location );
<a name="L187"><font color="white">00187</font>	    PlayerReplicationInfo.destroy();
<a name="L188"><font color="white">00188</font>	    PlayerReplicationInfo = none;
<a name="L189"><font color="white">00189</font>	}
<a name="L190"><font color="white">00190</font>	
<a name="L191"><font color="white">00191</font>	
<a name="L192"><font color="white">00192</font>	//_____________________________________________________________________________
<a name="L193"><font color="white">00193</font>	exec function ChangeSkin(string NewSkinCode)
<a name="L194"><font color="white">00194</font>	{
<a name="L195"><font color="white">00195</font>	    local int i;
<a name="L196"><font color="white">00196</font>	
<a name="L197"><font color="white">00197</font>	    // DO nothing in solo.
<a name="L198"><font color="white">00198</font>	    if ( Level.bLonePlayer )
<a name="L199"><font color="white">00199</font>	      return;
<a name="L200"><font color="white">00200</font>	
<a name="L201"><font color="white">00201</font>	//    Log(&quot;SKIN Exec ChangeSkin&quot;);
<a name="L202"><font color="white">00202</font>	
<a name="L203"><font color="white">00203</font>	    // don't replicate things for nothing if non valid code.
<a name="L204"><font color="white">00204</font>	    i = class'MeshSkinList'.Static.StaticFindSkinIndex(NewSkinCode);
<a name="L205"><font color="white">00205</font>	    if ( i &gt; class'MeshSkinList'.default.MeshSkinListInfo.Length )
<a name="L206"><font color="white">00206</font>	      return;
<a name="L207"><font color="white">00207</font>	
<a name="L208"><font color="white">00208</font>	    ServerUpdateSkin(Caps(left(NewSkinCode,4)));
<a name="L209"><font color="white">00209</font>	//    Pawn.PlayerReplicationInfo.SkinCodeName = NewSkinCode;
<a name="L210"><font color="white">00210</font>	//    XIIIMPPlayerPawn(Pawn).ChangeSkin();
<a name="L211"><font color="white">00211</font>	}
<a name="L212"><font color="white">00212</font>	
<a name="L213"><font color="white">00213</font>	//_____________________________________________________________________________
<a name="L214"><font color="white">00214</font>	function ServerUpdateSkin(string NewSkinCode)
<a name="L215"><font color="white">00215</font>	{
<a name="L216"><font color="white">00216</font>	//    Log(&quot;SKIN ServerUpdateSkin&quot;);
<a name="L217"><font color="white">00217</font>	    PlayerReplicationInfo.SkinCodeName = NewSkinCode; // will be replicated to all clients
<a name="L218"><font color="white">00218</font>	    Pawn.ChangeSkin();  // local change on server
<a name="L219"><font color="white">00219</font>	}
<a name="L220"><font color="white">00220</font>	
<a name="L221"><font color="white">00221</font>	//____________________________________________________________________
<a name="L222"><font color="white">00222</font>	simulated function ClientAddDamageWarn(int RelativeHitLoc)
<a name="L223"><font color="white">00223</font>	{
<a name="L224"><font color="white">00224</font>	    XIIIBaseHud(MyHud).AddDamageWarn(RelativeHitLoc);
<a name="L225"><font color="white">00225</font>	}
<a name="L226"><font color="white">00226</font>	
<a name="L227"><font color="white">00227</font>	//_____________________________________________________________________________
<a name="L228"><font color="white">00228</font>	function EnterStartState()
<a name="L229"><font color="white">00229</font>	{
<a name="L230"><font color="white">00230</font>		local name NewState;
<a name="L231"><font color="white">00231</font>	
<a name="L232"><font color="white">00232</font>		if ( Level.bLonePlayer &amp;&amp; !bOkForMoving )
<a name="L233"><font color="white">00233</font>		{
<a name="L234"><font color="white">00234</font>		  GotoState('WaitForFirstDisplay');
<a name="L235"><font color="white">00235</font>		  return;
<a name="L236"><font color="white">00236</font>		}
<a name="L237"><font color="white">00237</font>	  else
<a name="L238"><font color="white">00238</font>	    Super.EnterStartState();
<a name="L239"><font color="white">00239</font>	}
<a name="L240"><font color="white">00240</font>	
<a name="L241"><font color="white">00241</font>	/*
<a name="L242"><font color="white">00242</font>	//_____________________________________________________________________________
<a name="L243"><font color="white">00243</font>	exec function ImBoss()
<a name="L244"><font color="white">00244</font>	{
<a name="L245"><font color="white">00245</font>	    XIIIBaseHud(MyHud).AddBossBar(XIIIPawn(Pawn));
<a name="L246"><font color="white">00246</font>	}
<a name="L247"><font color="white">00247</font>	*/
<a name="L248"><font color="white">00248</font>	/*
<a name="L249"><font color="white">00249</font>	//_____________________________________________________________________________
<a name="L250"><font color="white">00250</font>	exec function LogInteractives()
<a name="L251"><font color="white">00251</font>	{
<a name="L252"><font color="white">00252</font>	    local Actor A;
<a name="L253"><font color="white">00253</font>	    local int i;
<a name="L254"><font color="white">00254</font>	
<a name="L255"><font color="white">00255</font>	    Log(&quot;BEGIN Interactive List&quot;);
<a name="L256"><font color="white">00256</font>	    i = 0;
<a name="L257"><font color="white">00257</font>	    foreach AllActors(class'Actor', A)
<a name="L258"><font color="white">00258</font>	    {
<a name="L259"><font color="white">00259</font>	      if ( A.bInteractive )
<a name="L260"><font color="white">00260</font>	      {
<a name="L261"><font color="white">00261</font>	        i++;
<a name="L262"><font color="white">00262</font>	        Log(&quot; -&quot;@i@A);
<a name="L263"><font color="white">00263</font>	      }
<a name="L264"><font color="white">00264</font>	    }
<a name="L265"><font color="white">00265</font>	    Log(&quot;END Interactive List&quot;);
<a name="L266"><font color="white">00266</font>	}
<a name="L267"><font color="white">00267</font>	*/
<a name="L268"><font color="white">00268</font>	//_____________________________________________________________________________
<a name="L269"><font color="white">00269</font>	exec function GoreLevel(int i)
<a name="L270"><font color="white">00270</font>	{
<a name="L271"><font color="white">00271</font>	    Level.Game.GoreLevel = i%2;
<a name="L272"><font color="white">00272</font>	    Level.Game.SaveConfig();
<a name="L273"><font color="white">00273</font>	}
<a name="L274"><font color="white">00274</font>	
<a name="L275"><font color="white">00275</font>	//_____________________________________________________________________________
<a name="L276"><font color="white">00276</font>	exec function FlowerPower(int i)
<a name="L277"><font color="white">00277</font>	{
<a name="L278"><font color="white">00278</font>	    if ( i != 0 )
<a name="L279"><font color="white">00279</font>	      Level.Game.GoreLevel = 0;
<a name="L280"><font color="white">00280</font>	    Level.Game.bAlternateMode = (i%2 == 1);
<a name="L281"><font color="white">00281</font>	    Level.Game.SaveConfig();
<a name="L282"><font color="white">00282</font>	}
<a name="L283"><font color="white">00283</font>	
<a name="L284"><font color="white">00284</font>	//_____________________________________________________________________________
<a name="L285"><font color="white">00285</font>	exec function DetailLevel(int i)
<a name="L286"><font color="white">00286</font>	{
<a name="L287"><font color="white">00287</font>	    Level.Game.DetailLevel = i%3;
<a name="L288"><font color="white">00288</font>	    Level.Game.SaveConfig();
<a name="L289"><font color="white">00289</font>	}
<a name="L290"><font color="white">00290</font>	
<a name="L291"><font color="white">00291</font>	//_____________________________________________________________________________
<a name="L292"><font color="white">00292</font>	exec function KillTarget(int i)
<a name="L293"><font color="white">00293</font>	{
<a name="L294"><font color="white">00294</font>	    if ( MyInteraction.FiringTargetActor != none )
<a name="L295"><font color="white">00295</font>	      MyInteraction.FiringTargetActor.TakeDamage(10000,Pawn,vect(0,0,1),vect(0,0,1),class'DTSuicided');
<a name="L296"><font color="white">00296</font>	}
<a name="L297"><font color="white">00297</font>	
<a name="L298"><font color="white">00298</font>	/*
<a name="L299"><font color="white">00299</font>	//_____________________________________________________________________________
<a name="L300"><font color="white">00300</font>	exec function SetZoomSystem(bool B)
<a name="L301"><font color="white">00301</font>	{
<a name="L302"><font color="white">00302</font>	    bAltZoomingSystem = B;
<a name="L303"><font color="white">00303</font>	    SaveConfig();
<a name="L304"><font color="white">00304</font>	}
<a name="L305"><font color="white">00305</font>	*/
<a name="L306"><font color="white">00306</font>	
<a name="L307"><font color="white">00307</font>	//_____________________________________________________________________________
<a name="L308"><font color="white">00308</font>	exec function AAM(int i)
<a name="L309"><font color="white">00309</font>	{
<a name="L310"><font color="white">00310</font>	    iAutoAimMode = i%2;
<a name="L311"><font color="white">00311</font>	    SaveConfig();
<a name="L312"><font color="white">00312</font>	}
<a name="L313"><font color="white">00313</font>	
<a name="L314"><font color="white">00314</font>	/*
<a name="L315"><font color="white">00315</font>	//_____________________________________________________________________________
<a name="L316"><font color="white">00316</font>	exec function DBTurn()
<a name="L317"><font color="white">00317</font>	{
<a name="L318"><font color="white">00318</font>	    bCheckTurnSpeed = !bCheckTurnSpeed;
<a name="L319"><font color="white">00319</font>	    SaveConfig();
<a name="L320"><font color="white">00320</font>	}
<a name="L321"><font color="white">00321</font>	
<a name="L322"><font color="white">00322</font>	//_____________________________________________________________________________
<a name="L323"><font color="white">00323</font>	exec function DBInput(bool b)
<a name="L324"><font color="white">00324</font>	{
<a name="L325"><font color="white">00325</font>	    PlayerInput.bCheckInputRanges = b;
<a name="L326"><font color="white">00326</font>	    PlayerInput.SaveConfig();
<a name="L327"><font color="white">00327</font>	}
<a name="L328"><font color="white">00328</font>	*/
<a name="L329"><font color="white">00329</font>	
<a name="L330"><font color="white">00330</font>	/*
<a name="L331"><font color="white">00331</font>	//_____________________________________________________________________________
<a name="L332"><font color="white">00332</font>	exec function CrosshairMode(int i)
<a name="L333"><font color="white">00333</font>	{
<a name="L334"><font color="white">00334</font>	    iCrossHairMode = i%3;
<a name="L335"><font color="white">00335</font>	    SaveConfig();
<a name="L336"><font color="white">00336</font>	}
<a name="L337"><font color="white">00337</font>	*/
<a name="L338"><font color="white">00338</font>	
<a name="L339"><font color="white">00339</font>	//_____________________________________________________________________________
<a name="L340"><font color="white">00340</font>	exec function AutoPickup(bool b)
<a name="L341"><font color="white">00341</font>	{
<a name="L342"><font color="white">00342</font>	    bAutoPickup = b;
<a name="L343"><font color="white">00343</font>	    SaveConfig();
<a name="L344"><font color="white">00344</font>	}
<a name="L345"><font color="white">00345</font>	
<a name="L346"><font color="white">00346</font>	/*
<a name="L347"><font color="white">00347</font>	//_____________________________________________________________________________
<a name="L348"><font color="white">00348</font>	exec function FixCrosshairMode(int i)
<a name="L349"><font color="white">00349</font>	{
<a name="L350"><font color="white">00350</font>	    bFixedCrosshair = (i%2 == 1);
<a name="L351"><font color="white">00351</font>	    SaveConfig();
<a name="L352"><font color="white">00352</font>	}
<a name="L353"><font color="white">00353</font>	
<a name="L354"><font color="white">00354</font>	//_____________________________________________________________________________
<a name="L355"><font color="white">00355</font>	exec function FloatCrosshairMode(int i)
<a name="L356"><font color="white">00356</font>	{
<a name="L357"><font color="white">00357</font>	    bFixedCrosshair = false;
<a name="L358"><font color="white">00358</font>	    bFloatingCrosshair = (i%2 == 1);
<a name="L359"><font color="white">00359</font>	    SaveConfig();
<a name="L360"><font color="white">00360</font>	}
<a name="L361"><font color="white">00361</font>	*/
<a name="L362"><font color="white">00362</font>	
<a name="L363"><font color="white">00363</font>	//_____________________________________________________________________________
<a name="L364"><font color="white">00364</font>	exec function CrosshairSize(Float f)
<a name="L365"><font color="white">00365</font>	{
<a name="L366"><font color="white">00366</font>	    fCrossHairSize = fClamp(f, 0.1, 3.0);
<a name="L367"><font color="white">00367</font>	    SaveConfig();
<a name="L368"><font color="white">00368</font>	}
<a name="L369"><font color="white">00369</font>	
<a name="L370"><font color="white">00370</font>	/*
<a name="L371"><font color="white">00371</font>	//_____________________________________________________________________________
<a name="L372"><font color="white">00372</font>	exec function LogInteraction()
<a name="L373"><font color="white">00373</font>	{
<a name="L374"><font color="white">00374</font>	    log(&quot;LogInteraction&quot;);
<a name="L375"><font color="white">00375</font>	    MyInteraction.SwitchLog();
<a name="L376"><font color="white">00376</font>	}
<a name="L377"><font color="white">00377</font>	*/
<a name="L378"><font color="white">00378</font>	
<a name="L379"><font color="white">00379</font>	//_____________________________________________________________________________
<a name="L380"><font color="white">00380</font>	exec function DoHideHUD( bool B )
<a name="L381"><font color="white">00381</font>	{
<a name="L382"><font color="white">00382</font>	    log(&quot;DoHideHUD call with B=&quot;$B);
<a name="L383"><font color="white">00383</font>	    MYHud.bHideHud = B;
<a name="L384"><font color="white">00384</font>	}
<a name="L385"><font color="white">00385</font>	
<a name="L386"><font color="white">00386</font>	/*
<a name="L387"><font color="white">00387</font>	//_____________________________________________________________________________
<a name="L388"><font color="white">00388</font>	exec function Teleport(name N)
<a name="L389"><font color="white">00389</font>	{
<a name="L390"><font color="white">00390</font>	    local XIIITeleportCheat XTC;
<a name="L391"><font color="white">00391</font>	
<a name="L392"><font color="white">00392</font>	//    Log(&quot;Trying to Teleport to &quot;$N);
<a name="L393"><font color="white">00393</font>	
<a name="L394"><font color="white">00394</font>	    foreach AllActors(class'XIIITeleportCheat', XTC, N)
<a name="L395"><font color="white">00395</font>	    {
<a name="L396"><font color="white">00396</font>	      if (XTC != none)
<a name="L397"><font color="white">00397</font>	      {
<a name="L398"><font color="white">00398</font>	//        Log(&quot;Teleporting player to Spot &quot;$XTC);
<a name="L399"><font color="white">00399</font>	        XTC.TeleportPlayer(XIIIPlayerPawn(Pawn));
<a name="L400"><font color="white">00400</font>	        break;
<a name="L401"><font color="white">00401</font>	      }
<a name="L402"><font color="white">00402</font>	    }
<a name="L403"><font color="white">00403</font>	}
<a name="L404"><font color="white">00404</font>	*/
<a name="L405"><font color="white">00405</font>	
<a name="L406"><font color="white">00406</font>	/*
<a name="L407"><font color="white">00407</font>	exec function TeleportNext()
<a name="L408"><font color="white">00408</font>	{
<a name="L409"><font color="white">00409</font>	    local XIIITeleportCheat XTC, XTCfirst;
<a name="L410"><font color="white">00410</font>	
<a name="L411"><font color="white">00411</font>	//    Log(&quot;Trying to Teleport to next teleporter&quot;);
<a name="L412"><font color="white">00412</font>	
<a name="L413"><font color="white">00413</font>	    foreach AllActors(class'XIIITeleportCheat', XTC)
<a name="L414"><font color="white">00414</font>	    {
<a name="L415"><font color="white">00415</font>	      if (XTCfirst == none)
<a name="L416"><font color="white">00416</font>	        XTCfirst = XTC;
<a name="L417"><font color="white">00417</font>	      if ( (XTC != none) &amp;&amp; XTC.bLastUsed )
<a name="L418"><font color="white">00418</font>	      {
<a name="L419"><font color="white">00419</font>	        if ( XTC.NextXIIITeleportCheat != none )
<a name="L420"><font color="white">00420</font>	        {
<a name="L421"><font color="white">00421</font>	//          Log(&quot;Teleporting player to Spot &quot;$XTC.NextXIIITeleportCheat);
<a name="L422"><font color="white">00422</font>	          XTC.NextXIIITeleportCheat.TeleportPlayer(XIIIPlayerPawn(Pawn));
<a name="L423"><font color="white">00423</font>	          XTC.NextXIIITeleportCheat.bLastUsed = true;
<a name="L424"><font color="white">00424</font>	          XTC.bLastUsed = false;
<a name="L425"><font color="white">00425</font>	          return;
<a name="L426"><font color="white">00426</font>	        }
<a name="L427"><font color="white">00427</font>	        else
<a name="L428"><font color="white">00428</font>	        {
<a name="L429"><font color="white">00429</font>	//          Log(&quot;Teleporting player to Spot &quot;$XTCfirst);
<a name="L430"><font color="white">00430</font>	          XTCfirst.TeleportPlayer(XIIIPlayerPawn(Pawn));
<a name="L431"><font color="white">00431</font>	          XTCFirst.bLastUsed = true;
<a name="L432"><font color="white">00432</font>	          return;
<a name="L433"><font color="white">00433</font>	        }
<a name="L434"><font color="white">00434</font>	      }
<a name="L435"><font color="white">00435</font>	    }
<a name="L436"><font color="white">00436</font>	    // if we are here it's because none have bCurrent
<a name="L437"><font color="white">00437</font>	    if (XTCFirst != none)
<a name="L438"><font color="white">00438</font>	    {
<a name="L439"><font color="white">00439</font>	//      Log(&quot;Teleporting player to Spot &quot;$XTCfirst);
<a name="L440"><font color="white">00440</font>	      XTCfirst.TeleportPlayer(XIIIPlayerPawn(Pawn));
<a name="L441"><font color="white">00441</font>	      XTCFirst.bLastUsed = true;
<a name="L442"><font color="white">00442</font>	      return;
<a name="L443"><font color="white">00443</font>	    }
<a name="L444"><font color="white">00444</font>	}
<a name="L445"><font color="white">00445</font>	*/
<a name="L446"><font color="white">00446</font>	
<a name="L447"><font color="white">00447</font>	//____________________________________________________________________________
<a name="L448"><font color="white">00448</font>	// ELR Override this
<a name="L449"><font color="white">00449</font>	exec function BehindView( Bool B )
<a name="L450"><font color="white">00450</font>	{
<a name="L451"><font color="white">00451</font>	    if (!(Left(Level.GetLocalURL(), 7) ~= &quot;mapmenu&quot;))
<a name="L452"><font color="white">00452</font>	      Super.BehindView(B);
<a name="L453"><font color="white">00453</font>	    if ( B )
<a name="L454"><font color="white">00454</font>	    {
<a name="L455"><font color="white">00455</font>	        Pawn.weapon.bHidden = true;
<a name="L456"><font color="white">00456</font>	        Pawn.weapon.RefreshDisplaying();
<a name="L457"><font color="white">00457</font>	    }
<a name="L458"><font color="white">00458</font>	    else
<a name="L459"><font color="white">00459</font>	    {
<a name="L460"><font color="white">00460</font>	        Pawn.weapon.bHidden = false;
<a name="L461"><font color="white">00461</font>	        Pawn.weapon.RefreshDisplaying();
<a name="L462"><font color="white">00462</font>	    }
<a name="L463"><font color="white">00463</font>	}
<a name="L464"><font color="white">00464</font>	
<a name="L465"><font color="white">00465</font>	function ClientSetBehindView(bool B)
<a name="L466"><font color="white">00466</font>	{
<a name="L467"><font color="white">00467</font>	    bBehindView = B;
<a name="L468"><font color="white">00468</font>	    if ( !B &amp;&amp; Pawn.Shadow != none )
<a name="L469"><font color="white">00469</font>	      Pawn.Shadow.DetachProjector(true);
<a name="L470"><font color="white">00470</font>	}
<a name="L471"><font color="white">00471</font>	
<a name="L472"><font color="white">00472</font>	//____________________________________________________________________________
<a name="L473"><font color="white">00473</font>	event PlayerCalcView(out actor ViewActor, out vector CameraLocation, out rotator CameraRotation )
<a name="L474"><font color="white">00474</font>	{
<a name="L475"><font color="white">00475</font>	    local int i;
<a name="L476"><font color="white">00476</font>	
<a name="L477"><font color="white">00477</font>	    super.PlayerCalcView(ViewActor, CameraLocation, CameraRotation);
<a name="L478"><font color="white">00478</font>	    // following lines needed to have weapon in 3D overlays using bDelayDisplay instead of RenderOverlays
<a name="L479"><font color="white">00479</font>	    if ( ((Pawn == none) || Pawn.bIsDead) &amp;&amp; (Attached.Length &gt; 0) )
<a name="L480"><font color="white">00480</font>	    { // may have died, if something attached (must be 1rst person/inventory weapons) then detach else crash in SetLoc if something happen to inventory
<a name="L481"><font color="white">00481</font>	      for ( i=0; i&lt;Attached.Length; i++)
<a name="L482"><font color="white">00482</font>	      {
<a name="L483"><font color="white">00483</font>	//        Log(&quot;DETACH&quot;@Attached[i]@&quot;from&quot;@self);
<a name="L484"><font color="white">00484</font>	        Attached[i].SetBase(none);
<a name="L485"><font color="white">00485</font>	      }
<a name="L486"><font color="white">00486</font>	    }
<a name="L487"><font color="white">00487</font>	    SetLocation(CameraLocation);
<a name="L488"><font color="white">00488</font>	    SetRotation(CameraRotation);
<a name="L489"><font color="white">00489</font>	}
<a name="L490"><font color="white">00490</font>	
<a name="L491"><font color="white">00491</font>	//____________________________________________________________________________
<a name="L492"><font color="white">00492</font>	simulated event SetInitialState()
<a name="L493"><font color="white">00493</font>	{
<a name="L494"><font color="white">00494</font>	    if (Left(Level.GetLocalURL(), 7) ~= &quot;mapmenu&quot;)
<a name="L495"><font color="white">00495</font>	    {
<a name="L496"><font color="white">00496</font>	      MyHud.bHideHUD = true;
<a name="L497"><font color="white">00497</font>	//      ConsoleCommand(&quot;ShowMenu&quot;);
<a name="L498"><font color="white">00498</font>	      GotoState('NoControl');
<a name="L499"><font color="white">00499</font>	      return;
<a name="L500"><font color="white">00500</font>	    }
<a name="L501"><font color="white">00501</font>	    Super.SetInitialState();
<a name="L502"><font color="white">00502</font>	
<a name="L503"><font color="white">00503</font>	}
<a name="L504"><font color="white">00504</font>	
<a name="L505"><font color="white">00505</font>	//____________________________________________________________________________
<a name="L506"><font color="white">00506</font>	// MLK: Superset to launch the briefing before the game starts
<a name="L507"><font color="white">00507</font>	// ELR First place it is safe to use Player Var so to spawn interactions.
<a name="L508"><font color="white">00508</font>	event InitInputSystem()
<a name="L509"><font color="white">00509</font>	{
<a name="L510"><font color="white">00510</font>	    local MapInfo Map;
<a name="L511"><font color="white">00511</font>	    local int i;
<a name="L512"><font color="white">00512</font>	    local XIIIPlayerInteraction XPI;
<a name="L513"><font color="white">00513</font>	
<a name="L514"><font color="white">00514</font>	    Super.InitInputSystem();
<a name="L515"><font color="white">00515</font>	
<a name="L516"><font color="white">00516</font>	    Player.Console = Player.InteractionMaster.Console;
<a name="L517"><font color="white">00517</font>	    if (Player.Console == none)
<a name="L518"><font color="white">00518</font>	    {
<a name="L519"><font color="white">00519</font>	        log(&quot;PAS de Console !?!&quot;);
<a name="L520"><font color="white">00520</font>	        return;
<a name="L521"><font color="white">00521</font>	    }
<a name="L522"><font color="white">00522</font>	    if (Player.Console.ViewportOwner == none)
<a name="L523"><font color="white">00523</font>	      Player.Console.ViewportOwner = Player;
<a name="L524"><font color="white">00524</font>	
<a name="L525"><font color="white">00525</font>	    for (i=0; i&lt;Player.LocalInteractions.Length; i++)
<a name="L526"><font color="white">00526</font>	    {
<a name="L527"><font color="white">00527</font>	      if ( XIIIPlayerInteraction(Player.LocalInteractions[i]) != none )
<a name="L528"><font color="white">00528</font>	        MyInteraction = XIIIPlayerInteraction(Player.LocalInteractions[i]);
<a name="L529"><font color="white">00529</font>	    }
<a name="L530"><font color="white">00530</font>	// if an interaction already exists (coming from previous map) then reuse it, don't create another
<a name="L531"><font color="white">00531</font>	
<a name="L532"><font color="white">00532</font>	    if ( MyInteraction != none )
<a name="L533"><font color="white">00533</font>	    {
<a name="L534"><font color="white">00534</font>	        Player.InteractionMaster.RemoveInteraction(MyInteraction);
<a name="L535"><font color="white">00535</font>	        MyInteraction = none;
<a name="L536"><font color="white">00536</font>	    }
<a name="L537"><font color="white">00537</font>	
<a name="L538"><font color="white">00538</font>	    if ( MyInteraction == none )
<a name="L539"><font color="white">00539</font>	    {
<a name="L540"><font color="white">00540</font>	      XPI = XIIIPlayerInteraction(Player.InteractionMaster.AddInteraction(MyInteractionClass, Player));
<a name="L541"><font color="white">00541</font>	      if ( XPI != none )
<a name="L542"><font color="white">00542</font>	      {
<a name="L543"><font color="white">00543</font>	        XPI.Level = Level;
<a name="L544"><font color="white">00544</font>	        XPI.MyPC = Self;
<a name="L545"><font color="white">00545</font>	        MyInteraction = XPI;
<a name="L546"><font color="white">00546</font>	      }
<a name="L547"><font color="white">00547</font>	    }
<a name="L548"><font color="white">00548</font>	    else
<a name="L549"><font color="white">00549</font>	    {
<a name="L550"><font color="white">00550</font>	      MyInteraction.Level = Level;
<a name="L551"><font color="white">00551</font>	      MyInteraction.MyPC = Self;
<a name="L552"><font color="white">00552</font>	    }
<a name="L553"><font color="white">00553</font>	
<a name="L554"><font color="white">00554</font>	    SetRumbleFX(bUseRumble);
<a name="L555"><font color="white">00555</font>	
<a name="L556"><font color="white">00556</font>	    // Autolaunch Menu if in the 'menustart'.
<a name="L557"><font color="white">00557</font>	    if (Left(Level.GetLocalURL(), 7) ~= &quot;mapmenu&quot;)
<a name="L558"><font color="white">00558</font>	    {
<a name="L559"><font color="white">00559</font>	      MyHud.bHideHUD = true;
<a name="L560"><font color="white">00560</font>	      ConsoleCommand(&quot;ShowMenu&quot;);
<a name="L561"><font color="white">00561</font>	      XIIIGameInfo(Level.Game).MapInfo.EndCartoonEffect = true;
<a name="L562"><font color="white">00562</font>	      GotoState('NoControl');
<a name="L563"><font color="white">00563</font>	    }
<a name="L564"><font color="white">00564</font>	
<a name="L565"><font color="white">00565</font>	    if ( !Level.bLonePlayer &amp;&amp; (Level.GetPlateforme() == 2) )
<a name="L566"><font color="white">00566</font>	    {
<a name="L567"><font color="white">00567</font>	      if (xboxlive == none) // Southend!!!!!!!!!1 safe for other platforms..
<a name="L568"><font color="white">00568</font>	        xboxlive=New Class'XboxLiveManager';
<a name="L569"><font color="white">00569</font>	
<a name="L570"><font color="white">00570</font>	      if (xboxlive.IsLoggedIn(xboxlive.GetCurrentUser()))
<a name="L571"><font color="white">00571</font>	        ConsoleCommand(&quot;ShowMenu&quot;); // SOUTHEND!!!!!!!!!  Need this for XBOX!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
<a name="L572"><font color="white">00572</font>	      return;
<a name="L573"><font color="white">00573</font>	    }
<a name="L574"><font color="white">00574</font>	
<a name="L575"><font color="white">00575</font>	// SOLO ONLY INIT
<a name="L576"><font color="white">00576</font>	    foreach AllActors(class'XIII.Mapinfo',map)
<a name="L577"><font color="white">00577</font>	      break;
<a name="L578"><font color="white">00578</font>	    if ( Map != none &amp;&amp; Map.bBriefing )
<a name="L579"><font color="white">00579</font>	    {
<a name="L580"><font color="white">00580</font>	      XIIIGameInfo(Level.Game).MapInfo = Map;
<a name="L581"><font color="white">00581</font>	      ConsoleCommand(&quot;ShowBriefing&quot;);
<a name="L582"><font color="white">00582</font>	    }
<a name="L583"><font color="white">00583</font>	}
<a name="L584"><font color="white">00584</font>	
<a name="L585"><font color="white">00585</font>	//_____________________________________________________________________________
<a name="L586"><font color="white">00586</font>	// ::DBUG::
<a name="L587"><font color="white">00587</font>	simulated event Destroyed()
<a name="L588"><font color="white">00588</font>	{
<a name="L589"><font color="white">00589</font>	    Log(&quot;PLAYER&quot;@self@&quot;destroyed !!&quot;);
<a name="L590"><font color="white">00590</font>	    Super.Destroyed();
<a name="L591"><font color="white">00591</font>	}
<a name="L592"><font color="white">00592</font>	
<a name="L593"><font color="white">00593</font>	//_____________________________________________________________________________
<a name="L594"><font color="white">00594</font>	// ::DBUG::
<a name="L595"><font color="white">00595</font>	function PawnDied()
<a name="L596"><font color="white">00596</font>	{
<a name="L597"><font color="white">00597</font>	  Log(&quot;PLAYER&quot;@self@&quot;PawnDied call bIsPlayer=&quot;$bIsPlayer);
<a name="L598"><font color="white">00598</font>	  Super.PawnDied();
<a name="L599"><font color="white">00599</font>	  // Unflash player if under flashbang sfx
<a name="L600"><font color="white">00600</font>	  ClientFilter(
<a name="L601"><font color="white">00601</font>	    class'Canvas'.Static.MakeColor(128,128,128,255),
<a name="L602"><font color="white">00602</font>	    class'Canvas'.Static.MakeColor(128,128,128,255),
<a name="L603"><font color="white">00603</font>	    1.0
<a name="L604"><font color="white">00604</font>	  );
<a name="L605"><font color="white">00605</font>	  ClientHighLight( class'Canvas'.Static.MakeColor(0,0,0,0), 0.0);
<a name="L606"><font color="white">00606</font>	  ClientTargetHighLight(0,0,0.001);
<a name="L607"><font color="white">00607</font>	  UseVignetteFilter = 0;
<a name="L608"><font color="white">00608</font>	  UseVignetteHighlight = 0;
<a name="L609"><font color="white">00609</font>	}
<a name="L610"><font color="white">00610</font>	
<a name="L611"><font color="white">00611</font>	//_____________________________________________________________________________
<a name="L612"><font color="white">00612</font>	// Setup the ForceFeedbackController
<a name="L613"><font color="white">00613</font>	function SetRumbleFX(bool B)
<a name="L614"><font color="white">00614</font>	{
<a name="L615"><font color="white">00615</font>	    if ( B )
<a name="L616"><font color="white">00616</font>	    {
<a name="L617"><font color="white">00617</font>	      if ( FFController != none )
<a name="L618"><font color="white">00618</font>	      {
<a name="L619"><font color="white">00619</font>	        FFController.EnableForceFeedback(true);
<a name="L620"><font color="white">00620</font>	      }
<a name="L621"><font color="white">00621</font>	      else
<a name="L622"><font color="white">00622</font>	      {
<a name="L623"><font color="white">00623</font>	        FFController = new class'ForceFeedbackController';
<a name="L624"><font color="white">00624</font>	        FFController.EnableForceFeedback(true);
<a name="L625"><font color="white">00625</font>	      }
<a name="L626"><font color="white">00626</font>	    }
<a name="L627"><font color="white">00627</font>	    else
<a name="L628"><font color="white">00628</font>	    {
<a name="L629"><font color="white">00629</font>	      if ( FFController != none )
<a name="L630"><font color="white">00630</font>	      {
<a name="L631"><font color="white">00631</font>	        FFController.EnableForceFeedback(false);
<a name="L632"><font color="white">00632</font>	      }
<a name="L633"><font color="white">00633</font>	    }
<a name="L634"><font color="white">00634</font>	}
<a name="L635"><font color="white">00635</font>	
<a name="L636"><font color="white">00636</font>	//_____________________________________________________________________________
<a name="L637"><font color="white">00637</font>	// Setup the ForceFeedbackController
<a name="L638"><font color="white">00638</font>	function RumbleFX(int FXNum)
<a name="L639"><font color="white">00639</font>	{
<a name="L640"><font color="white">00640</font>	    if ( (FFController != none) &amp;&amp; FFController.IsForceFeedbackEnable() )
<a name="L641"><font color="white">00641</font>	    {
<a name="L642"><font color="white">00642</font>	      switch(FXNum)
<a name="L643"><font color="white">00643</font>	      {
<a name="L644"><font color="white">00644</font>	        Case 1: // Beretta
<a name="L645"><font color="white">00645</font>	          FFController.StartEffect(0, 0.45, 0.45, 0.00, 1.00, 0.20, 0.70, 0.35 ); Break;
<a name="L646"><font color="white">00646</font>	        Case 2: // Hunting Gun, Left
<a name="L647"><font color="white">00647</font>	          FFController.StartEffect(0, 0.00, 0.75, 0.00, 1.00, 0.25, 0.50, 0.35 ); Break;
<a name="L648"><font color="white">00648</font>	        Case 3: // Hunting Gun, Right
<a name="L649"><font color="white">00649</font>	          FFController.StartEffect(0, 0.75, 0.00, 0.00, 1.00, 0.25, 0.50, 0.35 ); Break;
<a name="L650"><font color="white">00650</font>	        Case 4: // ShotGun
<a name="L651"><font color="white">00651</font>	          FFController.StartEffect(0, 0.60, 0.00, 0.00, 1.00, 0.35, 0.50, 0.40 ); Break;
<a name="L652"><font color="white">00652</font>	        Case 5: // Magnum
<a name="L653"><font color="white">00653</font>	          FFController.StartEffect(0, 0.60, 0.60, 0.00, 1.00, 0.20, 0.70, 0.35 ); Break;
<a name="L654"><font color="white">00654</font>	        Case 6: // M16 FX 1
<a name="L655"><font color="white">00655</font>	          FFController.StartEffect(0, 0.15, 0.45, 0.00, 1.00, 0.10, 0.70, 0.15 ); Break;
<a name="L656"><font color="white">00656</font>	        Case 7: // M16 inv. FX 1
<a name="L657"><font color="white">00657</font>	          FFController.StartEffect(0, 0.45, 0.15, 0.00, 1.00, 0.10, 0.70, 0.15 ); Break;
<a name="L658"><font color="white">00658</font>	        Case 8: // Kalash FX 1
<a name="L659"><font color="white">00659</font>	          FFController.StartEffect(0, 0.25, 0.45, 0.00, 1.00, 0.10, 0.70, 0.15 ); Break;
<a name="L660"><font color="white">00660</font>	        Case 9: // Kalash inv. FX 1
<a name="L661"><font color="white">00661</font>	          FFController.StartEffect(0, 0.45, 0.25, 0.00, 1.00, 0.10, 0.70, 0.15 ); Break;
<a name="L662"><font color="white">00662</font>	        Case 10: // Minigun FX 1
<a name="L663"><font color="white">00663</font>	          FFController.StartEffect(0, 0.10, 0.35, 0.00, 0.70, 0.10, 0.70, 0.15 ); Break;
<a name="L664"><font color="white">00664</font>	        Case 11: // Minigun inv. FX 1
<a name="L665"><font color="white">00665</font>	          FFController.StartEffect(0, 0.35, 0.10, 0.00, 0.70, 0.10, 0.70, 0.15 ); Break;
<a name="L666"><font color="white">00666</font>	        Case 12: // Sniper Rifle
<a name="L667"><font color="white">00667</font>	          FFController.StartEffect(0, 0.90, 0.90, 0.00, 1.00, 0.15, 0.70, 0.25 ); Break;
<a name="L668"><font color="white">00668</font>	        Case 13: // Bazooka
<a name="L669"><font color="white">00669</font>	          FFController.StartEffect(0, 0.90, 0.90, 0.00, 0.70, 0.25, 1.00, 1.00 ); Break;
<a name="L670"><font color="white">00670</font>	        Case 14: // CrossBow, CrossBow X3
<a name="L671"><font color="white">00671</font>	          FFController.StartEffect(0, 0.50, 0.50, 0.00, 0.10, 0.10, 1.00, 0.25 ); Break;
<a name="L672"><font color="white">00672</font>	        Case 15: // M60 FX 1
<a name="L673"><font color="white">00673</font>	          FFController.StartEffect(0, 0.80, 0.40, 0.00, 1.00, 0.10, 0.70, 0.15 ); Break;
<a name="L674"><font color="white">00674</font>	        Case 16: // M60 inv. FX 1
<a name="L675"><font color="white">00675</font>	          FFController.StartEffect(0, 0.40, 0.80, 0.00, 1.00, 0.10, 0.70, 0.15 ); Break;
<a name="L676"><font color="white">00676</font>	        Case 17: // Harpoon
<a name="L677"><font color="white">00677</font>	          FFController.StartEffect(0, 0.30, 0.30, 0.00, 0.10, 0.10, 1.00, 0.20 ); Break;
<a name="L678"><font color="white">00678</font>	/*
<a name="L679"><font color="white">00679</font>	        Case 5:
<a name="L680"><font color="white">00680</font>	          FFController.StartEffect(0, fRumb1, fRumb2, t1, Amplit1, t2, Amplit2, t3 );
<a name="L681"><font color="white">00681</font>	          Break;
<a name="L682"><font color="white">00682</font>	*/
<a name="L683"><font color="white">00683</font>	      }
<a name="L684"><font color="white">00684</font>	    }
<a name="L685"><font color="white">00685</font>	}
<a name="L686"><font color="white">00686</font>	
<a name="L687"><font color="white">00687</font>	//_____________________________________________________________________________
<a name="L688"><font color="white">00688</font>	// SpawnDefaultHUD()
<a name="L689"><font color="white">00689</font>	// Spawn a HUD (make sure that PlayerController always has valid HUD, even if
<a name="L690"><font color="white">00690</font>	//  ClientSetHUD() hasn't been called
<a name="L691"><font color="white">00691</font>	function SpawnDefaultHUD()
<a name="L692"><font color="white">00692</font>	{
<a name="L693"><font color="white">00693</font>	     myHUD = spawn(class'XIIIBaseHUD',self);
<a name="L694"><font color="white">00694</font>	}
<a name="L695"><font color="white">00695</font>	
<a name="L696"><font color="white">00696</font>	//_____________________________________________________________________________
<a name="L697"><font color="white">00697</font>	function DisplayDebug(Canvas C, out float YL, out float YPos)
<a name="L698"><font color="white">00698</font>	{
<a name="L699"><font color="white">00699</font>	    Super.DisplayDebug(C, YL, YPos);
<a name="L700"><font color="white">00700</font>	
<a name="L701"><font color="white">00701</font>	    C.DrawText(&quot;rotation &quot;$rotation);
<a name="L702"><font color="white">00702</font>	    YPos += YL;
<a name="L703"><font color="white">00703</font>	    C.SetPos(4,YPos);
<a name="L704"><font color="white">00704</font>	
<a name="L705"><font color="white">00705</font>	    C.DrawText(&quot;Weapon Mode &quot;$bWeaponMode);
<a name="L706"><font color="white">00706</font>	    YPos += YL;
<a name="L707"><font color="white">00707</font>	    C.SetPos(4,YPos);
<a name="L708"><font color="white">00708</font>	
<a name="L709"><font color="white">00709</font>	    if ( Pawn != none )
<a name="L710"><font color="white">00710</font>	    {
<a name="L711"><font color="white">00711</font>	/*
<a name="L712"><font color="white">00712</font>	      if ( Pawn.PendingWeapon != none )
<a name="L713"><font color="white">00713</font>	      {
<a name="L714"><font color="white">00714</font>	        C.DrawText(&quot;PendingWeapon=&quot;$Pawn.PendingWeapon@&quot;STATE&quot;@Pawn.PendingWeapon.GetStateName());
<a name="L715"><font color="white">00715</font>	        YPos += YL;
<a name="L716"><font color="white">00716</font>	        C.SetPos(4,YPos);
<a name="L717"><font color="white">00717</font>	      }
<a name="L718"><font color="white">00718</font>	      if ( Pawn.PendingWeapon != none )
<a name="L719"><font color="white">00719</font>	      {
<a name="L720"><font color="white">00720</font>	        C.DrawText(&quot;Weapon=&quot;$Pawn.Weapon@&quot;STATE&quot;@Pawn.Weapon.GetStateName());
<a name="L721"><font color="white">00721</font>	        YPos += YL;
<a name="L722"><font color="white">00722</font>	        C.SetPos(4,YPos);
<a name="L723"><font color="white">00723</font>	      }
<a name="L724"><font color="white">00724</font>	      if ( Pawn.PendingItem != none )
<a name="L725"><font color="white">00725</font>	      {
<a name="L726"><font color="white">00726</font>	        C.DrawText(&quot;PendingItem=&quot;$Pawn.PendingItem@&quot;STATE&quot;@Pawn.PendingItem.GetStateName());
<a name="L727"><font color="white">00727</font>	        YPos += YL;
<a name="L728"><font color="white">00728</font>	        C.SetPos(4,YPos);
<a name="L729"><font color="white">00729</font>	      }
<a name="L730"><font color="white">00730</font>	      if ( Pawn.SelectedItem != none )
<a name="L731"><font color="white">00731</font>	      {
<a name="L732"><font color="white">00732</font>	        C.DrawText(&quot;Item=&quot;$Pawn.SelectedItem@&quot;STATE&quot;@Pawn.SelectedItem.GetStateName());
<a name="L733"><font color="white">00733</font>	        YPos += YL;
<a name="L734"><font color="white">00734</font>	        C.SetPos(4,YPos);
<a name="L735"><font color="white">00735</font>	      }
<a name="L736"><font color="white">00736</font>	
<a name="L737"><font color="white">00737</font>	*/
<a name="L738"><font color="white">00738</font>	      if ( XIIIPawn(Pawn).LHand != none )
<a name="L739"><font color="white">00739</font>	      {
<a name="L740"><font color="white">00740</font>	        C.DrawText(&quot;LeftHand=&quot;$XIIIPawn(Pawn).LHand);
<a name="L741"><font color="white">00741</font>	        YPos += YL;
<a name="L742"><font color="white">00742</font>	        C.SetPos(4,YPos);
<a name="L743"><font color="white">00743</font>	      }
<a name="L744"><font color="white">00744</font>	    }
<a name="L745"><font color="white">00745</font>	
<a name="L746"><font color="white">00746</font>	    C.DrawText(&quot;Rotation=&quot;$Rotation@&quot;AdjustedAimForFiring&quot;@rotator(AdjustedAimForFiring)@&quot;OldAdjustAim&quot;@rotator(OldAdjustAim));
<a name="L747"><font color="white">00747</font>	    YPos += YL;
<a name="L748"><font color="white">00748</font>	    C.SetPos(4,YPos);
<a name="L749"><font color="white">00749</font>	
<a name="L750"><font color="white">00750</font>	/*    C.DrawText(&quot;bAlwaysLevel=&quot;$bAlwaysLevel@&quot;bCenterView=&quot;$bCenterView@&quot;bLook=&quot;$bLook@&quot;bLookUpStairs=&quot;$bLookUpStairs@&quot;bSnapToLevel=&quot;$bSnapToLevel);
<a name="L751"><font color="white">00751</font>	    YPos += YL;
<a name="L752"><font color="white">00752</font>	    C.SetPos(4,YPos); */
<a name="L753"><font color="white">00753</font>	}
<a name="L754"><font color="white">00754</font>	
<a name="L755"><font color="white">00755</font>	//_____________________________________________________________________________
<a name="L756"><font color="white">00756</font>	exec function RestartLevel()
<a name="L757"><font color="white">00757</font>	{
<a name="L758"><font color="white">00758</font>	//    if( Level.Netmode==NM_Standalone )
<a name="L759"><font color="white">00759</font>	    if ( Level.bLonePlayer )
<a name="L760"><font color="white">00760</font>	      ClientTravel( &quot;?restart&quot;, TRAVEL_Relative, false );
<a name="L761"><font color="white">00761</font>	}
<a name="L762"><font color="white">00762</font>	
<a name="L763"><font color="white">00763</font>	//_____________________________________________________________________________
<a name="L764"><font color="white">00764</font>	function ClientRestart()
<a name="L765"><font color="white">00765</font>	{
<a name="L766"><font color="white">00766</font>	  Log(&quot;ClientRestart&quot;@self@&quot;Pawn=&quot;$Pawn);
<a name="L767"><font color="white">00767</font>		if ( Pawn == None )
<a name="L768"><font color="white">00768</font>		{
<a name="L769"><font color="white">00769</font>			GotoState('WaitingForPawn');
<a name="L770"><font color="white">00770</font>			return;
<a name="L771"><font color="white">00771</font>		}
<a name="L772"><font color="white">00772</font>		if ( PlayerInput != none )
<a name="L773"><font color="white">00773</font>		{
<a name="L774"><font color="white">00774</font>		  PlayerInput.iDuckMem = 0;
<a name="L775"><font color="white">00775</font>		  PlayerInput.bDuckCheck = false;
<a name="L776"><font color="white">00776</font>		  Pawn.ShouldCrouch(false);
<a name="L777"><font color="white">00777</font>		}
<a name="L778"><font color="white">00778</font>		bDuck = 0;
<a name="L779"><font color="white">00779</font>		Pawn.ClientRestart();
<a name="L780"><font color="white">00780</font>		SetViewTarget(Pawn);
<a name="L781"><font color="white">00781</font>		bBehindView = Pawn.PointOfView();
<a name="L782"><font color="white">00782</font>		EnterStartState();
<a name="L783"><font color="white">00783</font>	}
<a name="L784"><font color="white">00784</font>	
<a name="L785"><font color="white">00785</font>	//_____________________________________________________________________________
<a name="L786"><font color="white">00786</font>	simulated function RenderScreenOverlays( canvas C )
<a name="L787"><font color="white">00787</font>	{
<a name="L788"><font color="white">00788</font>	    if ( fCamViewPercent &gt; 0.0 )
<a name="L789"><font color="white">00789</font>	    {
<a name="L790"><font color="white">00790</font>	      CamView.Instigator = pawn;
<a name="L791"><font color="white">00791</font>	      CamView.RenderOverlays(C);
<a name="L792"><font color="white">00792</font>	    }
<a name="L793"><font color="white">00793</font>	}
<a name="L794"><font color="white">00794</font>	
<a name="L795"><font color="white">00795</font>	//_____________________________________________________________________________
<a name="L796"><font color="white">00796</font>	// ELR
<a name="L797"><font color="white">00797</font>	simulated event RenderOverlays( canvas C )
<a name="L798"><font color="white">00798</font>	{
<a name="L799"><font color="white">00799</font>	    if ( !Level.bCineFrame )
<a name="L800"><font color="white">00800</font>	      MyInteraction.MyPCPostRender(C);
<a name="L801"><font color="white">00801</font>	    else
<a name="L802"><font color="white">00802</font>	      MyInteraction.TargetActor = none;
<a name="L803"><font color="white">00803</font>	    // ::TODO:: Optimize using NoControl state test or overriding RenderOverlays in NoControl State ?
<a name="L804"><font color="white">00804</font>	/*
<a name="L805"><font color="white">00805</font>	    if ( (Pawn != none) &amp;&amp; Pawn.region.Zone.FlashEffectDesc.IsActivated )
<a name="L806"><font color="white">00806</font>	    { // do not simply return but hide weapons/items
<a name="L807"><font color="white">00807</font>	      if ( Pawn.Weapon != none )
<a name="L808"><font color="white">00808</font>	      { // should be in the flashback end effect
<a name="L809"><font color="white">00809</font>	      }
<a name="L810"><font color="white">00810</font>	      return;
<a name="L811"><font color="white">00811</font>	    }
<a name="L812"><font color="white">00812</font>	*/
<a name="L813"><font color="white">00813</font>	
<a name="L814"><font color="white">00814</font>	/*
<a name="L815"><font color="white">00815</font>	    if ( (Level.Game != none) &amp;&amp; Level.Game.bGameEnded )
<a name="L816"><font color="white">00816</font>	    {
<a name="L817"><font color="white">00817</font>	//      Log(&quot;RenderOverlays w/ bGameEnded !!!&quot;);
<a name="L818"><font color="white">00818</font>	      return;
<a name="L819"><font color="white">00819</font>	    }
<a name="L820"><font color="white">00820</font>	*/
<a name="L821"><font color="white">00821</font>	
<a name="L822"><font color="white">00822</font>	    if ( (Level.Game != none) &amp;&amp; (Level.Game.DetailLevel &lt; 2) )
<a name="L823"><font color="white">00823</font>	    { // On anything else than XBOX, use full screen render.
<a name="L824"><font color="white">00824</font>	      if ( IsInState('CameraView') )
<a name="L825"><font color="white">00825</font>	      {
<a name="L826"><font color="white">00826</font>	        CamView.Instigator = pawn;
<a name="L827"><font color="white">00827</font>	        CamView.RenderOverlays(C);
<a name="L828"><font color="white">00828</font>	        return;
<a name="L829"><font color="white">00829</font>	      }
<a name="L830"><font color="white">00830</font>	    }
<a name="L831"><font color="white">00831</font>	    else
<a name="L832"><font color="white">00832</font>	    { // on XBox, use portal
<a name="L833"><font color="white">00833</font>	      switch (CamViewMode)
<a name="L834"><font color="white">00834</font>	      {
<a name="L835"><font color="white">00835</font>	        case 0:
<a name="L836"><font color="white">00836</font>	          fCamViewPercent -= 0.05;
<a name="L837"><font color="white">00837</font>	          if (fCamViewPercent &lt; 0.0)
<a name="L838"><font color="white">00838</font>	          {
<a name="L839"><font color="white">00839</font>	            fCamViewPercent = 0.0;
<a name="L840"><font color="white">00840</font>	            CamView = none;
<a name="L841"><font color="white">00841</font>	          }
<a name="L842"><font color="white">00842</font>	        break;
<a name="L843"><font color="white">00843</font>	        case 1:
<a name="L844"><font color="white">00844</font>	          fCamViewPercent += 0.05;
<a name="L845"><font color="white">00845</font>	          if (fCamViewPercent &gt; 1.0)
<a name="L846"><font color="white">00846</font>	            fCamViewPercent = 1.0;
<a name="L847"><font color="white">00847</font>	        break;
<a name="L848"><font color="white">00848</font>	      }
<a name="L849"><font color="white">00849</font>	
<a name="L850"><font color="white">00850</font>	      if (multiViewport != none)
<a name="L851"><font color="white">00851</font>	      {
<a name="L852"><font color="white">00852</font>	        multiViewport.RenderOverlays(C);
<a name="L853"><font color="white">00853</font>	        if (multiViewport.bEnded)
<a name="L854"><font color="white">00854</font>	        {
<a name="L855"><font color="white">00855</font>	          multiViewport.Destroy();
<a name="L856"><font color="white">00856</font>	          multiViewport = none;
<a name="L857"><font color="white">00857</font>	          Level.SetOnlyPostRender(false);
<a name="L858"><font color="white">00858</font>	        }
<a name="L859"><font color="white">00859</font>	      }
<a name="L860"><font color="white">00860</font>	
<a name="L861"><font color="white">00861</font>	      if ( fCamViewPercent &gt; 0.0 )
<a name="L862"><font color="white">00862</font>	      {
<a name="L863"><font color="white">00863</font>	        CamView.Instigator = pawn;
<a name="L864"><font color="white">00864</font>	        CamView.RenderOverlays(C);
<a name="L865"><font color="white">00865</font>	//        return; // don't return as we render in a viewport.
<a name="L866"><font color="white">00866</font>	      }
<a name="L867"><font color="white">00867</font>	    }
<a name="L868"><font color="white">00868</font>	
<a name="L869"><font color="white">00869</font>	    if ( bWeaponMode &amp;&amp; (Pawn != none) &amp;&amp; (Pawn.Weapon != none) )
<a name="L870"><font color="white">00870</font>	    {
<a name="L871"><font color="white">00871</font>	//      if ( !Pawn.Weapon.IsAnimating() )
<a name="L872"><font color="white">00872</font>	//        Pawn.Weapon.AnimEnd(0); // Anti bug, if selected MUST Have an animation
<a name="L873"><font color="white">00873</font>	      if ( Pawn.Weapon.Instigator != Pawn ) // don't bNetDirty by instigator changed each frame
<a name="L874"><font color="white">00874</font>	        Pawn.Weapon.Instigator = Pawn;
<a name="L875"><font color="white">00875</font>	      Pawn.Weapon.RenderOverlays(C);
<a name="L876"><font color="white">00876</font>	    }
<a name="L877"><font color="white">00877</font>	    if ( !bWeaponMode &amp;&amp; (Pawn != none) )
<a name="L878"><font color="white">00878</font>	    {
<a name="L879"><font color="white">00879</font>	//      if ( !Pawn.SelectedItem.IsAnimating() )
<a name="L880"><font color="white">00880</font>	//        Pawn.SelectedItem.AnimEnd(0); // Anti bug, if selected MUST Have an animation
<a name="L881"><font color="white">00881</font>	      if ( Pawn.SelectedItem != none )
<a name="L882"><font color="white">00882</font>	        Pawn.SelectedItem.RenderOverlays(C);
<a name="L883"><font color="white">00883</font>	      else
<a name="L884"><font color="white">00884</font>	      { // bug ?
<a name="L885"><font color="white">00885</font>	        NextWeapon();
<a name="L886"><font color="white">00886</font>	        Pawn.ChangedWeapon();
<a name="L887"><font color="white">00887</font>	      }
<a name="L888"><font color="white">00888</font>	    }
<a name="L889"><font color="white">00889</font>	
<a name="L890"><font color="white">00890</font>	    if ( (Pawn != none) &amp;&amp; (XIIIPawn(Pawn).LHand != None) &amp;&amp; (XIIIPawn(Pawn).LHand.bActive) )
<a name="L891"><font color="white">00891</font>	    {
<a name="L892"><font color="white">00892</font>	      XIIIPawn(Pawn).LHand.RenderOverlays(C);
<a name="L893"><font color="white">00893</font>	    }
<a name="L894"><font color="white">00894</font>	}
<a name="L895"><font color="white">00895</font>	
<a name="L896"><font color="white">00896</font>	//_____________________________________________________________________________
<a name="L897"><font color="white">00897</font>	function ClientTargetHighLight( int Alpha, float TargetHighLight, float Duration)
<a name="L898"><font color="white">00898</font>	{ // compute Dec values per millsec
<a name="L899"><font color="white">00899</font>	    VignetteFlashDecFactor = (TargetHighLight - VignetteHighLight) / Duration;
<a name="L900"><font color="white">00900</font>	    VignetteAlphaDecFactor = (Alpha - VignetteColor.A) / Duration;
<a name="L901"><font color="white">00901</font>	    VignetteSFXduration = Duration;
<a name="L902"><font color="white">00902</font>	    VignetteAlpha = VignetteColor.A;
<a name="L903"><font color="white">00903</font>	}
<a name="L904"><font color="white">00904</font>	
<a name="L905"><font color="white">00905</font>	//_____________________________________________________________________________
<a name="L906"><font color="white">00906</font>	// ELR made zooming speed higher
<a name="L907"><font color="white">00907</font>	function AdjustView(float DeltaTime )
<a name="L908"><font color="white">00908</font>	{
<a name="L909"><font color="white">00909</font>	    // teleporters affect your FOV, so adjust it back down
<a name="L910"><font color="white">00910</font>	    if ( FOVAngle != DesiredFOV )
<a name="L911"><font color="white">00911</font>	    {
<a name="L912"><font color="white">00912</font>	      if ( FOVAngle &gt; DesiredFOV )
<a name="L913"><font color="white">00913</font>	        FOVAngle = FOVAngle - FMax(7, 0.9 * DeltaTime * (FOVAngle - DesiredFOV));
<a name="L914"><font color="white">00914</font>	      else
<a name="L915"><font color="white">00915</font>	        FOVAngle = FOVAngle - FMin(-7, 0.9 * DeltaTime * (FOVAngle - DesiredFOV));
<a name="L916"><font color="white">00916</font>	      if ( Abs(FOVAngle - DesiredFOV) &lt;= 10 )
<a name="L917"><font color="white">00917</font>	        FOVAngle = DesiredFOV;
<a name="L918"><font color="white">00918</font>	    }
<a name="L919"><font color="white">00919</font>	
<a name="L920"><font color="white">00920</font>	    // adjust FOV for weapon zooming
<a name="L921"><font color="white">00921</font>	    if ( bZooming )
<a name="L922"><font color="white">00922</font>	    {
<a name="L923"><font color="white">00923</font>	      ZoomLevel += DeltaTime * 1.5;
<a name="L924"><font color="white">00924</font>	      if (ZoomLevel &gt; 0.95)
<a name="L925"><font color="white">00925</font>	        ZoomLevel = 0.95;
<a name="L926"><font color="white">00926</font>	      DesiredFOV = FClamp(90.0 - (ZoomLevel * 88.0), 1, 170);
<a name="L927"><font color="white">00927</font>	    }
<a name="L928"><font color="white">00928</font>	
<a name="L929"><font color="white">00929</font>	    // Handle here because we do have DeltaTime
<a name="L930"><font color="white">00930</font>	    if ( ((UseVignetteFilter != 0) || (UseVignetteHighlight != 0)) &amp;&amp; ( VignetteSFXduration &gt; 0) )
<a name="L931"><font color="white">00931</font>	    {
<a name="L932"><font color="white">00932</font>	      VignetteHighLight += (DeltaTime * VignetteFlashDecFactor);
<a name="L933"><font color="white">00933</font>	      VignetteAlpha += (Deltatime * VignetteAlphaDecFactor);
<a name="L934"><font color="white">00934</font>	      VignetteColor.A = VignetteAlpha;
<a name="L935"><font color="white">00935</font>	      VignetteSFXduration -= DeltaTime;
<a name="L936"><font color="white">00936</font>	//      Log(&quot;VignetteSFXduration=&quot;$VignetteSFXduration@&quot;VignetteHighLight=&quot;$VignetteHighLight@&quot;VignetteColor=&quot;$VignetteColor.R$&quot;.&quot;$VignetteColor.G$&quot;.&quot;$VignetteColor.B$&quot;.&quot;$VignetteAlpha);
<a name="L937"><font color="white">00937</font>	      if ( VignetteSFXduration &lt;= 0 )
<a name="L938"><font color="white">00938</font>	      {
<a name="L939"><font color="white">00939</font>	        UseVignetteFilter = 0;
<a name="L940"><font color="white">00940</font>	        UseVignetteHighlight = 0;
<a name="L941"><font color="white">00941</font>	      }
<a name="L942"><font color="white">00942</font>	    }
<a name="L943"><font color="white">00943</font>	}
<a name="L944"><font color="white">00944</font>	
<a name="L945"><font color="white">00945</font>	//_____________________________________________________________________________
<a name="L946"><font color="white">00946</font>	/* AdjustAim()
<a name="L947"><font color="white">00947</font>	  Calls this version for player aiming help.
<a name="L948"><font color="white">00948</font>	  Aimerror not used in this version.
<a name="L949"><font color="white">00949</font>	  Only adjusts aiming at pawns
<a name="L950"><font color="white">00950</font>	*/
<a name="L951"><font color="white">00951</font>	// ELR computes AimSpot and return rotator(AimSpot - projStart)
<a name="L952"><font color="white">00952</font>	//Simulated function rotator AdjustAim(float projSpeed, vector projStart, int aimerror, bool bLeadTarget, bool bWarnTarget, bool bTossed, bool bTrySplash)
<a name="L953"><font color="white">00953</font>	// AimCalcMode is used as 0 = weapon firing, 1 = interface aim anticipation
<a name="L954"><font color="white">00954</font>	Simulated function rotator AdjustAim(Ammunition FiredAmmunition, vector projStart, int AimCalcMode)
<a name="L955"><font color="white">00955</font>	{
<a name="L956"><font color="white">00956</font>	    if ( Pawn != None &amp;&amp; !Pawn.IsLocallyControlled() )
<a name="L957"><font color="white">00957</font>	      AdjustAimForDisplay(FiredAmmunition, ProjStart);
<a name="L958"><font color="white">00958</font>	
<a name="L959"><font color="white">00959</font>	    if ( !FiredAmmunition.bInstantHit )
<a name="L960"><font color="white">00960</font>	      return rotator(AdjustedAimForFiring);
<a name="L961"><font color="white">00961</font>	    else
<a name="L962"><font color="white">00962</font>	      return rotator(OldAdjustAim);
<a name="L963"><font color="white">00963</font>	}
<a name="L964"><font color="white">00964</font>	
<a name="L965"><font color="white">00965</font>	//_____________________________________________________________________________
<a name="L966"><font color="white">00966</font>	exec function ShowMenu()
<a name="L967"><font color="white">00967</font>	{
<a name="L968"><font color="white">00968</font>	    log(&quot;SHOWMENU: &quot;$self);
<a name="L969"><font color="white">00969</font>	    if ( !Level.bLonePlayer || !Level.Game.bGameEnded || (XIIIGameInfo(Level.Game).XIIIEndGameType!=4) )
<a name="L970"><font color="white">00970</font>	      ConsoleCommand(&quot;ShowTheMenu &quot;$self);
<a name="L971"><font color="white">00971</font>	    if ( VP != none )
<a name="L972"><font color="white">00972</font>	      VP.Stop();
<a name="L973"><font color="white">00973</font>	}
<a name="L974"><font color="white">00974</font>	
<a name="L975"><font color="white">00975</font>	exec function ShowInfo()
<a name="L976"><font color="white">00976</font>	{
<a name="L977"><font color="white">00977</font>	    log(&quot;SHOWINFO: &quot;$self);
<a name="L978"><font color="white">00978</font>	    if (!bMenuIsActive)
<a name="L979"><font color="white">00979</font>	      MyHud.ShowScores();
<a name="L980"><font color="white">00980</font>	}
<a name="L981"><font color="white">00981</font>	
<a name="L982"><font color="white">00982</font>	//_____________________________________________________________________________
<a name="L983"><font color="white">00983</font>	exec function Duck( optional float F )
<a name="L984"><font color="white">00984</font>	{
<a name="L985"><font color="white">00985</font>	  bPressedDuck = true;
<a name="L986"><font color="white">00986</font>	}
<a name="L987"><font color="white">00987</font>	
<a name="L988"><font color="white">00988</font>	//_____________________________________________________________________________
<a name="L989"><font color="white">00989</font>	exec function QuickHeal()
<a name="L990"><font color="white">00990</font>	{
<a name="L991"><font color="white">00991</font>	    Local inventory Inv;
<a name="L992"><font color="white">00992</font>	
<a name="L993"><font color="white">00993</font>	    DebugLog(&quot;Quick Heal Call&quot;);
<a name="L994"><font color="white">00994</font>	    if ( (Pawn != none) &amp;&amp; (Pawn.region.zone != none) &amp;&amp; Pawn.region.Zone.FlashEffectDesc.IsActivated )
<a name="L995"><font color="white">00995</font>	      return;
<a name="L996"><font color="white">00996</font>	
<a name="L997"><font color="white">00997</font>	    if ( bWeaponBlock )
<a name="L998"><font color="white">00998</font>	      return;
<a name="L999"><font color="white">00999</font>	
<a name="L1000"><font color="white">01000</font>	    if ( !bWeaponMode )
<a name="L1001"><font color="white">01001</font>	    {
<a name="L1002"><font color="white">01002</font>	      if ( Med(Pawn.SelectedItem) != none )
<a name="L1003"><font color="white">01003</font>	      {
<a name="L1004"><font color="white">01004</font>	        ActivateItem();
<a name="L1005"><font color="white">01005</font>	        return;
<a name="L1006"><font color="white">01006</font>	      }
<a name="L1007"><font color="white">01007</font>	      if ( Med(Pawn.PendingItem) != none )
<a name="L1008"><font color="white">01008</font>	      { // don't use a possible pending item to avoid pb switching
<a name="L1009"><font color="white">01009</font>	        return;
<a name="L1010"><font color="white">01010</font>	      }
<a name="L1011"><font color="white">01011</font>	    }
<a name="L1012"><font color="white">01012</font>	
<a name="L1013"><font color="white">01013</font>	    if ( XIIIPawn(Pawn).HealthPercent() &lt;= 25 )
<a name="L1014"><font color="white">01014</font>	    { //seek FullMedKit
<a name="L1015"><font color="white">01015</font>	      Inv = Pawn.FindInventoryType(class'FullMedKit');
<a name="L1016"><font color="white">01016</font>	      if ( Inv == none )
<a name="L1017"><font color="white">01017</font>	        Inv = Pawn.FindInventoryType(class'MedKit');
<a name="L1018"><font color="white">01018</font>	    }
<a name="L1019"><font color="white">01019</font>	    else if ( XIIIPawn(Pawn).IsWounded() )
<a name="L1020"><font color="white">01020</font>	    { //seek MedKit
<a name="L1021"><font color="white">01021</font>	      Inv = Pawn.FindInventoryType(class'MedKit');
<a name="L1022"><font color="white">01022</font>	      if ( Inv == none )
<a name="L1023"><font color="white">01023</font>	        Inv = Pawn.FindInventoryType(class'FullMedKit');
<a name="L1024"><font color="white">01024</font>	    }
<a name="L1025"><font color="white">01025</font>	    if ( Inv != none )
<a name="L1026"><font color="white">01026</font>	    {
<a name="L1027"><font color="white">01027</font>	      DebugLog(&quot;Quick Heal Should HEAL using &quot;$Inv);
<a name="L1028"><font color="white">01028</font>	      Med(Inv).UseMeQuick(self);
<a name="L1029"><font color="white">01029</font>	      if ( Med(Inv).Charge &lt;=0 )
<a name="L1030"><font color="white">01030</font>	      {
<a name="L1031"><font color="white">01031</font>	        if ( Pawn.SelectedItem == Inv )
<a name="L1032"><font color="white">01032</font>	          Pawn.SelectedItem = none;
<a name="L1033"><font color="white">01033</font>	        if ( Pawn.PendingItem == Inv )
<a name="L1034"><font color="white">01034</font>	          Pawn.PendingItem = none;
<a name="L1035"><font color="white">01035</font>	        if ( OldItem == Inv )
<a name="L1036"><font color="white">01036</font>	          OldItem = none;
<a name="L1037"><font color="white">01037</font>	        Med(Inv).UsedUpNoChange();
<a name="L1038"><font color="white">01038</font>	      }
<a name="L1039"><font color="white">01039</font>	    }
<a name="L1040"><font color="white">01040</font>	
<a name="L1041"><font color="white">01041</font>	}
<a name="L1042"><font color="white">01042</font>	
<a name="L1043"><font color="white">01043</font>	//_____________________________________________________________________________
<a name="L1044"><font color="white">01044</font>	// ELR Use the ForceReload function of base weapons functions
<a name="L1045"><font color="white">01045</font>	exec function ReLoad()
<a name="L1046"><font color="white">01046</font>	{
<a name="L1047"><font color="white">01047</font>	    if ( (Pawn != none) &amp;&amp; (Pawn.region.zone != none) &amp;&amp; Pawn.region.Zone.FlashEffectDesc.IsActivated )
<a name="L1048"><font color="white">01048</font>	      return;
<a name="L1049"><font color="white">01049</font>	
<a name="L1050"><font color="white">01050</font>	    ForceReload();
<a name="L1051"><font color="white">01051</font>	}
<a name="L1052"><font color="white">01052</font>	
<a name="L1053"><font color="white">01053</font>	//_____________________________________________________________________________
<a name="L1054"><font color="white">01054</font>	// can't reload if have grabbed corpse/pawn
<a name="L1055"><font color="white">01055</font>	exec function ForceReload()
<a name="L1056"><font color="white">01056</font>	{
<a name="L1057"><font color="white">01057</font>	//    Log(&quot;ForceReLoad, Pawn=&quot;$Pawn@&quot;Pawn.Weapon=&quot;$Pawn.Weapon);
<a name="L1058"><font color="white">01058</font>	    if ( Level.bLonePlayer )
<a name="L1059"><font color="white">01059</font>	    {
<a name="L1060"><font color="white">01060</font>	      if ( (Pawn != None) &amp;&amp; (Pawn.Weapon != None) &amp;&amp; (XIIIPawn(Pawn).LHand.pOnShoulder == none) )
<a name="L1061"><font color="white">01061</font>	        Pawn.Weapon.ForceReload();
<a name="L1062"><font color="white">01062</font>	    }
<a name="L1063"><font color="white">01063</font>	    else
<a name="L1064"><font color="white">01064</font>	      if ( (Pawn != None) &amp;&amp; (Pawn.Weapon != None) )
<a name="L1065"><font color="white">01065</font>	        Pawn.Weapon.ForceReload();
<a name="L1066"><font color="white">01066</font>	}
<a name="L1067"><font color="white">01067</font>	
<a name="L1068"><font color="white">01068</font>	//_____________________________________________________________________________
<a name="L1069"><font color="white">01069</font>	// The player wants to fire.
<a name="L1070"><font color="white">01070</font>	exec function Fire( optional float F )
<a name="L1071"><font color="white">01071</font>	{
<a name="L1072"><font color="white">01072</font>	    if ( Pawn.region.Zone.FlashEffectDesc.IsActivated )
<a name="L1073"><font color="white">01073</font>	      return;
<a name="L1074"><font color="white">01074</font>	
<a name="L1075"><font color="white">01075</font>	    XIIIBaseHud(MyHud).fDrawWeaponsTimer = Level.TimeSeconds-10; // get rid of weapon/item drawing list
<a name="L1076"><font color="white">01076</font>	
<a name="L1077"><font color="white">01077</font>	    if ( XIIIPlayerPawn(Pawn).SSSk != none )
<a name="L1078"><font color="white">01078</font>	      XIIIPlayerPawn(Pawn).SSSk.ResetTimer();
<a name="L1079"><font color="white">01079</font>	
<a name="L1080"><font color="white">01080</font>	    if ( IsInState('CameraView') )
<a name="L1081"><font color="white">01081</font>	    {
<a name="L1082"><font color="white">01082</font>	      RestoreView();
<a name="L1083"><font color="white">01083</font>	      return;
<a name="L1084"><font color="white">01084</font>	    }
<a name="L1085"><font color="white">01085</font>	    if ( bWeaponMode )
<a name="L1086"><font color="white">01086</font>	    {
<a name="L1087"><font color="white">01087</font>	      if ( Pawn.Weapon != None )
<a name="L1088"><font color="white">01088</font>	        Pawn.Weapon.Fire(F);
<a name="L1089"><font color="white">01089</font>	    }
<a name="L1090"><font color="white">01090</font>	    else
<a name="L1091"><font color="white">01091</font>	    {
<a name="L1092"><font color="white">01092</font>	      if ( !bWeaponMode &amp;&amp; (Hook(Pawn.SelectedItem) != none) )
<a name="L1093"><font color="white">01093</font>	      {
<a name="L1094"><font color="white">01094</font>	        if ( !Hook(Pawn.SelectedItem).bGoUp &amp;&amp; (!Hook(Pawn.SelectedItem).bGoDown || Hook(Pawn.SelectedItem).ActivatedByFire) )
<a name="L1095"><font color="white">01095</font>	        {
<a name="L1096"><font color="white">01096</font>	          Hook(Pawn.SelectedItem).ActivatedByFire = true;
<a name="L1097"><font color="white">01097</font>	          ActivateItem();
<a name="L1098"><font color="white">01098</font>	        }
<a name="L1099"><font color="white">01099</font>	      }
<a name="L1100"><font color="white">01100</font>	      else
<a name="L1101"><font color="white">01101</font>	      {
<a name="L1102"><font color="white">01102</font>	//        log(&quot;Activating item via fire call&quot;);
<a name="L1103"><font color="white">01103</font>	        ActivateItem();
<a name="L1104"><font color="white">01104</font>	      }
<a name="L1105"><font color="white">01105</font>	      if (Level.NetMode == NM_Client)
<a name="L1106"><font color="white">01106</font>	      {
<a name="L1107"><font color="white">01107</font>	//        Log(&quot;Activate Item (on client) &quot;@Pawn.SelectedItem);
<a name="L1108"><font color="white">01108</font>	        if ( Level.Pauser!=None )
<a name="L1109"><font color="white">01109</font>	          return;
<a name="L1110"><font color="white">01110</font>	        if ( (Pawn != None) &amp;&amp; (Pawn.SelectedItem!=None) )
<a name="L1111"><font color="white">01111</font>	          Pawn.SelectedItem.Activate();
<a name="L1112"><font color="white">01112</font>	      }
<a name="L1113"><font color="white">01113</font>	    }
<a name="L1114"><font color="white">01114</font>	}
<a name="L1115"><font color="white">01115</font>	
<a name="L1116"><font color="white">01116</font>	//_____________________________________________________________________________
<a name="L1117"><font color="white">01117</font>	// The player Release fire.
<a name="L1118"><font color="white">01118</font>	exec function UnFire( optional float F )
<a name="L1119"><font color="white">01119</font>	{
<a name="L1120"><font color="white">01120</font>	//    Log(&quot;Calling Unfire&quot;);
<a name="L1121"><font color="white">01121</font>	    if ( bWeaponMode )
<a name="L1122"><font color="white">01122</font>	    {
<a name="L1123"><font color="white">01123</font>	      if ( (Pawn != none) &amp;&amp; (XIIIWeapon(Pawn.Weapon) != None) )
<a name="L1124"><font color="white">01124</font>	        XIIIWeapon(Pawn.Weapon).UnFire(F);
<a name="L1125"><font color="white">01125</font>	    }
<a name="L1126"><font color="white">01126</font>	}
<a name="L1127"><font color="white">01127</font>	
<a name="L1128"><font color="white">01128</font>	//_____________________________________________________________________________
<a name="L1129"><font color="white">01129</font>	exec function AltFire( optional float F )
<a name="L1130"><font color="white">01130</font>	{
<a name="L1131"><font color="white">01131</font>	    if ( Pawn.region.Zone.FlashEffectDesc.IsActivated )
<a name="L1132"><font color="white">01132</font>	      return;
<a name="L1133"><font color="white">01133</font>	
<a name="L1134"><font color="white">01134</font>	    if ( IsInState('CameraView') )
<a name="L1135"><font color="white">01135</font>	    {
<a name="L1136"><font color="white">01136</font>	      RestoreView();
<a name="L1137"><font color="white">01137</font>	      return;
<a name="L1138"><font color="white">01138</font>	    }
<a name="L1139"><font color="white">01139</font>	    if ( !bWeaponMode &amp;&amp; (Hook(Pawn.SelectedItem) != none) &amp;&amp; bHooked &amp;&amp; !Hook(Pawn.SelectedItem).bGoDown &amp;&amp; !Hook(Pawn.SelectedItem).bGoUp)
<a name="L1140"><font color="white">01140</font>	    {
<a name="L1141"><font color="white">01141</font>	      Hook(Pawn.SelectedItem).ActivatedByAltFire = true;
<a name="L1142"><font color="white">01142</font>	      ActivateItem();
<a name="L1143"><font color="white">01143</font>	    }
<a name="L1144"><font color="white">01144</font>	/*
<a name="L1145"><font color="white">01145</font>	    else if ( XIIIPawn(Pawn).LHand.pOnShoulder != none )
<a name="L1146"><font color="white">01146</font>	    {
<a name="L1147"><font color="white">01147</font>	      XIIIPawn(Pawn).LHand.UnGrabPawn();
<a name="L1148"><font color="white">01148</font>	    }
<a name="L1149"><font color="white">01149</font>	    else if ( MyInteraction.bCanGrabCorpse || MyInteraction.bCanTakePrisonner )
<a name="L1150"><font color="white">01150</font>	    {
<a name="L1151"><font color="white">01151</font>	      XIIIPawn(Pawn).LHand.GrabPawn(XIIIPawn(MyInteraction.TargetActor));
<a name="L1152"><font color="white">01152</font>	      XIIIPawn(Pawn).CheckMaluses();
<a name="L1153"><font color="white">01153</font>	    }
<a name="L1154"><font color="white">01154</font>	*/
<a name="L1155"><font color="white">01155</font>	//    else if ( !bWeaponMode &amp;&amp; (Micro(Pawn.SelectedItem) != none) ) // Creates dependency
<a name="L1156"><font color="white">01156</font>	    else if ( !bWeaponMode &amp;&amp; Pawn.SelectedItem.IsA('Micro') ) // don't create dependency
<a name="L1157"><font color="white">01157</font>	      Fire();
<a name="L1158"><font color="white">01158</font>	    else if ( bWeaponMode )
<a name="L1159"><font color="white">01159</font>	      WeaponZoom();
<a name="L1160"><font color="white">01160</font>	}
<a name="L1161"><font color="white">01161</font>	
<a name="L1162"><font color="white">01162</font>	//_____________________________________________________________________________
<a name="L1163"><font color="white">01163</font>	// ELR hide/unhide Weapon
<a name="L1164"><font color="white">01164</font>	simulated function SwitchWeaponMode()
<a name="L1165"><font color="white">01165</font>	{
<a name="L1166"><font color="white">01166</font>	    local inventory I;
<a name="L1167"><font color="white">01167</font>	
<a name="L1168"><font color="white">01168</font>	    DebugLog(&quot;&gt;&gt;&gt; SwitchWeaponMode call, bWeaponMode=&quot;$bWeaponMode@&quot;bWaitForWeaponMode=&quot;$bWaitForWeaponMode);
<a name="L1169"><font color="white">01169</font>	
<a name="L1170"><font color="white">01170</font>	    if ( !bWeaponMode )
<a name="L1171"><font color="white">01171</font>	    {
<a name="L1172"><font color="white">01172</font>	      DebugLog(&quot;  &gt; Calling PutDown for&quot;@XIIIItems(Pawn.SelectedItem));
<a name="L1173"><font color="white">01173</font>	      XIIIItems(Pawn.SelectedItem).PutDown();
<a name="L1174"><font color="white">01174</font>	      if ( XIIIPawn(Pawn).bHaveOnlyOneHandFree &amp;&amp; (XIIIWeapon(Pawn.Weapon).WHand == WHA_2HShot) )
<a name="L1175"><font color="white">01175</font>	        Pawn.PendingWeapon = Pawn.Inventory.NextWeapon(None, Pawn.Weapon);
<a name="L1176"><font color="white">01176</font>	      else
<a name="L1177"><font color="white">01177</font>	        Pawn.PendingWeapon = Pawn.Weapon;
<a name="L1178"><font color="white">01178</font>	    }
<a name="L1179"><font color="white">01179</font>	    else
<a name="L1180"><font color="white">01180</font>	    {
<a name="L1181"><font color="white">01181</font>	      if ( !bHooked ) // Reset to MedKits priority
<a name="L1182"><font color="white">01182</font>	        XIIIPawn(Pawn).SelectedItem = Pawn.Inventory.NextItem(none, none);
<a name="L1183"><font color="white">01183</font>	      else
<a name="L1184"><font color="white">01184</font>	        XIIIPawn(Pawn).SelectedItem = HookUsed;
<a name="L1185"><font color="white">01185</font>	      if ( XIIIPawn(Pawn).bHaveOnlyOneHandFree &amp;&amp; (XIIIItems(Pawn.SelectedItem).IHand == IH_2H) )
<a name="L1186"><font color="white">01186</font>	        XIIIPawn(Pawn).SelectedItem = Pawn.Inventory.NextItem(none, XIIIPawn(Pawn).SelectedItem);
<a name="L1187"><font color="white">01187</font>	      if ( XIIIPawn(Pawn).SelectedItem != none )
<a name="L1188"><font color="white">01188</font>	      {
<a name="L1189"><font color="white">01189</font>	//        XIIIPawn(Pawn).PendingItem = Pawn.SelectedItem;
<a name="L1190"><font color="white">01190</font>	        DebugLog(&quot;  &gt; Calling PutDown for&quot;@Pawn.Weapon);
<a name="L1191"><font color="white">01191</font>	        Pawn.Weapon.PutDown();
<a name="L1192"><font color="white">01192</font>	      }
<a name="L1193"><font color="white">01193</font>	      else
<a name="L1194"><font color="white">01194</font>	      { // Cancel Change
<a name="L1195"><font color="white">01195</font>	        bWaitForWeaponMode = true;
<a name="L1196"><font color="white">01196</font>	      }
<a name="L1197"><font color="white">01197</font>	/*
<a name="L1198"><font color="white">01198</font>	      I = Pawn.Inventory.SelectNext();
<a name="L1199"><font color="white">01199</font>	//      log(&quot;  &gt; SelectNext Result=&quot;$I);
<a name="L1200"><font color="white">01200</font>	      if (I != none )
<a name="L1201"><font color="white">01201</font>	      {
<a name="L1202"><font color="white">01202</font>	        XIIIPawn(Pawn).PendingItem = Pawn.SelectedItem;
<a name="L1203"><font color="white">01203</font>	//        log(&quot;  &gt; Calling Putdown for&quot;@Pawn.Weapon);
<a name="L1204"><font color="white">01204</font>	        Pawn.Weapon.PutDown();
<a name="L1205"><font color="white">01205</font>	      }
<a name="L1206"><font color="white">01206</font>	      else
<a name="L1207"><font color="white">01207</font>	      {
<a name="L1208"><font color="white">01208</font>	        bWaitForWeaponMode = true;
<a name="L1209"><font color="white">01209</font>	      }
<a name="L1210"><font color="white">01210</font>	*/
<a name="L1211"><font color="white">01211</font>	    }
<a name="L1212"><font color="white">01212</font>	//    ServerSwitchWeaponMode(bWeaponMode, bWaitForWeaponMode);
<a name="L1213"><font color="white">01213</font>	}
<a name="L1214"><font color="white">01214</font>	
<a name="L1215"><font color="white">01215</font>	//_____________________________________________________________________________
<a name="L1216"><font color="white">01216</font>	// ELR hide/unhide Weapon (Used by the DecoWeapon to hide weapon then put it back when used)
<a name="L1217"><font color="white">01217</font>	exec function HideWeapon()
<a name="L1218"><font color="white">01218</font>	{
<a name="L1219"><font color="white">01219</font>	    if ( XIIIWeapon(pawn.Weapon) != none )
<a name="L1220"><font color="white">01220</font>	    {
<a name="L1221"><font color="white">01221</font>	      if ( bWeaponMode )
<a name="L1222"><font color="white">01222</font>	        SwitchWeapon( OldWeap );
<a name="L1223"><font color="white">01223</font>	      else
<a name="L1224"><font color="white">01224</font>	      {
<a name="L1225"><font color="white">01225</font>	        OldWeap = pawn.weapon.InventoryGroup;
<a name="L1226"><font color="white">01226</font>	        switchweapon( 0 );
<a name="L1227"><font color="white">01227</font>	      }
<a name="L1228"><font color="white">01228</font>	    }
<a name="L1229"><font color="white">01229</font>	}
<a name="L1230"><font color="white">01230</font>	
<a name="L1231"><font color="white">01231</font>	//_____________________________________________________________________________
<a name="L1232"><font color="white">01232</font>	exec function PrevWeapon()
<a name="L1233"><font color="white">01233</font>	{
<a name="L1234"><font color="white">01234</font>	    if ( Pawn.region.Zone.FlashEffectDesc.IsActivated )
<a name="L1235"><font color="white">01235</font>	      return;
<a name="L1236"><font color="white">01236</font>	
<a name="L1237"><font color="white">01237</font>	    if ( (Pawn.PendingWeapon != none) &amp;&amp; (DecoWeapon(Pawn.PendingWeapon) != none) )
<a name="L1238"><font color="white">01238</font>	      return;
<a name="L1239"><font color="white">01239</font>	
<a name="L1240"><font color="white">01240</font>	//    if ( (XIIIItems(Pawn.SelectedItem) != none) &amp;&amp; XIIIItems(Pawn.SelectedItem).bChangeItem &amp;&amp; !Pawn.SelectedItem.IsAnimating() )
<a name="L1241"><font color="white">01241</font>	//    { // Bug chance for freezed inventory switching
<a name="L1242"><font color="white">01242</font>	//      Pawn.SelectedItem.AnimEnd(0);
<a name="L1243"><font color="white">01243</font>	//    }
<a name="L1244"><font color="white">01244</font>	//    if ( (Pawn.Weapon != none) &amp;&amp; Pawn.Weapon.bChangeWeapon &amp;&amp; !Pawn.Weapon.IsAnimating() )
<a name="L1245"><font color="white">01245</font>	//    { // Bug chance for freezed inventory switching
<a name="L1246"><font color="white">01246</font>	//      Pawn.Weapon.AnimEnd(0);
<a name="L1247"><font color="white">01247</font>	//    }
<a name="L1248"><font color="white">01248</font>	
<a name="L1249"><font color="white">01249</font>	    Pawn.PendingItem = none;
<a name="L1250"><font color="white">01250</font>	
<a name="L1251"><font color="white">01251</font>	    XIIIBaseHud(MyHud).bDrawWeapons = true;
<a name="L1252"><font color="white">01252</font>	    XIIIBaseHud(MyHud).bDrawItems = false;
<a name="L1253"><font color="white">01253</font>	    XIIIBaseHud(MyHud).fDrawWeaponsTimer = Level.TimeSeconds + 1.0;
<a name="L1254"><font color="white">01254</font>	    XIIIBaseHud(MyHud).fDrawItemsTimer = Level.TimeSeconds - 1.0;
<a name="L1255"><font color="white">01255</font>	
<a name="L1256"><font color="white">01256</font>	//    if ( bWeaponMode || bWaitForWeaponMode )
<a name="L1257"><font color="white">01257</font>	    if ( bWaitForWeaponMode )
<a name="L1258"><font color="white">01258</font>	    {
<a name="L1259"><font color="white">01259</font>	      if ( Level.Pauser != None )
<a name="L1260"><font color="white">01260</font>	        return;
<a name="L1261"><font color="white">01261</font>	      if ( Pawn.Weapon == None )
<a name="L1262"><font color="white">01262</font>	      {
<a name="L1263"><font color="white">01263</font>	        SwitchToBestWeapon();
<a name="L1264"><font color="white">01264</font>	        return;
<a name="L1265"><font color="white">01265</font>	      }
<a name="L1266"><font color="white">01266</font>	      if ( Pawn.PendingWeapon != None )
<a name="L1267"><font color="white">01267</font>	        Pawn.PendingWeapon = Pawn.Inventory.PrevWeapon(None, Pawn.PendingWeapon);
<a name="L1268"><font color="white">01268</font>	      else
<a name="L1269"><font color="white">01269</font>	        Pawn.PendingWeapon = Pawn.Inventory.PrevWeapon(None, Pawn.Weapon);
<a name="L1270"><font color="white">01270</font>	
<a name="L1271"><font color="white">01271</font>	      if ( Pawn.PendingWeapon != None )
<a name="L1272"><font color="white">01272</font>	      {
<a name="L1273"><font color="white">01273</font>	        Pawn.Weapon.PutDown();
<a name="L1274"><font color="white">01274</font>	      }
<a name="L1275"><font color="white">01275</font>	    }
<a name="L1276"><font color="white">01276</font>	    else
<a name="L1277"><font color="white">01277</font>	    {
<a name="L1278"><font color="white">01278</font>	      XIIIBaseHud(MyHud).fDrawWeaponsTimer = Level.TimeSeconds+2.0;
<a name="L1279"><font color="white">01279</font>	      bWaitForWeaponMode = true;
<a name="L1280"><font color="white">01280</font>	      SwitchWeaponMode();
<a name="L1281"><font color="white">01281</font>	    }
<a name="L1282"><font color="white">01282</font>	}
<a name="L1283"><font color="white">01283</font>	
<a name="L1284"><font color="white">01284</font>	//_____________________________________________________________________________
<a name="L1285"><font color="white">01285</font>	exec function NextWeapon()
<a name="L1286"><font color="white">01286</font>	{
<a name="L1287"><font color="white">01287</font>	    if ( Pawn.region.Zone.FlashEffectDesc.IsActivated )
<a name="L1288"><font color="white">01288</font>	      return;
<a name="L1289"><font color="white">01289</font>	
<a name="L1290"><font color="white">01290</font>	    if ( (Pawn.PendingWeapon != none) &amp;&amp; (DecoWeapon(Pawn.PendingWeapon) != none) )
<a name="L1291"><font color="white">01291</font>	      return;
<a name="L1292"><font color="white">01292</font>	
<a name="L1293"><font color="white">01293</font>	//    if ( (XIIIItems(Pawn.SelectedItem) != none) &amp;&amp; XIIIItems(Pawn.SelectedItem).bChangeItem &amp;&amp; !Pawn.SelectedItem.IsAnimating() )
<a name="L1294"><font color="white">01294</font>	//    { // Bug chance for freezed inventory switching
<a name="L1295"><font color="white">01295</font>	//      Pawn.SelectedItem.AnimEnd(0);
<a name="L1296"><font color="white">01296</font>	//    }
<a name="L1297"><font color="white">01297</font>	//    if ( (Pawn.Weapon != none) &amp;&amp; Pawn.Weapon.bChangeWeapon &amp;&amp; !Pawn.Weapon.IsAnimating() )
<a name="L1298"><font color="white">01298</font>	//    { // Bug chance for freezed inventory switching
<a name="L1299"><font color="white">01299</font>	//      Pawn.Weapon.AnimEnd(0);
<a name="L1300"><font color="white">01300</font>	//    }
<a name="L1301"><font color="white">01301</font>	    Pawn.PendingItem = none;
<a name="L1302"><font color="white">01302</font>	
<a name="L1303"><font color="white">01303</font>	    XIIIBaseHud(MyHud).bDrawWeapons = true;
<a name="L1304"><font color="white">01304</font>	    XIIIBaseHud(MyHud).bDrawItems = false;
<a name="L1305"><font color="white">01305</font>	    XIIIBaseHud(MyHud).fDrawWeaponsTimer = Level.TimeSeconds + 1.0;
<a name="L1306"><font color="white">01306</font>	    XIIIBaseHud(MyHud).fDrawItemsTimer = Level.TimeSeconds - 1.0;
<a name="L1307"><font color="white">01307</font>	
<a name="L1308"><font color="white">01308</font>	//    if ( bWeaponMode || bWaitForWeaponMode )
<a name="L1309"><font color="white">01309</font>	    if ( bWaitForWeaponMode )
<a name="L1310"><font color="white">01310</font>	    {
<a name="L1311"><font color="white">01311</font>	//      Log(&quot;&gt; NextWeapon call in &quot;$self);
<a name="L1312"><font color="white">01312</font>	      if( Level.Pauser!=None )
<a name="L1313"><font color="white">01313</font>	        return;
<a name="L1314"><font color="white">01314</font>	      if ( Pawn.Weapon == None )
<a name="L1315"><font color="white">01315</font>	      {
<a name="L1316"><font color="white">01316</font>	        SwitchToBestWeapon();
<a name="L1317"><font color="white">01317</font>	        return;
<a name="L1318"><font color="white">01318</font>	      }
<a name="L1319"><font color="white">01319</font>	      if ( Pawn.PendingWeapon != None )
<a name="L1320"><font color="white">01320</font>	        Pawn.PendingWeapon = Pawn.Inventory.NextWeapon(None, Pawn.PendingWeapon);
<a name="L1321"><font color="white">01321</font>	      else
<a name="L1322"><font color="white">01322</font>	        Pawn.PendingWeapon = Pawn.Inventory.NextWeapon(None, Pawn.Weapon);
<a name="L1323"><font color="white">01323</font>	
<a name="L1324"><font color="white">01324</font>	      if ( Pawn.PendingWeapon != None )
<a name="L1325"><font color="white">01325</font>	      {
<a name="L1326"><font color="white">01326</font>	        Pawn.Weapon.PutDown();
<a name="L1327"><font color="white">01327</font>	      }
<a name="L1328"><font color="white">01328</font>	    }
<a name="L1329"><font color="white">01329</font>	    else
<a name="L1330"><font color="white">01330</font>	    {
<a name="L1331"><font color="white">01331</font>	      XIIIBaseHud(MyHud).fDrawWeaponsTimer = Level.TimeSeconds+2.0;
<a name="L1332"><font color="white">01332</font>	      bWaitForWeaponMode = true;
<a name="L1333"><font color="white">01333</font>	      SwitchWeaponMode();
<a name="L1334"><font color="white">01334</font>	    }
<a name="L1335"><font color="white">01335</font>	}
<a name="L1336"><font color="white">01336</font>	
<a name="L1337"><font color="white">01337</font>	
<a name="L1338"><font color="white">01338</font>	//_____________________________________________________________________________
<a name="L1339"><font color="white">01339</font>	// we want the player to switch to weapon group number F.
<a name="L1340"><font color="white">01340</font>	exec function SwitchWeapon( byte F )
<a name="L1341"><font color="white">01341</font>	{
<a name="L1342"><font color="white">01342</font>		local weapon newWeapon;
<a name="L1343"><font color="white">01343</font>	
<a name="L1344"><font color="white">01344</font>		if ( (Pawn == none) || Pawn.bIsDead )
<a name="L1345"><font color="white">01345</font>		  return;
<a name="L1346"><font color="white">01346</font>	
<a name="L1347"><font color="white">01347</font>		if ( (Level.Pauser!=None) || (Pawn == None) || (Pawn.Inventory == None) )
<a name="L1348"><font color="white">01348</font>			return;
<a name="L1349"><font color="white">01349</font>		if ( (Pawn.Weapon != None) &amp;&amp; (Pawn.Weapon.Inventory != None) )
<a name="L1350"><font color="white">01350</font>			newWeapon = Pawn.Weapon.Inventory.WeaponChange(F);
<a name="L1351"><font color="white">01351</font>		else
<a name="L1352"><font color="white">01352</font>			newWeapon = None;
<a name="L1353"><font color="white">01353</font>		if ( newWeapon == None )
<a name="L1354"><font color="white">01354</font>			newWeapon = Pawn.Inventory.WeaponChange(F);
<a name="L1355"><font color="white">01355</font>	
<a name="L1356"><font color="white">01356</font>		if ( newWeapon == None )
<a name="L1357"><font color="white">01357</font>		{ // ELR Don't just return, switchweapon(0) instead
<a name="L1358"><font color="white">01358</font>	    SwitchWeapon(0);
<a name="L1359"><font color="white">01359</font>	  	return;
<a name="L1360"><font color="white">01360</font>	  }
<a name="L1361"><font color="white">01361</font>	
<a name="L1362"><font color="white">01362</font>		if ( Pawn.Weapon == None )
<a name="L1363"><font color="white">01363</font>		{
<a name="L1364"><font color="white">01364</font>			Pawn.PendingWeapon = newWeapon;
<a name="L1365"><font color="white">01365</font>			Pawn.ChangedWeapon();
<a name="L1366"><font color="white">01366</font>		}
<a name="L1367"><font color="white">01367</font>		else if ( Pawn.Weapon != newWeapon )
<a name="L1368"><font color="white">01368</font>		{
<a name="L1369"><font color="white">01369</font>			Pawn.PendingWeapon = newWeapon;
<a name="L1370"><font color="white">01370</font>			if ( !Pawn.Weapon.PutDown() )
<a name="L1371"><font color="white">01371</font>				Pawn.PendingWeapon = None;
<a name="L1372"><font color="white">01372</font>		}
<a name="L1373"><font color="white">01373</font>	}
<a name="L1374"><font color="white">01374</font>	
<a name="L1375"><font color="white">01375</font>	/*
<a name="L1376"><font color="white">01376</font>	//_____________________________________________________________________________
<a name="L1377"><font color="white">01377</font>	exec function TestNI()
<a name="L1378"><font color="white">01378</font>	{
<a name="L1379"><font color="white">01379</font>	    local int i;
<a name="L1380"><font color="white">01380</font>	    local inventory Inv;
<a name="L1381"><font color="white">01381</font>	
<a name="L1382"><font color="white">01382</font>	    Inv = Pawn.Inventory;
<a name="L1383"><font color="white">01383</font>	    Log(&quot;BEGIN Testing NextItem From PawnInventory&quot;@Inv);
<a name="L1384"><font color="white">01384</font>	    for (i=0; i&lt;5; i++)
<a name="L1385"><font color="white">01385</font>	    {
<a name="L1386"><font color="white">01386</font>	      if ( inv != none )
<a name="L1387"><font color="white">01387</font>	      {
<a name="L1388"><font color="white">01388</font>	        if ( PowerUps(Inv) != none )
<a name="L1389"><font color="white">01389</font>	          Inv = Inv.NextItem(none, PowerUps(Inv));
<a name="L1390"><font color="white">01390</font>	        else
<a name="L1391"><font color="white">01391</font>	          Inv = Inv.NextItem(none, none);
<a name="L1392"><font color="white">01392</font>	        if ( Inv != none )
<a name="L1393"><font color="white">01393</font>	          Log(&quot;  Next Inv=&quot;$Inv);
<a name="L1394"><font color="white">01394</font>	        else
<a name="L1395"><font color="white">01395</font>	          Log(&quot;  Next Inv=NONE&quot;);
<a name="L1396"><font color="white">01396</font>	      }
<a name="L1397"><font color="white">01397</font>	    }
<a name="L1398"><font color="white">01398</font>	    Log(&quot;END Testing NextItem&quot;);
<a name="L1399"><font color="white">01399</font>	    Inv = Pawn.Inventory;
<a name="L1400"><font color="white">01400</font>	    Log(&quot;BEGIN Testing NextItem From PawnSelectedItem&quot;@Pawn.SelectedItem);
<a name="L1401"><font color="white">01401</font>	    for (i=0; i&lt;5; i++)
<a name="L1402"><font color="white">01402</font>	    {
<a name="L1403"><font color="white">01403</font>	      if ( inv != none )
<a name="L1404"><font color="white">01404</font>	      {
<a name="L1405"><font color="white">01405</font>	        if ( Pawn.SelectedItem != none )
<a name="L1406"><font color="white">01406</font>	          Inv = Inv.NextItem(none, Pawn.SelectedItem);
<a name="L1407"><font color="white">01407</font>	        else
<a name="L1408"><font color="white">01408</font>	          Inv = Inv.NextItem(none, none);
<a name="L1409"><font color="white">01409</font>	        if ( Inv != none )
<a name="L1410"><font color="white">01410</font>	          Log(&quot;  Next Inv=&quot;$Inv);
<a name="L1411"><font color="white">01411</font>	        else
<a name="L1412"><font color="white">01412</font>	          Log(&quot;  Next Inv=NONE&quot;);
<a name="L1413"><font color="white">01413</font>	      }
<a name="L1414"><font color="white">01414</font>	    }
<a name="L1415"><font color="white">01415</font>	    Log(&quot;END Testing NextItem&quot;);
<a name="L1416"><font color="white">01416</font>	}
<a name="L1417"><font color="white">01417</font>	*/
<a name="L1418"><font color="white">01418</font>	
<a name="L1419"><font color="white">01419</font>	//_____________________________________________________________________________
<a name="L1420"><font color="white">01420</font>	// ELR Just to cancel it in some states
<a name="L1421"><font color="white">01421</font>	exec function cPrevItem()
<a name="L1422"><font color="white">01422</font>	{
<a name="L1423"><font color="white">01423</font>	    Local inventory tInv;
<a name="L1424"><font color="white">01424</font>	
<a name="L1425"><font color="white">01425</font>	    if ( Pawn.region.Zone.FlashEffectDesc.IsActivated )
<a name="L1426"><font color="white">01426</font>	      return;
<a name="L1427"><font color="white">01427</font>	
<a name="L1428"><font color="white">01428</font>	    DebugLog(&quot;PREVITEM bWeaponMode=&quot;$bWeaponMode@&quot;PendingWeapon=&quot;$Pawn.PendingWeapon);
<a name="L1429"><font color="white">01429</font>	
<a name="L1430"><font color="white">01430</font>	    if ( DecoWeapon(Pawn.PendingWeapon) != none )
<a name="L1431"><font color="white">01431</font>	      return;
<a name="L1432"><font color="white">01432</font>	
<a name="L1433"><font color="white">01433</font>	//    if ( (XIIIItems(Pawn.SelectedItem) != none) &amp;&amp; XIIIItems(Pawn.SelectedItem).bChangeItem &amp;&amp; !Pawn.SelectedItem.IsAnimating() )
<a name="L1434"><font color="white">01434</font>	//    { // Bug chance for freezed inventory switching
<a name="L1435"><font color="white">01435</font>	//      Pawn.SelectedItem.AnimEnd(0);
<a name="L1436"><font color="white">01436</font>	//    }
<a name="L1437"><font color="white">01437</font>	//    if ( (Pawn.Weapon != none) &amp;&amp; Pawn.Weapon.bChangeWeapon &amp;&amp; !Pawn.Weapon.IsAnimating() )
<a name="L1438"><font color="white">01438</font>	//    { // Bug chance for freezed inventory switching
<a name="L1439"><font color="white">01439</font>	//      Pawn.Weapon.AnimEnd(0);
<a name="L1440"><font color="white">01440</font>	//    }
<a name="L1441"><font color="white">01441</font>	
<a name="L1442"><font color="white">01442</font>	    Pawn.PendingWeapon = none;
<a name="L1443"><font color="white">01443</font>	
<a name="L1444"><font color="white">01444</font>	    XIIIBaseHud(MyHud).bDrawWeapons=false;
<a name="L1445"><font color="white">01445</font>	    XIIIBaseHud(MyHud).bDrawItems = true;
<a name="L1446"><font color="white">01446</font>	    XIIIBaseHud(MyHud).fDrawItemsTimer = 1.0+Level.TimeSeconds;
<a name="L1447"><font color="white">01447</font>	    XIIIBaseHud(MyHud).fDrawWeaponsTimer = Level.TimeSeconds-1.0;
<a name="L1448"><font color="white">01448</font>	
<a name="L1449"><font color="white">01449</font>	//    if ( !bWeaponMode || !bWaitForWeaponMode )
<a name="L1450"><font color="white">01450</font>	    if ( !bWaitForWeaponMode )
<a name="L1451"><font color="white">01451</font>	    { // Selecting next item
<a name="L1452"><font color="white">01452</font>	      DebugLog(&quot;  &gt; cPrevItem call in &quot;$self$&quot;, switching items w/ SelectedItem=&quot;$Pawn.SelectedItem);
<a name="L1453"><font color="white">01453</font>	      if( Level.Pauser != None )
<a name="L1454"><font color="white">01454</font>	        return;
<a name="L1455"><font color="white">01455</font>	      if ( XIIIPawn(Pawn).PendingItem == none )
<a name="L1456"><font color="white">01456</font>	        XIIIPawn(Pawn).PendingItem = Pawn.Inventory.PrevItem(none, Pawn.SelectedItem);
<a name="L1457"><font color="white">01457</font>	      else
<a name="L1458"><font color="white">01458</font>	        XIIIPawn(Pawn).PendingItem = Pawn.Inventory.PrevItem(none, XIIIPawn(Pawn).PendingItem);
<a name="L1459"><font color="white">01459</font>	      if ( (XIIIPawn(Pawn).PendingItem != None) &amp;&amp; (XIIIPawn(Pawn).PendingItem != Pawn.SelectedItem) )
<a name="L1460"><font color="white">01460</font>	      {
<a name="L1461"><font color="white">01461</font>	        if(  XIIIItems(Pawn.SelectedItem) != none )
<a name="L1462"><font color="white">01462</font>	        {
<a name="L1463"><font color="white">01463</font>	          XIIIItems(Pawn.SelectedItem).PutDown();
<a name="L1464"><font color="white">01464</font>	          DebugLog(&quot;  &gt; cPrevItem puting down&quot;@XIIIItems(Pawn.SelectedItem));
<a name="L1465"><font color="white">01465</font>	        }
<a name="L1466"><font color="white">01466</font>	        else
<a name="L1467"><font color="white">01467</font>	        {
<a name="L1468"><font color="white">01468</font>	          Pawn.SelectedItem = XIIIPawn(Pawn).PendingItem;
<a name="L1469"><font color="white">01469</font>	          XIIIItems(XIIIPawn(Pawn).PendingItem).BringUp();
<a name="L1470"><font color="white">01470</font>	          DebugLog(&quot;  &gt; cPrevItem BringUp&quot;@XIIIPawn(Pawn).PendingItem@&quot;because selected = none&quot;);
<a name="L1471"><font color="white">01471</font>	        }
<a name="L1472"><font color="white">01472</font>	        return;
<a name="L1473"><font color="white">01473</font>	      }
<a name="L1474"><font color="white">01474</font>	      if ( (XIIIPawn(Pawn).PendingItem == None) &amp;&amp; (Pawn.SelectedItem == none) )
<a name="L1475"><font color="white">01475</font>	      {
<a name="L1476"><font color="white">01476</font>	        Warn(&quot;!@! PrevItem w/ Pending item &amp; Item none&quot;);
<a name="L1477"><font color="white">01477</font>	        NextWeapon();
<a name="L1478"><font color="white">01478</font>	        Pawn.ChangedWeapon();
<a name="L1479"><font color="white">01479</font>	      }
<a name="L1480"><font color="white">01480</font>	    }
<a name="L1481"><font color="white">01481</font>	    else
<a name="L1482"><font color="white">01482</font>	    {
<a name="L1483"><font color="white">01483</font>	      DebugLog(&quot;&gt;&gt;&gt; cPrevItem call in &quot;$self$&quot;, going to item mode&quot;);
<a name="L1484"><font color="white">01484</font>	      XIIIBaseHud(MyHud).fDrawItemsTimer = 2.0+Level.TimeSeconds;
<a name="L1485"><font color="white">01485</font>	      bWaitForWeaponMode = false;
<a name="L1486"><font color="white">01486</font>	      SwitchWeaponMode();
<a name="L1487"><font color="white">01487</font>	    }
<a name="L1488"><font color="white">01488</font>	}
<a name="L1489"><font color="white">01489</font>	
<a name="L1490"><font color="white">01490</font>	//_____________________________________________________________________________
<a name="L1491"><font color="white">01491</font>	// ELR Just to cancel it in some states
<a name="L1492"><font color="white">01492</font>	exec function cNextItem()
<a name="L1493"><font color="white">01493</font>	{
<a name="L1494"><font color="white">01494</font>	    Local inventory tInv;
<a name="L1495"><font color="white">01495</font>	
<a name="L1496"><font color="white">01496</font>	    if ( Pawn.region.Zone.FlashEffectDesc.IsActivated )
<a name="L1497"><font color="white">01497</font>	      return;
<a name="L1498"><font color="white">01498</font>	
<a name="L1499"><font color="white">01499</font>	    DebugLog(&quot;NEXTITEM bWeaponMode=&quot;$bWeaponMode@&quot;PendingWeapon=&quot;$Pawn.PendingWeapon);
<a name="L1500"><font color="white">01500</font>	
<a name="L1501"><font color="white">01501</font>	    if ( DecoWeapon(Pawn.PendingWeapon) != none )
<a name="L1502"><font color="white">01502</font>	      return;
<a name="L1503"><font color="white">01503</font>	
<a name="L1504"><font color="white">01504</font>	//    if ( (XIIIItems(Pawn.SelectedItem) != none) &amp;&amp; XIIIItems(Pawn.SelectedItem).bChangeItem &amp;&amp; !Pawn.SelectedItem.IsAnimating() )
<a name="L1505"><font color="white">01505</font>	//    { // Bug chance for freezed inventory switching
<a name="L1506"><font color="white">01506</font>	//      Pawn.SelectedItem.AnimEnd(0);
<a name="L1507"><font color="white">01507</font>	//    }
<a name="L1508"><font color="white">01508</font>	//    if ( (Pawn.Weapon != none) &amp;&amp; Pawn.Weapon.bChangeWeapon &amp;&amp; !Pawn.Weapon.IsAnimating() )
<a name="L1509"><font color="white">01509</font>	//    { // Bug chance for freezed inventory switching
<a name="L1510"><font color="white">01510</font>	//      Pawn.Weapon.AnimEnd(0);
<a name="L1511"><font color="white">01511</font>	//    }
<a name="L1512"><font color="white">01512</font>	
<a name="L1513"><font color="white">01513</font>	    Pawn.PendingWeapon = none;
<a name="L1514"><font color="white">01514</font>	
<a name="L1515"><font color="white">01515</font>	    XIIIBaseHud(MyHud).bDrawWeapons = false;
<a name="L1516"><font color="white">01516</font>	    XIIIBaseHud(MyHud).bDrawItems = true;
<a name="L1517"><font color="white">01517</font>	    XIIIBaseHud(MyHud).fDrawItemsTimer = 1.0+Level.TimeSeconds;
<a name="L1518"><font color="white">01518</font>	    XIIIBaseHud(MyHud).fDrawWeaponsTimer = Level.TimeSeconds-1.0;
<a name="L1519"><font color="white">01519</font>	
<a name="L1520"><font color="white">01520</font>	//    if ( !bWeaponMode || !bWaitForWeaponMode )
<a name="L1521"><font color="white">01521</font>	    if ( !bWaitForWeaponMode )
<a name="L1522"><font color="white">01522</font>	    { // Selecting next item
<a name="L1523"><font color="white">01523</font>	      DebugLog(&quot;  &gt; cNextItem call in &quot;$self$&quot;, switching items w/ SelectedItem=&quot;$Pawn.SelectedItem);
<a name="L1524"><font color="white">01524</font>	      if( Level.Pauser != None )
<a name="L1525"><font color="white">01525</font>	        return;
<a name="L1526"><font color="white">01526</font>	      if ( XIIIPawn(Pawn).PendingItem == none )
<a name="L1527"><font color="white">01527</font>	        XIIIPawn(Pawn).PendingItem = Pawn.Inventory.NextItem(none, Pawn.SelectedItem);
<a name="L1528"><font color="white">01528</font>	      else
<a name="L1529"><font color="white">01529</font>	        XIIIPawn(Pawn).PendingItem = Pawn.Inventory.NextItem(none, XIIIPawn(Pawn).PendingItem);
<a name="L1530"><font color="white">01530</font>	      if ( (XIIIPawn(Pawn).PendingItem != None) &amp;&amp; (XIIIPawn(Pawn).PendingItem != Pawn.SelectedItem) )
<a name="L1531"><font color="white">01531</font>	      {
<a name="L1532"><font color="white">01532</font>	        if ( XIIIItems(Pawn.SelectedItem) != none )
<a name="L1533"><font color="white">01533</font>	        {
<a name="L1534"><font color="white">01534</font>	          XIIIItems(Pawn.SelectedItem).PutDown();
<a name="L1535"><font color="white">01535</font>	          DebugLog(&quot;  &gt; cNextItem puting down&quot;@XIIIItems(Pawn.SelectedItem));
<a name="L1536"><font color="white">01536</font>	        }
<a name="L1537"><font color="white">01537</font>	        else
<a name="L1538"><font color="white">01538</font>	        {
<a name="L1539"><font color="white">01539</font>	          Pawn.SelectedItem = XIIIPawn(Pawn).PendingItem;
<a name="L1540"><font color="white">01540</font>	          XIIIItems(XIIIPawn(Pawn).PendingItem).BringUp();
<a name="L1541"><font color="white">01541</font>	          DebugLog(&quot;  &gt; cNextItem BringUp&quot;@XIIIPawn(Pawn).PendingItem@&quot;because selected = none&quot;);
<a name="L1542"><font color="white">01542</font>	        }
<a name="L1543"><font color="white">01543</font>	        return;
<a name="L1544"><font color="white">01544</font>	      }
<a name="L1545"><font color="white">01545</font>	      if ( (XIIIPawn(Pawn).PendingItem == None) &amp;&amp; (Pawn.SelectedItem == none) )
<a name="L1546"><font color="white">01546</font>	      {
<a name="L1547"><font color="white">01547</font>	        Warn(&quot;!@! PrevItem w/ Pending item &amp; Item none&quot;);
<a name="L1548"><font color="white">01548</font>	        NextWeapon();
<a name="L1549"><font color="white">01549</font>	        Pawn.ChangedWeapon();
<a name="L1550"><font color="white">01550</font>	      }
<a name="L1551"><font color="white">01551</font>	    }
<a name="L1552"><font color="white">01552</font>	    else
<a name="L1553"><font color="white">01553</font>	    {
<a name="L1554"><font color="white">01554</font>	      DebugLog(&quot;&gt;&gt;&gt; cNextItem call in &quot;$self$&quot;, going to item mode&quot;);
<a name="L1555"><font color="white">01555</font>	      XIIIBaseHud(MyHud).fDrawItemsTimer = 2.0+Level.TimeSeconds;
<a name="L1556"><font color="white">01556</font>	      bWaitForWeaponMode = false;
<a name="L1557"><font color="white">01557</font>	      SwitchWeaponMode();
<a name="L1558"><font color="white">01558</font>	    }
<a name="L1559"><font color="white">01559</font>	}
<a name="L1560"><font color="white">01560</font>	
<a name="L1561"><font color="white">01561</font>	//_____________________________________________________________________________
<a name="L1562"><font color="white">01562</font>	exec function WeaponZoom()
<a name="L1563"><font color="white">01563</font>	{
<a name="L1564"><font color="white">01564</font>	//    Log(self@&quot; WeaponZoom&quot;);
<a name="L1565"><font color="white">01565</font>	    if ( (Pawn != None) &amp;&amp; (Pawn.Weapon != None) )
<a name="L1566"><font color="white">01566</font>	    {
<a name="L1567"><font color="white">01567</font>	      if ( XIIIWeapon(Pawn.Weapon).bHaveAltFire )
<a name="L1568"><font color="white">01568</font>	      {
<a name="L1569"><font color="white">01569</font>	//        Log(self@&quot; calling Altfire&quot;);
<a name="L1570"><font color="white">01570</font>	        Pawn.Weapon.AltFire(0);
<a name="L1571"><font color="white">01571</font>	      }
<a name="L1572"><font color="white">01572</font>	      else
<a name="L1573"><font color="white">01573</font>	      {
<a name="L1574"><font color="white">01574</font>	//        Log(self@&quot; calling zoom&quot;);
<a name="L1575"><font color="white">01575</font>	        Pawn.Weapon.Zoom();
<a name="L1576"><font color="white">01576</font>	      }
<a name="L1577"><font color="white">01577</font>	    }
<a name="L1578"><font color="white">01578</font>	}
<a name="L1579"><font color="white">01579</font>	
<a name="L1580"><font color="white">01580</font>	//_____________________________________________________________________________
<a name="L1581"><font color="white">01581</font>	exec function Grab()
<a name="L1582"><font color="white">01582</font>	{
<a name="L1583"><font color="white">01583</font>	    local PowerUps PwrU;
<a name="L1584"><font color="white">01584</font>	
<a name="L1585"><font color="white">01585</font>	    DebugLog(&quot;GRAB&quot;);
<a name="L1586"><font color="white">01586</font>	    // If in cameraview, restore view instead of interaction
<a name="L1587"><font color="white">01587</font>	    if ( IsInState('CameraView') )
<a name="L1588"><font color="white">01588</font>	    {
<a name="L1589"><font color="white">01589</font>	      RestoreView();
<a name="L1590"><font color="white">01590</font>	      return;
<a name="L1591"><font color="white">01591</font>	    }
<a name="L1592"><font color="white">01592</font>	
<a name="L1593"><font color="white">01593</font>	    // Hook interactions
<a name="L1594"><font color="white">01594</font>	    if ( bHooked )
<a name="L1595"><font color="white">01595</font>	    {
<a name="L1596"><font color="white">01596</font>	      if ( !bWeaponMode  )
<a name="L1597"><font color="white">01597</font>	      {
<a name="L1598"><font color="white">01598</font>	        if ( (Hook(Pawn.SelectedItem) != none) )
<a name="L1599"><font color="white">01599</font>	        {
<a name="L1600"><font color="white">01600</font>	          Hook(Pawn.SelectedItem).Release();
<a name="L1601"><font color="white">01601</font>	          return;
<a name="L1602"><font color="white">01602</font>	        }
<a name="L1603"><font color="white">01603</font>	      }
<a name="L1604"><font color="white">01604</font>	      else if ( bWaitForWeaponMode )
<a name="L1605"><font color="white">01605</font>	      {
<a name="L1606"><font color="white">01606</font>	        cNextItem();
<a name="L1607"><font color="white">01607</font>	        return;
<a name="L1608"><font color="white">01608</font>	      }
<a name="L1609"><font color="white">01609</font>	    }
<a name="L1610"><font color="white">01610</font>	    if ( MyInteraction.bCanHook )
<a name="L1611"><font color="white">01611</font>	    {
<a name="L1612"><font color="white">01612</font>	      ActivateItem();
<a name="L1613"><font color="white">01613</font>	      return;
<a name="L1614"><font color="white">01614</font>	    }
<a name="L1615"><font color="white">01615</font>	
<a name="L1616"><font color="white">01616</font>	    if ( MyInteraction.bCanBreak )
<a name="L1617"><font color="white">01617</font>	    {
<a name="L1618"><font color="white">01618</font>	      MyInteraction.TargetActor.TakeDamage(50, Pawn, MyInteraction.TargetActor.Location, vect(0,0,0), class'DTFisted');
<a name="L1619"><font color="white">01619</font>	      MyInteraction.TargetActor = none;
<a name="L1620"><font color="white">01620</font>	      return;
<a name="L1621"><font color="white">01621</font>	    }
<a name="L1622"><font color="white">01622</font>	
<a name="L1623"><font color="white">01623</font>	    // Priority to interaction w/ door
<a name="L1624"><font color="white">01624</font>	    if ( MyInteraction.bCanDoor &amp;&amp; !MyInteraction.bCanTrigger )
<a name="L1625"><font color="white">01625</font>	    {
<a name="L1626"><font color="white">01626</font>	      if ( MyInteraction.bCanUnLockDoor )
<a name="L1627"><font color="white">01627</font>	      {
<a name="L1628"><font color="white">01628</font>	        PwrU = TryInteractWithDoor(MyInteraction.TargetActor);
<a name="L1629"><font color="white">01629</font>	        if ( ( bWeaponMode ) &amp;&amp; (PwrU != none) )
<a name="L1630"><font color="white">01630</font>	        {
<a name="L1631"><font color="white">01631</font>	          cNextItem();
<a name="L1632"><font color="white">01632</font>	          XIIIPawn(Pawn).PendingItem = PwrU;
<a name="L1633"><font color="white">01633</font>	          if ( (XIIIPawn(Pawn).PendingItem != None) &amp;&amp; (XIIIPawn(Pawn).PendingItem != Pawn.SelectedItem) )
<a name="L1634"><font color="white">01634</font>	            XIIIItems(Pawn.SelectedItem).PutDown();
<a name="L1635"><font color="white">01635</font>	          return;
<a name="L1636"><font color="white">01636</font>	        }
<a name="L1637"><font color="white">01637</font>	        else if ( (!bWeaponMode) &amp;&amp; (PwrU != none) )
<a name="L1638"><font color="white">01638</font>	        {
<a name="L1639"><font color="white">01639</font>	          if (PwrU == Pawn.SelectedItem)
<a name="L1640"><font color="white">01640</font>	            Pawn.SelectedItem.Activate();
<a name="L1641"><font color="white">01641</font>	          else
<a name="L1642"><font color="white">01642</font>	          {
<a name="L1643"><font color="white">01643</font>	            cNextItem();
<a name="L1644"><font color="white">01644</font>	            XIIIPawn(Pawn).PendingItem = PwrU;
<a name="L1645"><font color="white">01645</font>	            if ( (XIIIPawn(Pawn).PendingItem != None) &amp;&amp; (XIIIPawn(Pawn).PendingItem != Pawn.SelectedItem) )
<a name="L1646"><font color="white">01646</font>	              XIIIItems(Pawn.SelectedItem).PutDown();
<a name="L1647"><font color="white">01647</font>	          }
<a name="L1648"><font color="white">01648</font>	          return;
<a name="L1649"><font color="white">01649</font>	        }
<a name="L1650"><font color="white">01650</font>	        else if ( XIIIMover(MyInteraction.TargetActor) != none )
<a name="L1651"><font color="white">01651</font>	        {
<a name="L1652"><font color="white">01652</font>	          if ( XIIIBaseHud(MyHud).HudDlg == none ) // only send this message if not in a dialog already
<a name="L1653"><font color="white">01653</font>	            MyHud.LocalizedMessage( class'XIIIDialogMessage', 1, none, none, none, XIIIMover(MyInteraction.TargetActor).LockedMessage );
<a name="L1654"><font color="white">01654</font>	          return;
<a name="L1655"><font color="white">01655</font>	        }
<a name="L1656"><font color="white">01656</font>	      }
<a name="L1657"><font color="white">01657</font>	      else
<a name="L1658"><font color="white">01658</font>	      {
<a name="L1659"><font color="white">01659</font>	        if ( XIIIMover(MyInteraction.TargetActor) != none )
<a name="L1660"><font color="white">01660</font>	        {
<a name="L1661"><font color="white">01661</font>	          XIIIMover(MyInteraction.TargetActor).PlayerTrigger(self, Pawn);
<a name="L1662"><font color="white">01662</font>	          XIIIPawn(Pawn).PlayOpenDoor();
<a name="L1663"><font color="white">01663</font>	          return;
<a name="L1664"><font color="white">01664</font>	        }
<a name="L1665"><font color="white">01665</font>	        else if ( MagneticPassTrigger(MyInteraction.TargetActor) != none )
<a name="L1666"><font color="white">01666</font>	        {
<a name="L1667"><font color="white">01667</font>	          MagneticPassTrigger(MyInteraction.TargetActor).PlayerTrigger(self, Pawn);
<a name="L1668"><font color="white">01668</font>	          XIIIPawn(Pawn).PlayOpenDoor();
<a name="L1669"><font color="white">01669</font>	          return;
<a name="L1670"><font color="white">01670</font>	        }
<a name="L1671"><font color="white">01671</font>	      }
<a name="L1672"><font color="white">01672</font>	    }
<a name="L1673"><font color="white">01673</font>	
<a name="L1674"><font color="white">01674</font>	    // next priority to search a corpse
<a name="L1675"><font color="white">01675</font>	    if ( MyInteraction.bCanSearchCorpse )
<a name="L1676"><font color="white">01676</font>	    {
<a name="L1677"><font color="white">01677</font>	      SearchPawn(XIIIPawn(MyInteraction.TargetActor));
<a name="L1678"><font color="white">01678</font>	      return;
<a name="L1679"><font color="white">01679</font>	    }
<a name="L1680"><font color="white">01680</font>	
<a name="L1681"><font color="white">01681</font>	    if ( MyInteraction.bCanPickup )
<a name="L1682"><font color="white">01682</font>	    {
<a name="L1683"><font color="white">01683</font>	      DebugLog(&quot;GRAB PICKUP&quot;);
<a name="L1684"><font color="white">01684</font>	      if ( MyInteraction.TargetActor.IsA('XIIIDecoPickup')
<a name="L1685"><font color="white">01685</font>	//        &amp;&amp; ((DecoWeapon(Pawn.Weapon) != none) || (DecoWeapon(Pawn.PendingWeapon) != none)) )
<a name="L1686"><font color="white">01686</font>	        &amp;&amp; ((DecoWeapon(Pawn.PendingWeapon) != none) || (DecoWeapon(Pawn.Weapon) != none)) )
<a name="L1687"><font color="white">01687</font>	        return;
<a name="L1688"><font color="white">01688</font>	      bPickingUp = true;
<a name="L1689"><font color="white">01689</font>	      MyInteraction.TargetActor.Touch(Pawn);
<a name="L1690"><font color="white">01690</font>	      bPickingUp = false;
<a name="L1691"><font color="white">01691</font>	      MyInteraction.TargetActor = none;
<a name="L1692"><font color="white">01692</font>	      return;
<a name="L1693"><font color="white">01693</font>	    }
<a name="L1694"><font color="white">01694</font>	
<a name="L1695"><font color="white">01695</font>	    // then trigger actor
<a name="L1696"><font color="white">01696</font>	    if ( MyInteraction.bCanTrigger )
<a name="L1697"><font color="white">01697</font>	    {
<a name="L1698"><font color="white">01698</font>	      PwrU = TryInteractWithTrigger(MyInteraction.TargetActor);
<a name="L1699"><font color="white">01699</font>	//      Log(&quot;GRAB TRIGGER, Interaction item should be PwrU=&quot;$PwrU);
<a name="L1700"><font color="white">01700</font>	      if ( ( bWeaponMode ) &amp;&amp; (PwrU != none) )
<a name="L1701"><font color="white">01701</font>	      {
<a name="L1702"><font color="white">01702</font>	        cNextItem();
<a name="L1703"><font color="white">01703</font>	        XIIIPawn(Pawn).PendingItem = PwrU;
<a name="L1704"><font color="white">01704</font>	        if ( (XIIIPawn(Pawn).PendingItem != None) &amp;&amp; (XIIIPawn(Pawn).PendingItem != Pawn.SelectedItem) )
<a name="L1705"><font color="white">01705</font>	          XIIIItems(Pawn.SelectedItem).PutDown();
<a name="L1706"><font color="white">01706</font>	      }
<a name="L1707"><font color="white">01707</font>	      else if ( (!bWeaponMode) &amp;&amp; (PwrU != none) )
<a name="L1708"><font color="white">01708</font>	      {
<a name="L1709"><font color="white">01709</font>	        if (PwrU == Pawn.SelectedItem)
<a name="L1710"><font color="white">01710</font>	          Pawn.SelectedItem.Activate();
<a name="L1711"><font color="white">01711</font>	        else
<a name="L1712"><font color="white">01712</font>	        {
<a name="L1713"><font color="white">01713</font>	          cNextItem();
<a name="L1714"><font color="white">01714</font>	          XIIIPawn(Pawn).PendingItem = PwrU;
<a name="L1715"><font color="white">01715</font>	          if ( (XIIIPawn(Pawn).PendingItem != None) &amp;&amp; (XIIIPawn(Pawn).PendingItem != Pawn.SelectedItem) )
<a name="L1716"><font color="white">01716</font>	            XIIIItems(Pawn.SelectedItem).PutDown();
<a name="L1717"><font color="white">01717</font>	        }
<a name="L1718"><font color="white">01718</font>	      }
<a name="L1719"><font color="white">01719</font>	      else
<a name="L1720"><font color="white">01720</font>	        XIIITriggers(MyInteraction.TargetActor).PlayerTrigger(self, Pawn);
<a name="L1721"><font color="white">01721</font>	      return;
<a name="L1722"><font color="white">01722</font>	    }
<a name="L1723"><font color="white">01723</font>	
<a name="L1724"><font color="white">01724</font>	    if ( MyInteraction.bCantDoor )
<a name="L1725"><font color="white">01725</font>	    {
<a name="L1726"><font color="white">01726</font>	      XIIIMover(MyInteraction.TargetActor).PlayerTrigger(self, Pawn);
<a name="L1727"><font color="white">01727</font>	      return;
<a name="L1728"><font color="white">01728</font>	    }
<a name="L1729"><font color="white">01729</font>	
<a name="L1730"><font color="white">01730</font>	    // next priority to grab/ungrab pawn
<a name="L1731"><font color="white">01731</font>	    if ( XIIIPawn(Pawn).LHand != none )
<a name="L1732"><font color="white">01732</font>	    {
<a name="L1733"><font color="white">01733</font>	      if ( XIIIPawn(Pawn).LHand.pOnShoulder != none )
<a name="L1734"><font color="white">01734</font>	      {
<a name="L1735"><font color="white">01735</font>	        XIIIPawn(Pawn).LHand.UnGrabPawn();
<a name="L1736"><font color="white">01736</font>	        return;
<a name="L1737"><font color="white">01737</font>	      }
<a name="L1738"><font color="white">01738</font>	      else if (
<a name="L1739"><font color="white">01739</font>	          (MyInteraction.bCanGrabCorpse &amp;&amp; XIIIPawn(Pawn).CanGrabCorpse(XIIIPawn(MyInteraction.TargetActor)) )
<a name="L1740"><font color="white">01740</font>	       || (MyInteraction.bCanTakePrisonner &amp;&amp; XIIIPawn(Pawn).CanTakePrisonner(XIIIPawn(MyInteraction.TargetActor))) )
<a name="L1741"><font color="white">01741</font>	      {
<a name="L1742"><font color="white">01742</font>	        if ( bWeaponMode &amp;&amp; Pawn.Weapon.bHaveSlave )
<a name="L1743"><font color="white">01743</font>	          Pawn.Weapon.MySlave.PutDown();
<a name="L1744"><font color="white">01744</font>	        XIIIPawn(Pawn).LHand.GrabPawn(XIIIPawn(MyInteraction.TargetActor));
<a name="L1745"><font color="white">01745</font>	        XIIIPawn(Pawn).CheckMaluses();
<a name="L1746"><font color="white">01746</font>	        return;
<a name="L1747"><font color="white">01747</font>	      }
<a name="L1748"><font color="white">01748</font>	    }
<a name="L1749"><font color="white">01749</font>	
<a name="L1750"><font color="white">01750</font>	    if ( bWeaponMode &amp;&amp; (Pawn.Weapon.Default.ReloadCount &gt; Pawn.Weapon.ReloadCount) )
<a name="L1751"><font color="white">01751</font>	    {
<a name="L1752"><font color="white">01752</font>	      ReLoad();
<a name="L1753"><font color="white">01753</font>	      return;
<a name="L1754"><font color="white">01754</font>	    }
<a name="L1755"><font color="white">01755</font>	
<a name="L1756"><font color="white">01756</font>	    if ( !bWeaponMode &amp;&amp; Pawn.SelectedItem.IsA('Med') )
<a name="L1757"><font color="white">01757</font>	    {
<a name="L1758"><font color="white">01758</font>	      Pawn.SelectedItem.Activate();
<a name="L1759"><font color="white">01759</font>	      return;
<a name="L1760"><font color="white">01760</font>	    }
<a name="L1761"><font color="white">01761</font>	}
<a name="L1762"><font color="white">01762</font>	
<a name="L1763"><font color="white">01763</font>	//_____________________________________________________________________________
<a name="L1764"><font color="white">01764</font>	// The player wants to active selected item
<a name="L1765"><font color="white">01765</font>	exec function ActivateItem()
<a name="L1766"><font color="white">01766</font>	{
<a name="L1767"><font color="white">01767</font>	    DebugLog(&quot;Activate Item&quot;@Pawn.SelectedItem);
<a name="L1768"><font color="white">01768</font>	    if ( Level.Pauser!=None )
<a name="L1769"><font color="white">01769</font>	      return;
<a name="L1770"><font color="white">01770</font>	    if ( (Pawn != None) &amp;&amp; (Pawn.SelectedItem!=None) )
<a name="L1771"><font color="white">01771</font>	      Pawn.SelectedItem.Activate();
<a name="L1772"><font color="white">01772</font>	}
<a name="L1773"><font color="white">01773</font>	
<a name="L1774"><font color="white">01774</font>	//_____________________________________________________________________________
<a name="L1775"><font color="white">01775</font>	// ELR - Do we still pick the lock ? return true if no.
<a name="L1776"><font color="white">01776</font>	function bool CanUseLockPick()
<a name="L1777"><font color="white">01777</font>	{
<a name="L1778"><font color="white">01778</font>	    if ( XIIIPorte(MyInteraction.TargetActor) == none )
<a name="L1779"><font color="white">01779</font>	      return false;
<a name="L1780"><font color="white">01780</font>	    return ( XIIIPorte(MyInteraction.TargetActor).IsInState('Locked') );
<a name="L1781"><font color="white">01781</font>	}
<a name="L1782"><font color="white">01782</font>	
<a name="L1783"><font color="white">01783</font>	//_____________________________________________________________________________
<a name="L1784"><font color="white">01784</font>	// ELR - Do we still pick the lock ? return true if no.
<a name="L1785"><font color="white">01785</font>	function bool CheckPickLock()
<a name="L1786"><font color="white">01786</font>	{
<a name="L1787"><font color="white">01787</font>	    local actor HitActor;
<a name="L1788"><font color="white">01788</font>	
<a name="L1789"><font color="white">01789</font>	    HitActor = MyInteraction.TargetActor;
<a name="L1790"><font color="white">01790</font>	    if ( (HitActor == none) || (aDoor != HitActor) )
<a name="L1791"><font color="white">01791</font>	    {
<a name="L1792"><font color="white">01792</font>	      if ( aDoor != none )
<a name="L1793"><font color="white">01793</font>	        aDoor.UnTrigger( Pawn.SelectedItem, pawn );
<a name="L1794"><font color="white">01794</font>	      aDoor = none;
<a name="L1795"><font color="white">01795</font>	      return true;
<a name="L1796"><font color="white">01796</font>	    }
<a name="L1797"><font color="white">01797</font>	    if ( aDoor.IsInState('PlayerTriggerToggle') )
<a name="L1798"><font color="white">01798</font>	    { // Unlocked
<a name="L1799"><font color="white">01799</font>	      aDoor = none;
<a name="L1800"><font color="white">01800</font>	      MyHud.LocalizedMessage(class'XIIISoloMessage', 2);
<a name="L1801"><font color="white">01801</font>	    }
<a name="L1802"><font color="white">01802</font>	    return false;
<a name="L1803"><font color="white">01803</font>	}
<a name="L1804"><font color="white">01804</font>	
<a name="L1805"><font color="white">01805</font>	//_____________________________________________________________________________
<a name="L1806"><font color="white">01806</font>	// ELR - Do we still pick the lock ? return true if no.
<a name="L1807"><font color="white">01807</font>	function CancelPickLock()
<a name="L1808"><font color="white">01808</font>	{
<a name="L1809"><font color="white">01809</font>	    if ( aDoor != none )
<a name="L1810"><font color="white">01810</font>	      aDoor.UnTrigger( Pawn.SelectedItem, pawn );
<a name="L1811"><font color="white">01811</font>	    aDoor = none;
<a name="L1812"><font color="white">01812</font>	}
<a name="L1813"><font color="white">01813</font>	
<a name="L1814"><font color="white">01814</font>	//_____________________________________________________________________________
<a name="L1815"><font color="white">01815</font>	// ELR - Here we define if the controller allow the use of a lockpick
<a name="L1816"><font color="white">01816</font>	function bool TryPickLock()
<a name="L1817"><font color="white">01817</font>	{
<a name="L1818"><font color="white">01818</font>	    aDoor = XIIIPorte(MyInteraction.TargetActor);
<a name="L1819"><font color="white">01819</font>	//    DebugLog(&quot;TryPickLock &quot;$aDoor);
<a name="L1820"><font color="white">01820</font>	    if ( (aDoor != none) &amp;&amp; aDoor.IsInState('Locked') )
<a name="L1821"><font color="white">01821</font>	    {
<a name="L1822"><font color="white">01822</font>	      aDoor.Trigger( Pawn.SelectedItem, Pawn );
<a name="L1823"><font color="white">01823</font>	//      MyHud.LocalizedMessage(class'XIIISoloMessage', 1);
<a name="L1824"><font color="white">01824</font>	      return true;
<a name="L1825"><font color="white">01825</font>	    }
<a name="L1826"><font color="white">01826</font>	    else
<a name="L1827"><font color="white">01827</font>	      aDoor = none;
<a name="L1828"><font color="white">01828</font>	    return false;
<a name="L1829"><font color="white">01829</font>	}
<a name="L1830"><font color="white">01830</font>	
<a name="L1831"><font color="white">01831</font>	//_____________________________________________________________________________
<a name="L1832"><font color="white">01832</font>	// return the inventory object to be used to interact with A
<a name="L1833"><font color="white">01833</font>	// should be used w/ Grab Controller function to automatically get the item out.
<a name="L1834"><font color="white">01834</font>	function PowerUps TryInteractWithDoor(actor A)
<a name="L1835"><font color="white">01835</font>	{
<a name="L1836"><font color="white">01836</font>	  Local XIIIPorte XP;
<a name="L1837"><font color="white">01837</font>	  local PowerUps I;
<a name="L1838"><font color="white">01838</font>	
<a name="L1839"><font color="white">01839</font>	  XP = XIIIPorte(A);
<a name="L1840"><font color="white">01840</font>	  if ( (XP != none) &amp;&amp; XP.IsInState('Locked') )
<a name="L1841"><font color="white">01841</font>	  {
<a name="L1842"><font color="white">01842</font>	    I = XIIIPawn(Pawn).FindPowerUpItemName(XP.UnLockItemName);
<a name="L1843"><font color="white">01843</font>	    if ( I == none )
<a name="L1844"><font color="white">01844</font>	      I = XIIIPawn(Pawn).FindPowerUpItemName(XP.UnLockItemCode);
<a name="L1845"><font color="white">01845</font>	//    Log(&quot;&gt;&gt; &quot;$I$&quot; should be used to interact with &quot;$A);
<a name="L1846"><font color="white">01846</font>	    return I;
<a name="L1847"><font color="white">01847</font>	  }
<a name="L1848"><font color="white">01848</font>	
<a name="L1849"><font color="white">01849</font>	  return none;
<a name="L1850"><font color="white">01850</font>	}
<a name="L1851"><font color="white">01851</font>	
<a name="L1852"><font color="white">01852</font>	//_____________________________________________________________________________
<a name="L1853"><font color="white">01853</font>	// return the inventory object to be used to interact with A
<a name="L1854"><font color="white">01854</font>	// should be used w/ Grab Controller function to automatically get the item out.
<a name="L1855"><font color="white">01855</font>	function PowerUps TryInteractWithTrigger(actor A)
<a name="L1856"><font color="white">01856</font>	{
<a name="L1857"><font color="white">01857</font>	  Local XIIITriggers XT;
<a name="L1858"><font color="white">01858</font>	  local PowerUps I;
<a name="L1859"><font color="white">01859</font>	
<a name="L1860"><font color="white">01860</font>	  XT = XIIITriggers(A);
<a name="L1861"><font color="white">01861</font>	  if ( XT != none )
<a name="L1862"><font color="white">01862</font>	  {
<a name="L1863"><font color="white">01863</font>	//    Log(&quot;TryInteractWithTrigger XT=&quot;$XT$&quot; TAG=&quot;$XT.Tag);
<a name="L1864"><font color="white">01864</font>	    I = XIIIPawn(Pawn).FindPowerUpItemNameForTrigger(XT.Tag);
<a name="L1865"><font color="white">01865</font>	//    Log(&quot;&gt;&gt; &quot;$I$&quot; should be used to interact with &quot;$A);
<a name="L1866"><font color="white">01866</font>	    return I;
<a name="L1867"><font color="white">01867</font>	  }
<a name="L1868"><font color="white">01868</font>	
<a name="L1869"><font color="white">01869</font>	  return none;
<a name="L1870"><font color="white">01870</font>	}
<a name="L1871"><font color="white">01871</font>	
<a name="L1872"><font color="white">01872</font>	//_____________________________________________________________________________
<a name="L1873"><font color="white">01873</font>	// ::TODO:: put in native (may not optimize the trace but everytinh else &amp; called each frame so...)
<a name="L1874"><font color="white">01874</font>	function actor ReturnTrace(out vector HitLoc, out vector HitNorm, vector End, vector Start, bool bActor, optional vector Extent, optional out Material HitMat, optional int TraceType)
<a name="L1875"><font color="white">01875</font>	{
<a name="L1876"><font color="white">01876</font>	    local actor PickMe, PotentialDoor;
<a name="L1877"><font color="white">01877</font>	    local vector HitLoc2, HitNorm2;
<a name="L1878"><font color="white">01878</font>	
<a name="L1879"><font color="white">01879</font>	    foreach TraceActors(class'actor', Pickme, HitLoc, HitNorm, End, Start, vect(0,0,0), TraceType)
<a name="L1880"><font color="white">01880</font>	    {
<a name="L1881"><font color="white">01881</font>	      if ( Pickme == Level ) // stop the iterator at first Level hit
<a name="L1882"><font color="white">01882</font>	        return none;
<a name="L1883"><font color="white">01883</font>	      if ( (Pickme != none) &amp;&amp; Pickme.bInteractive &amp;&amp; (PickMe != Pawn) )
<a name="L1884"><font color="white">01884</font>	      {
<a name="L1885"><font color="white">01885</font>	        if ( XIIIPorte(Pickme) != none )
<a name="L1886"><font color="white">01886</font>	        {
<a name="L1887"><font color="white">01887</font>	          PotentialDoor = Trace(HitLoc2, HitNorm2, HitLoc - HitNorm, Start, false, vect(0,0,0), HitMat, TraceType);
<a name="L1888"><font color="white">01888</font>	          if ( PotentialDoor != none )
<a name="L1889"><font color="white">01889</font>	          {
<a name="L1890"><font color="white">01890</font>	            HitLoc = hitLoc2;
<a name="L1891"><font color="white">01891</font>	            HitNorm = hitNorm2;
<a name="L1892"><font color="white">01892</font>	            Pickme = PotentialDoor;
<a name="L1893"><font color="white">01893</font>	            return PickMe;
<a name="L1894"><font color="white">01894</font>	          }
<a name="L1895"><font color="white">01895</font>	          else if ( FastTrace(HitLoc, Start) )
<a name="L1896"><font color="white">01896</font>	            return PickMe;
<a name="L1897"><font color="white">01897</font>	        }
<a name="L1898"><font color="white">01898</font>	        else
<a name="L1899"><font color="white">01899</font>	        {
<a name="L1900"><font color="white">01900</font>	          if ( FastTrace(HitLoc, Start) )
<a name="L1901"><font color="white">01901</font>	          {
<a name="L1902"><font color="white">01902</font>	            if ( Pickup(PickMe) != none )
<a name="L1903"><font color="white">01903</font>	              return PickMe;
<a name="L1904"><font color="white">01904</font>	            else
<a name="L1905"><font color="white">01905</font>	              return PickMe;
<a name="L1906"><font color="white">01906</font>	          }
<a name="L1907"><font color="white">01907</font>	        }
<a name="L1908"><font color="white">01908</font>	      }
<a name="L1909"><font color="white">01909</font>	    }
<a name="L1910"><font color="white">01910</font>	    return none;
<a name="L1911"><font color="white">01911</font>	}
<a name="L1912"><font color="white">01912</font>	
<a name="L1913"><font color="white">01913</font>	//_____________________________________________________________________________
<a name="L1914"><font color="white">01914</font>	function bool AllowHooking()
<a name="L1915"><font color="white">01915</font>	{
<a name="L1916"><font color="white">01916</font>	    return ( !bWeaponMode &amp;&amp; (Hook(Pawn.SelectedItem)!=none) );
<a name="L1917"><font color="white">01917</font>	}
<a name="L1918"><font color="white">01918</font>	
<a name="L1919"><font color="white">01919</font>	//_____________________________________________________________________________
<a name="L1920"><font color="white">01920</font>	// ELR - check if we can send the controller into Tyrol state
<a name="L1921"><font color="white">01921</font>	function bool TryTyroling()
<a name="L1922"><font color="white">01922</font>	{
<a name="L1923"><font color="white">01923</font>	    return true;
<a name="L1924"><font color="white">01924</font>	}
<a name="L1925"><font color="white">01925</font>	
<a name="L1926"><font color="white">01926</font>	//_____________________________________________________________________________
<a name="L1927"><font color="white">01927</font>	// Set up the tyroling params, called by TyrolTrigger
<a name="L1928"><font color="white">01928</font>	function GoTyroling(XIIITyrolNavPoint StartPoint, XIIITyrolNavPoint EndPoint, float TyrolSpeed)
<a name="L1929"><font color="white">01929</font>	{
<a name="L1930"><font color="white">01930</font>	//    Log(&quot;SetUpTyrol w/ StartPoint=&quot;$StartPoint$&quot; EndPoint=&quot;$EndPoint$&quot; TyrolSpeed=&quot;$TyrolSpeed);
<a name="L1931"><font color="white">01931</font>	    fTyrolSpeed = TyrolSpeed;
<a name="L1932"><font color="white">01932</font>	    vTyrolStart = StartPoint.Location - vect(0,0,1)*Pawn.CollisionHeight;
<a name="L1933"><font color="white">01933</font>	    vTyrolEnd = EndPoint.Location - vect(0,0,1)*Pawn.CollisionHeight;
<a name="L1934"><font color="white">01934</font>	    vTyrolDir = normal(vTyrolEnd - vTyrolStart);
<a name="L1935"><font color="white">01935</font>	    Pawn.SetPhysics(PHYS_None);
<a name="L1936"><font color="white">01936</font>	    Pawn.SetLocation(vTyrolStart);
<a name="L1937"><font color="white">01937</font>	    Pawn.SetRotation(rotator(vTyrolDir));
<a name="L1938"><font color="white">01938</font>	    Pawn.Velocity = vTyrolDir * 5.0;
<a name="L1939"><font color="white">01939</font>	    Pawn.Acceleration = vect(0,0,0);
<a name="L1940"><font color="white">01940</font>	    SetLocation(vTyrolStart);
<a name="L1941"><font color="white">01941</font>	    SetRotation(rotator(vTyrolDir));
<a name="L1942"><font color="white">01942</font>	    gotoState('Tyroling');
<a name="L1943"><font color="white">01943</font>	}
<a name="L1944"><font color="white">01944</font>	
<a name="L1945"><font color="white">01945</font>	//_____________________________________________________________________________
<a name="L1946"><font color="white">01946</font>	function SearchPawn(XIIIPawn P)
<a name="L1947"><font color="white">01947</font>	{
<a name="L1948"><font color="white">01948</font>	    local inventory I, OwnI;
<a name="L1949"><font color="white">01949</font>	    local class&lt;ammo&gt; A;
<a name="L1950"><font color="white">01950</font>	    local bool bDBSearch;
<a name="L1951"><font color="white">01951</font>	    local ammunition IAmmo, IAltAmmo;
<a name="L1952"><font color="white">01952</font>	
<a name="L1953"><font color="white">01953</font>	    bDBSearch = false;
<a name="L1954"><font color="white">01954</font>	
<a name="L1955"><font color="white">01955</font>	    if ( !P.bIsDead )
<a name="L1956"><font color="white">01956</font>	      return;
<a name="L1957"><font color="white">01957</font>	    if ( bDBSearch ) Log(&quot; investigating &quot;$P$&quot; corpse&quot;);
<a name="L1958"><font color="white">01958</font>	
<a name="L1959"><font color="white">01959</font>	    XIIIPawn(Pawn).PlaySearchCorpse();
<a name="L1960"><font color="white">01960</font>	
<a name="L1961"><font color="white">01961</font>	//    XIIICheatManager(CheatManager).LogInventory();
<a name="L1962"><font color="white">01962</font>	    if (P.Inventory == none)
<a name="L1963"><font color="white">01963</font>	    {
<a name="L1964"><font color="white">01964</font>	      ReceiveLocalizedMessage( class'XIIISoloMessage', 4, None, None);
<a name="L1965"><font color="white">01965</font>	      return;
<a name="L1966"><font color="white">01966</font>	    }
<a name="L1967"><font color="white">01967</font>	
<a name="L1968"><font color="white">01968</font>	    if ( P.Shadow != none )
<a name="L1969"><font color="white">01969</font>	    {
<a name="L1970"><font color="white">01970</font>	      P.Shadow.bShadowIsStatic = false;
<a name="L1971"><font color="white">01971</font>	      P.SetTimer2(0.2, false);
<a name="L1972"><font color="white">01972</font>	    }
<a name="L1973"><font color="white">01973</font>	
<a name="L1974"><font color="white">01974</font>	    if ( bDBSearch ) Log(&quot;&gt;&gt;&gt; SearchPawn&quot;);
<a name="L1975"><font color="white">01975</font>	    I = P.Inventory;
<a name="L1976"><font color="white">01976</font>	    while ( I != none )
<a name="L1977"><font color="white">01977</font>	    {
<a name="L1978"><font color="white">01978</font>	      if ( bDBSearch )
<a name="L1979"><font color="white">01979</font>	      {
<a name="L1980"><font color="white">01980</font>	        if ( Weapon(I) != none )
<a name="L1981"><font color="white">01981</font>	          Log(&quot; &gt;&gt; Processing Weapon &quot;$I$&quot; ReloadCount=&quot;$Weapon(I).ReloadCount@&quot;AmmoType=&quot;$Weapon(i).AmmoType@&quot;AltAmmoType=&quot;$Weapon(i).AltAmmoType);
<a name="L1982"><font color="white">01982</font>	        else
<a name="L1983"><font color="white">01983</font>	          Log(&quot; &gt;&gt; Processing &quot;$I);
<a name="L1984"><font color="white">01984</font>	      }
<a name="L1985"><font color="white">01985</font>	      I.Transfer(Pawn); // all transfer handling is in subclasses.
<a name="L1986"><font color="white">01986</font>	      I = P.Inventory;
<a name="L1987"><font color="white">01987</font>	    }
<a name="L1988"><font color="white">01988</font>	}
<a name="L1989"><font color="white">01989</font>	
<a name="L1990"><font color="white">01990</font>	//_____________________________________________________________________________
<a name="L1991"><font color="white">01991</font>	// ELR Added to make b180Left and b180Right working.
<a name="L1992"><font color="white">01992</font>	// (Actually used as b90Left and b90Right :)
<a name="L1993"><font color="white">01993</font>	function TurnAround()
<a name="L1994"><font color="white">01994</font>	{
<a name="L1995"><font color="white">01995</font>	    if ( !bSetTurnRot )
<a name="L1996"><font color="white">01996</font>	    {
<a name="L1997"><font color="white">01997</font>	      TurnRot180 = Rotation;
<a name="L1998"><font color="white">01998</font>	      // For 90 turn
<a name="L1999"><font color="white">01999</font>	      TurnRot180.Yaw += 16384 * (b90Right - b90Left);
<a name="L2000"><font color="white">02000</font>	      // For 180 turn
<a name="L2001"><font color="white">02001</font>	      TurnRot180.Yaw += 32768 * b180turn;
<a name="L2002"><font color="white">02002</font>	      bSetTurnRot = true;
<a name="L2003"><font color="white">02003</font>	    }
<a name="L2004"><font color="white">02004</font>	    DesiredRotation = TurnRot180;
<a name="L2005"><font color="white">02005</font>	    bTurnWanted = ( DesiredRotation.Yaw != Rotation.Yaw );
<a name="L2006"><font color="white">02006</font>	}
<a name="L2007"><font color="white">02007</font>	
<a name="L2008"><font color="white">02008</font>	//_____________________________________________________________________________
<a name="L2009"><font color="white">02009</font>	// Simulated weapon feedback
<a name="L2010"><font color="white">02010</font>	// Not called by H2HAmmo
<a name="L2011"><font color="white">02011</font>	function ClientViewFeedBackSetup(class&lt;XIIIWeapon&gt; WeapClass, optional bool bAmplify)
<a name="L2012"><font color="white">02012</font>	{
<a name="L2013"><font color="white">02013</font>	    if ( bAmplify ) // used for dual weapons amplified feedback
<a name="L2014"><font color="white">02014</font>	      vWeaponFeedBack += vect(1.5,0,0)*WeapClass.default.ViewFeedBack.x*(fRand()-0.5) + vect(0,1.5,0)*WeapClass.default.ViewFeedBack.y*(abs(fRand()*0.7)+0.3);
<a name="L2015"><font color="white">02015</font>	    else
<a name="L2016"><font color="white">02016</font>	      vWeaponFeedBack = vect(0.5,0,0)*WeapClass.default.ViewFeedBack.x*(fRand()-0.5) + vect(0,0.5,0)*WeapClass.default.ViewFeedBack.y*(abs(fRand()*0.7)+0.3);
<a name="L2017"><font color="white">02017</font>	    if ( (Level.GetPlateforme() == 1) || (Level.GetPlateforme() == 3) ) // PS2 + GC, reduce feedback
<a name="L2018"><font color="white">02018</font>	      vWeaponFeedBack *= 0.4;
<a name="L2019"><font color="white">02019</font>	}
<a name="L2020"><font color="white">02020</font>	
<a name="L2021"><font color="white">02021</font>	//_____________________________________________________________________________
<a name="L2022"><font color="white">02022</font>	// Simulated weapon feedback
<a name="L2023"><font color="white">02023</font>	// Not called by H2HAmmo
<a name="L2024"><font color="white">02024</font>	function ClientViewAltFeedBackSetup(class&lt;XIIIWeapon&gt; WeapClass, optional bool bAmplify)
<a name="L2025"><font color="white">02025</font>	{
<a name="L2026"><font color="white">02026</font>	    if ( bAmplify ) // used for dual weapons amplified feedback
<a name="L2027"><font color="white">02027</font>	      vWeaponFeedBack = vect(1.5,0,0)*WeapClass.default.AltViewFeedBack.x*(fRand()-0.5) + vect(0,1.5,0)*WeapClass.default.AltViewFeedBack.y*(abs(fRand()*0.7)+0.3);
<a name="L2028"><font color="white">02028</font>	    else
<a name="L2029"><font color="white">02029</font>	      vWeaponFeedBack = vect(0.5,0,0)*WeapClass.default.AltViewFeedBack.x*(fRand()-0.5) + vect(0,0.5,0)*WeapClass.default.AltViewFeedBack.y*(abs(fRand()*0.7)+0.3);
<a name="L2030"><font color="white">02030</font>	    if ( (Level.GetPlateforme() == 1) || (Level.GetPlateforme() == 3) ) // PS2 + GC, reduce feedback
<a name="L2031"><font color="white">02031</font>	      vWeaponFeedBack *= 0.4;
<a name="L2032"><font color="white">02032</font>	}
<a name="L2033"><font color="white">02033</font>	
<a name="L2034"><font color="white">02034</font>	//_____________________________________________________________________________
<a name="L2035"><font color="white">02035</font>	function UpdateRotation(float DeltaTime, float maxPitch)
<a name="L2036"><font color="white">02036</font>	{
<a name="L2037"><font color="white">02037</font>	    local rotator newRotation, ViewRotation;
<a name="L2038"><font color="white">02038</font>	    local int WeaponFeedBackPitch;
<a name="L2039"><font color="white">02039</font>	    local vector LocalAim;
<a name="L2040"><font color="white">02040</font>	    local int i;
<a name="L2041"><font color="white">02041</font>	    local float fSpeedLimit, fDistFact;
<a name="L2042"><font color="white">02042</font>	
<a name="L2043"><font color="white">02043</font>	    if ( bInterpolating || ((Pawn != None) &amp;&amp; Pawn.bInterpolating) )
<a name="L2044"><font color="white">02044</font>	    { // only treat shakes when interpolating
<a name="L2045"><font color="white">02045</font>	      ViewShake(deltaTime);
<a name="L2046"><font color="white">02046</font>	      return;
<a name="L2047"><font color="white">02047</font>	    }
<a name="L2048"><font color="white">02048</font>	
<a name="L2049"><font color="white">02049</font>	    ViewRotation = Rotation;
<a name="L2050"><font color="white">02050</font>	    DesiredRotation = ViewRotation; //save old rotation
<a name="L2051"><font color="white">02051</font>	
<a name="L2052"><font color="white">02052</font>	    if ( (b90Left != 0) || (b90Right != 0) || (b180Turn != 0) )
<a name="L2053"><font color="white">02053</font>	      TurnAround();
<a name="L2054"><font color="white">02054</font>	    else
<a name="L2055"><font color="white">02055</font>	      bSetTurnRot = false;
<a name="L2056"><font color="white">02056</font>	
<a name="L2057"><font color="white">02057</font>	    if ( bTurnToNearest != 0 )
<a name="L2058"><font color="white">02058</font>	      TurnTowardNearestEnemy();
<a name="L2059"><font color="white">02059</font>	    else if ( Pawn != none )
<a name="L2060"><font color="white">02060</font>	    {
<a name="L2061"><font color="white">02061</font>	      TurnTarget = None;
<a name="L2062"><font color="white">02062</font>	      if ( bTurnWanted )
<a name="L2063"><font color="white">02063</font>	      {
<a name="L2064"><font color="white">02064</font>	        ViewRotation.Yaw = (ViewRotation.Yaw * (1/Deltatime)/10 + DesiredRotation.Yaw)/((1/Deltatime)/10+1);
<a name="L2065"><font color="white">02065</font>	      }
<a name="L2066"><font color="white">02066</font>	      bTurnWanted = false;
<a name="L2067"><font color="white">02067</font>	
<a name="L2068"><font color="white">02068</font>	      if ( !bFixedCrosshair )
<a name="L2069"><font color="white">02069</font>	      {
<a name="L2070"><font color="white">02070</font>	        // ELR Try reducing turn speed when locking someone.
<a name="L2071"><font color="white">02071</font>	        if ( bLocked )
<a name="L2072"><font color="white">02072</font>	        {
<a name="L2073"><font color="white">02073</font>	//          aTurn *= 0.5;
<a name="L2074"><font color="white">02074</font>	//          aLookUp *= 0.5;
<a name="L2075"><font color="white">02075</font>	          fSpeedLimit = fClamp(Abs(LocalAim.Y) / 0.7, 0.5, 1.0);
<a name="L2076"><font color="white">02076</font>	          PlayerInput.ViewTurnAcc = fClamp(PlayerInput.ViewTurnAcc, -fSpeedLimit, fSpeedLimit);
<a name="L2077"><font color="white">02077</font>	          PlayerInput.ViewUpAcc = fClamp(PlayerInput.ViewUpAcc, -0.5, 0.5); // don't limit as much as pawns have more height than width.
<a name="L2078"><font color="white">02078</font>	          PlayerInput.ViewTurnBoost = 0.0;
<a name="L2079"><font color="white">02079</font>	          if ( bRotationAssist &amp;&amp; (aTurn == 0) &amp;&amp; ((aStrafe != 0) || (aForward != 0)) &amp;&amp; (Level.Game != none) &amp;&amp; (Level.Game.Difficulty &lt;= 1) )
<a name="L2080"><font color="white">02080</font>	  //        if ( bRotationAssist &amp;&amp; ((aStrafe != 0) || (aForward != 0)) &amp;&amp; (Level.Game != none) &amp;&amp; (Level.Game.Difficulty &lt;= 1) )
<a name="L2081"><font color="white">02081</font>	  //        if ( bRotationAssist )// &amp;&amp; (aTurn == 0) ) // test, to help guys w/ no arms playing XIII
<a name="L2082"><font color="white">02082</font>	          { // Assist rotation toward besttarget
<a name="L2083"><font color="white">02083</font>	            LocalAim = OldAdjustAim &lt;&lt; Rotation; // Adjustaim vector in local coords
<a name="L2084"><font color="white">02084</font>	            aTurn += LocalAim.y * 1800;
<a name="L2085"><font color="white">02085</font>	          }
<a name="L2086"><font color="white">02086</font>	        }
<a name="L2087"><font color="white">02087</font>	      }
<a name="L2088"><font color="white">02088</font>	      else
<a name="L2089"><font color="white">02089</font>	      {
<a name="L2090"><font color="white">02090</font>	        //============== CYD+b
<a name="L2091"><font color="white">02091</font>	        // mode bFixedCrosshair : true
<a name="L2092"><font color="white">02092</font>	
<a name="L2093"><font color="white">02093</font>	        if ( bLocked )
<a name="L2094"><font color="white">02094</font>	        {
<a name="L2095"><font color="white">02095</font>	          // AdjustAim vector in local coords
<a name="L2096"><font color="white">02096</font>	          LocalAim = OldAdjustAim &lt;&lt; Rotation;
<a name="L2097"><font color="white">02097</font>	          fDistFact = fClamp(vSize(BestTarget.Location - Pawn.Location)/3000.f, 0.1, 1.0);
<a name="L2098"><font color="white">02098</font>	
<a name="L2099"><font color="white">02099</font>	//          Log(&quot;turning toward target=&quot;$(aTurn*LocalAim.Y &gt;= 0));
<a name="L2100"><font color="white">02100</font>	          // TURN SPEED
<a name="L2101"><font color="white">02101</font>	          fSpeedLimit = fClamp(Abs(LocalAim.Y) / 0.7 / fDistFact, 0.40, 1.0);
<a name="L2102"><font color="white">02102</font>	          // Try to avoid 'bumper' effect
<a name="L2103"><font color="white">02103</font>	          PlayerInput.ViewTurnAcc = fClamp(PlayerInput.ViewTurnAcc, -fSpeedLimit, fSpeedLimit);
<a name="L2104"><font color="white">02104</font>	          PlayerInput.ViewUpAcc = fClamp(PlayerInput.ViewUpAcc, -0.5, 0.5); // don't limit as much as pawns have more height than width.
<a name="L2105"><font color="white">02105</font>	          PlayerInput.ViewTurnBoost = 0.0;
<a name="L2106"><font color="white">02106</font>	
<a name="L2107"><font color="white">02107</font>	          // HELP ON TARGETING
<a name="L2108"><font color="white">02108</font>	          if ( bRotationAssist
<a name="L2109"><font color="white">02109</font>	            &amp;&amp; (aTurn == 0) &amp;&amp; (aLookUp == 0)
<a name="L2110"><font color="white">02110</font>	            &amp;&amp; ((aStrafe != 0) || (aForward != 0))
<a name="L2111"><font color="white">02111</font>	            &amp;&amp; ( (Level.Game == none) // either on Clients
<a name="L2112"><font color="white">02112</font>	               || !Level.bLonePlayer  // or not in solo
<a name="L2113"><font color="white">02113</font>	               || (Level.Game.Difficulty &lt;= 1)) )  // or in solo w/ low difficulty
<a name="L2114"><font color="white">02114</font>	          {
<a name="L2115"><font color="white">02115</font>	            if (aStrafe != 0)
<a name="L2116"><font color="white">02116</font>	            {
<a name="L2117"><font color="white">02117</font>	              aTurn += localAim.y * 200.0;
<a name="L2118"><font color="white">02118</font>	              if( !Pawn.bIsCrouched )
<a name="L2119"><font color="white">02119</font>	              {
<a name="L2120"><font color="white">02120</font>	                aTurn -= aStrafe * 0.048f * (1.0-fDistFact)*(1.0-fDistFact);
<a name="L2121"><font color="white">02121</font>	              }
<a name="L2122"><font color="white">02122</font>	            }
<a name="L2123"><font color="white">02123</font>	            if (aForward != 0) // Help more if player moving forward/backward
<a name="L2124"><font color="white">02124</font>	              aTurn += 315.f * LocalAim.y;
<a name="L2125"><font color="white">02125</font>	
<a name="L2126"><font color="white">02126</font>	            // limit feedback &amp; try to avoid speed up when exiting 'cushion'
<a name="L2127"><font color="white">02127</font>	            vWeaponFeedBack.y       *= 0.90f;
<a name="L2128"><font color="white">02128</font>	            vWeaponFeedBackReturn.y *= 0.90f;
<a name="L2129"><font color="white">02129</font>	          }
<a name="L2130"><font color="white">02130</font>	        }
<a name="L2131"><font color="white">02131</font>	        //============== CYD+e
<a name="L2132"><font color="white">02132</font>	      }
<a name="L2133"><font color="white">02133</font>	
<a name="L2134"><font color="white">02134</font>	      // if turning around, SpeedUp taptaps fade
<a name="L2135"><font color="white">02135</font>	      if ( (aTurn != 0) || (aLookUp != 0) )
<a name="L2136"><font color="white">02136</font>	        for (i=0; i&lt;5; i++ )
<a name="L2137"><font color="white">02137</font>	          if ( MyHud.fDrawSixSenseTimer[i] &gt; 0 )
<a name="L2138"><font color="white">02138</font>	            MyHud.fDrawSixSenseTimer[i] -= XIIIBaseHud(MyHud).dT*6.0;
<a name="L2139"><font color="white">02139</font>	
<a name="L2140"><font color="white">02140</font>	      if ( bCenterView )
<a name="L2141"><font color="white">02141</font>	      {
<a name="L2142"><font color="white">02142</font>	//        Log(&quot;Cancelling aLook because centerview command&quot;);
<a name="L2143"><font color="white">02143</font>	        aLookUp = 0;
<a name="L2144"><font color="white">02144</font>	      }
<a name="L2145"><font color="white">02145</font>	      // ELR WeaponFeedBack
<a name="L2146"><font color="white">02146</font>	      if ( Pawn.IsLocallyControlled() &amp;&amp; ((abs(vWeaponFeedBack.y) &gt; 0.1) || (abs(vWeaponFeedBack.x) &gt; 0.1))
<a name="L2147"><font color="white">02147</font>	        )
<a name="L2148"><font color="white">02148</font>	      { // Move view because of weapon feedback
<a name="L2149"><font color="white">02149</font>	        vWeaponFeedBack.x *= 1.0 - fMin(1.0, 0.25 * 64.0 * DeltaTime); // not really proportional to framerate but
<a name="L2150"><font color="white">02150</font>	        vWeaponFeedBack.y *= 1.0 - fMin(1.0, 0.25 * 64.0 * DeltaTime); // sfx is more attenuated if low framerate so it's ok
<a name="L2151"><font color="white">02151</font>	
<a name="L2152"><font color="white">02152</font>	        WeaponFeedBackPitch = (100.0 * vWeaponFeedBack.y) * 64 * DeltaTime + ViewRotation.Pitch;
<a name="L2153"><font color="white">02153</font>	        WeaponFeedBackPitch = WeaponFeedBackPitch &amp; 65535;
<a name="L2154"><font color="white">02154</font>	        // Memorize offset
<a name="L2155"><font color="white">02155</font>	        If ((WeaponFeedBackPitch &lt; 15500) || (WeaponFeedBackPitch &gt; 50000))
<a name="L2156"><font color="white">02156</font>	        { // only memorize this displacement if it will occur (not limited by view)
<a name="L2157"><font color="white">02157</font>	          vWeaponFeedBackReturn.y += 100.0 * vWeaponFeedBack.y * 64 * DeltaTime;
<a name="L2158"><font color="white">02158</font>	        }
<a name="L2159"><font color="white">02159</font>	        // these one are memorized
<a name="L2160"><font color="white">02160</font>	        vWeaponFeedBackReturn.x += 100.0 * vWeaponFeedBack.x * 64 * DeltaTime;
<a name="L2161"><font color="white">02161</font>	        vWeaponFeedBackReturn.y += aLookUp;
<a name="L2162"><font color="white">02162</font>	        // Update view
<a name="L2163"><font color="white">02163</font>	        aTurn += 100.0 * vWeaponFeedBack.x * 64 * DeltaTime;
<a name="L2164"><font color="white">02164</font>	        aLookUp += 100.0 * vWeaponFeedBack.y * 64 * DeltaTime;
<a name="L2165"><font color="white">02165</font>	        // reduce effect
<a name="L2166"><font color="white">02166</font>	      }
<a name="L2167"><font color="white">02167</font>	      else
<a name="L2168"><font color="white">02168</font>	      { // Return smoothly to pos.
<a name="L2169"><font color="white">02169</font>	//        XIIIPawn(Pawn).bJumpFeedBack=false;
<a name="L2170"><font color="white">02170</font>	        aTurn -= vWeaponFeedBackReturn.x * 0.20 * 64 * DeltaTime;
<a name="L2171"><font color="white">02171</font>	        aLookUp -= vWeaponFeedBackReturn.y * 0.20 * 64 * DeltaTime;
<a name="L2172"><font color="white">02172</font>	        vWeaponFeedBackReturn *= (1.0 - 0.20 * 64 * DeltaTime);
<a name="L2173"><font color="white">02173</font>	        vWeaponFeedBack *= (1.0 - 0.20 * 64 * DeltaTime);
<a name="L2174"><font color="white">02174</font>	      }
<a name="L2175"><font color="white">02175</font>	      // End Weapon FeedBack
<a name="L2176"><font color="white">02176</font>	
<a name="L2177"><font color="white">02177</font>	/*
<a name="L2178"><font color="white">02178</font>	var config bool bCheckTurnSpeed;// check turning speed
<a name="L2179"><font color="white">02179</font>	var float fTurnSpeed[5];        // store turning values (90/180/270/360/720)
<a name="L2180"><font color="white">02180</font>	var float fTurnDeltaTime;       // time cumul
<a name="L2181"><font color="white">02181</font>	*/
<a name="L2182"><font color="white">02182</font>	/*
<a name="L2183"><font color="white">02183</font>	      // Check turning speed
<a name="L2184"><font color="white">02184</font>	      if ( bCheckTurnSpeed )
<a name="L2185"><font color="white">02185</font>	      {
<a name="L2186"><font color="white">02186</font>	        if ( aTurn != 0 )
<a name="L2187"><font color="white">02187</font>	        {
<a name="L2188"><font color="white">02188</font>	          fTurnInc += abs(43.0 * DeltaTime * aTurn);
<a name="L2189"><font color="white">02189</font>	
<a name="L2190"><font color="white">02190</font>	          fTurnDeltaTime += DeltaTime;
<a name="L2191"><font color="white">02191</font>	          if ( fTurnSpeed[0] == 0.0 )
<a name="L2192"><font color="white">02192</font>	          { // first check
<a name="L2193"><font color="white">02193</font>	            if ( fTurnInc &gt; 65536/4.0 )
<a name="L2194"><font color="white">02194</font>	            {
<a name="L2195"><font color="white">02195</font>	              fTurnSpeed[0] = fTurnDeltaTime;
<a name="L2196"><font color="white">02196</font>	              fTurnSpeed[1] = 0.0;
<a name="L2197"><font color="white">02197</font>	              MyHud.Message(none, &quot;90 turn &quot;$fTurnSpeed[0], 'CHEAT');
<a name="L2198"><font color="white">02198</font>	            }
<a name="L2199"><font color="white">02199</font>	          }
<a name="L2200"><font color="white">02200</font>	          else if ( fTurnSpeed[1] == 0.0 )
<a name="L2201"><font color="white">02201</font>	          { // first check
<a name="L2202"><font color="white">02202</font>	            if ( fTurnInc &gt; 65536/2.0 )
<a name="L2203"><font color="white">02203</font>	            {
<a name="L2204"><font color="white">02204</font>	              fTurnSpeed[1] = fTurnDeltaTime;
<a name="L2205"><font color="white">02205</font>	              fTurnSpeed[2] = 0.0;
<a name="L2206"><font color="white">02206</font>	              MyHud.Message(none, &quot;180 turn &quot;$fTurnSpeed[1], 'CHEAT');
<a name="L2207"><font color="white">02207</font>	            }
<a name="L2208"><font color="white">02208</font>	          }
<a name="L2209"><font color="white">02209</font>	          else if ( fTurnSpeed[2] == 0.0 )
<a name="L2210"><font color="white">02210</font>	          { // first check
<a name="L2211"><font color="white">02211</font>	            if ( fTurnInc &gt; 65536*3.0/4.0 )
<a name="L2212"><font color="white">02212</font>	            {
<a name="L2213"><font color="white">02213</font>	              fTurnSpeed[2] = fTurnDeltaTime;
<a name="L2214"><font color="white">02214</font>	              fTurnSpeed[3] = 0.0;
<a name="L2215"><font color="white">02215</font>	              MyHud.Message(none, &quot;270 turn &quot;$fTurnSpeed[2], 'CHEAT');
<a name="L2216"><font color="white">02216</font>	            }
<a name="L2217"><font color="white">02217</font>	          }
<a name="L2218"><font color="white">02218</font>	          else if ( fTurnSpeed[3] == 0.0 )
<a name="L2219"><font color="white">02219</font>	          { // first check
<a name="L2220"><font color="white">02220</font>	            if ( fTurnInc &gt; 65536 )
<a name="L2221"><font color="white">02221</font>	            {
<a name="L2222"><font color="white">02222</font>	              fTurnSpeed[3] = fTurnDeltaTime;
<a name="L2223"><font color="white">02223</font>	              fTurnSpeed[4] = 0.0;
<a name="L2224"><font color="white">02224</font>	              MyHud.Message(none, &quot;360 turn &quot;$fTurnSpeed[3], 'CHEAT');
<a name="L2225"><font color="white">02225</font>	            }
<a name="L2226"><font color="white">02226</font>	          }
<a name="L2227"><font color="white">02227</font>	          else if ( fTurnSpeed[4] == 0.0 )
<a name="L2228"><font color="white">02228</font>	          { // first check
<a name="L2229"><font color="white">02229</font>	            if ( fTurnInc &gt; 65536*2 )
<a name="L2230"><font color="white">02230</font>	            {
<a name="L2231"><font color="white">02231</font>	              fTurnSpeed[4] = fTurnDeltaTime;
<a name="L2232"><font color="white">02232</font>	              MyHud.Message(none, &quot;720 turn &quot;$fTurnSpeed[4], 'CHEAT');
<a name="L2233"><font color="white">02233</font>	            }
<a name="L2234"><font color="white">02234</font>	          }
<a name="L2235"><font color="white">02235</font>	
<a name="L2236"><font color="white">02236</font>	
<a name="L2237"><font color="white">02237</font>	        }
<a name="L2238"><font color="white">02238</font>	        else
<a name="L2239"><font color="white">02239</font>	        {
<a name="L2240"><font color="white">02240</font>	          fTurnDeltaTime = 0.0;
<a name="L2241"><font color="white">02241</font>	          fTurnSpeed[0] = 0.0;
<a name="L2242"><font color="white">02242</font>	          fTurnInc = 0;
<a name="L2243"><font color="white">02243</font>	        }
<a name="L2244"><font color="white">02244</font>	      }
<a name="L2245"><font color="white">02245</font>	*/
<a name="L2246"><font color="white">02246</font>	      if ( DesiredFOV != DefaultFov )
<a name="L2247"><font color="white">02247</font>	      {
<a name="L2248"><font color="white">02248</font>	        ViewRotation.Yaw += 21.5 * DeltaTime * aTurn;
<a name="L2249"><font color="white">02249</font>	        ViewRotation.Pitch += 21.5 * DeltaTime * aLookUp;
<a name="L2250"><font color="white">02250</font>	      }
<a name="L2251"><font color="white">02251</font>	      else
<a name="L2252"><font color="white">02252</font>	      {
<a name="L2253"><font color="white">02253</font>	        ViewRotation.Yaw += 43.0 * DeltaTime * aTurn;
<a name="L2254"><font color="white">02254</font>	        ViewRotation.Pitch += 43.0 * DeltaTime * aLookUp;
<a name="L2255"><font color="white">02255</font>	      }
<a name="L2256"><font color="white">02256</font>	
<a name="L2257"><font color="white">02257</font>	      // ELR Handle the SniperSkill Here
<a name="L2258"><font color="white">02258</font>	      if ( (DesiredFOV != defaultFov) &amp;&amp; (Pawn!=none) &amp;&amp; Level.bLonePlayer &amp;&amp; !XIIIPlayerPawn(Pawn).bIsSniper )
<a name="L2259"><font color="white">02259</font>	      {
<a name="L2260"><font color="white">02260</font>	        if ( Pawn.Acceleration == vect(0,0,0) )
<a name="L2261"><font color="white">02261</font>	        {
<a name="L2262"><font color="white">02262</font>	          if ( Pawn.bIsCrouched )
<a name="L2263"><font color="white">02263</font>	            fSniperPrecision = fmax(0.0, fSniperPrecision - DeltaTime/3.0);
<a name="L2264"><font color="white">02264</font>	          else
<a name="L2265"><font color="white">02265</font>	            fSniperPrecision = fmax(0.0, fSniperPrecision - DeltaTime/6.0);
<a name="L2266"><font color="white">02266</font>	        }
<a name="L2267"><font color="white">02267</font>	        else
<a name="L2268"><font color="white">02268</font>	          fSniperPrecision = fMin(1.0, fSniperPrecision + DeltaTime/1.8);
<a name="L2269"><font color="white">02269</font>	        ViewRotation.Pitch -= SniperPitch;
<a name="L2270"><font color="white">02270</font>	        Viewrotation.Yaw -= SniperYaw;
<a name="L2271"><font color="white">02271</font>	        // End reinit Viewrotation
<a name="L2272"><font color="white">02272</font>	        // Processing of SniperPitch &amp; SniperYaw
<a name="L2273"><font color="white">02273</font>	        vSniperOffset.z = 0.0;
<a name="L2274"><font color="white">02274</font>	        vSniperOffsetSpeed.z = 0.0;
<a name="L2275"><font color="white">02275</font>	        vSniperOffset += vSniperOffsetSpeed * (DeltaTime/1000.0);
<a name="L2276"><font color="white">02276</font>	        vSniperOffsetSpeed -= (vSniperOffset) / (DeltaTime*Deltatime*200.0);
<a name="L2277"><font color="white">02277</font>	        vSniperOffsetSpeed += normal(vSniperOffset cross vect(0,0,1)) * 8.0;
<a name="L2278"><font color="white">02278</font>	        if ( vSize(vSniperOffsetSpeed) &gt; 4000.0 )
<a name="L2279"><font color="white">02279</font>	          vSniperOffsetSpeed = normal(vSniperOffsetSpeed)*4000.0;
<a name="L2280"><font color="white">02280</font>	        SniperPitch = fSniperPrecision * 212.0 * sin(vsniperOffset.X) * ((DefaultFov - DesiredFOV) / DefaultFov);
<a name="L2281"><font color="white">02281</font>	        SniperYaw = fSniperPrecision * 212.0 * sin(vsniperOffset.Y) * ((DefaultFov - DesiredFOV) / DefaultFov);
<a name="L2282"><font color="white">02282</font>	        // End Processing
<a name="L2283"><font color="white">02283</font>	        // Set Viewrotation
<a name="L2284"><font color="white">02284</font>	        Viewrotation.Pitch += SniperPitch;
<a name="L2285"><font color="white">02285</font>	        Viewrotation.Yaw += SniperYaw;
<a name="L2286"><font color="white">02286</font>	      }
<a name="L2287"><font color="white">02287</font>	      else if ( pawn != none )
<a name="L2288"><font color="white">02288</font>	      { // ::TODO:: this is executed each frame whne not sniping, should be optimized
<a name="L2289"><font color="white">02289</font>	        if ( XIIIPlayerPawn(Pawn).bIsSniper )
<a name="L2290"><font color="white">02290</font>	          fSniperPrecision = 0.0;
<a name="L2291"><font color="white">02291</font>	        else
<a name="L2292"><font color="white">02292</font>	        {
<a name="L2293"><font color="white">02293</font>	          fSniperPrecision = 1.0;
<a name="L2294"><font color="white">02294</font>	          vSniperOffset = vRand()*1.56;
<a name="L2295"><font color="white">02295</font>	          vSniperOffsetSpeed = vRand();
<a name="L2296"><font color="white">02296</font>	          SniperPitch = 0.0;
<a name="L2297"><font color="white">02297</font>	          SniperYaw = 0.0;
<a name="L2298"><font color="white">02298</font>	        }
<a name="L2299"><font color="white">02299</font>	      }
<a name="L2300"><font color="white">02300</font>	      // END Sniper Handle
<a name="L2301"><font color="white">02301</font>	    }
<a name="L2302"><font color="white">02302</font>	
<a name="L2303"><font color="white">02303</font>	    ViewRotation.Pitch = ViewRotation.Pitch &amp; 65535;
<a name="L2304"><font color="white">02304</font>	    if ((ViewRotation.Pitch &gt; 15500) &amp;&amp; (ViewRotation.Pitch &lt; (50000+15500)/2))
<a name="L2305"><font color="white">02305</font>	      ViewRotation.Pitch = 15500;
<a name="L2306"><font color="white">02306</font>	    else if ((ViewRotation.Pitch &gt; (50000+15500)/2) &amp;&amp; (ViewRotation.Pitch &lt; 50000))
<a name="L2307"><font color="white">02307</font>	      ViewRotation.Pitch = 50000;
<a name="L2308"><font color="white">02308</font>	/*
<a name="L2309"><font color="white">02309</font>	    if ((ViewRotation.Pitch &gt; 15500) &amp;&amp; (ViewRotation.Pitch &lt; 50000))
<a name="L2310"><font color="white">02310</font>	    {
<a name="L2311"><font color="white">02311</font>	      if (aLookUp &gt; 0)
<a name="L2312"><font color="white">02312</font>	        ViewRotation.Pitch = 15500;
<a name="L2313"><font color="white">02313</font>	      else if (aLookUp &lt; 0)
<a name="L2314"><font color="white">02314</font>	        ViewRotation.Pitch = 50000;
<a name="L2315"><font color="white">02315</font>	    }
<a name="L2316"><font color="white">02316</font>	*/
<a name="L2317"><font color="white">02317</font>	
<a name="L2318"><font color="white">02318</font>	    SetRotation(ViewRotation);
<a name="L2319"><font color="white">02319</font>	    ViewShake(deltaTime);
<a name="L2320"><font color="white">02320</font>	    ViewFlash(deltaTime);
<a name="L2321"><font color="white">02321</font>	
<a name="L2322"><font color="white">02322</font>	    NewRotation = ViewRotation;
<a name="L2323"><font color="white">02323</font>	    NewRotation.Roll = Rotation.Roll;
<a name="L2324"><font color="white">02324</font>	
<a name="L2325"><font color="white">02325</font>	    If ( (newRotation.Pitch &gt; maxPitch * RotationRate.Pitch) &amp;&amp; (newRotation.Pitch &lt; 65536 - maxPitch * RotationRate.Pitch) )
<a name="L2326"><font color="white">02326</font>	    {
<a name="L2327"><font color="white">02327</font>	      If (ViewRotation.Pitch &lt; 32768)
<a name="L2328"><font color="white">02328</font>	        newRotation.Pitch = maxPitch * RotationRate.Pitch;
<a name="L2329"><font color="white">02329</font>	      else
<a name="L2330"><font color="white">02330</font>	        newRotation.Pitch = 65536 - maxPitch * RotationRate.Pitch;
<a name="L2331"><font color="white">02331</font>	    }
<a name="L2332"><font color="white">02332</font>	    if ( !bRotateToDesired &amp;&amp; (Pawn != None) &amp;&amp; (!bFreeCamera || !bBehindView) )
<a name="L2333"><font color="white">02333</font>	      Pawn.FaceRotation(newRotation, deltatime);
<a name="L2334"><font color="white">02334</font>	
<a name="L2335"><font color="white">02335</font>	//    Pawn.ControllerPitch = newRotation.Pitch;
<a name="L2336"><font color="white">02336</font>	
<a name="L2337"><font color="white">02337</font>	//    log(&quot;Update Pitch&quot;);
<a name="L2338"><font color="white">02338</font>	}
<a name="L2339"><font color="white">02339</font>	
<a name="L2340"><font color="white">02340</font>	//_____________________________________________________________________________
<a name="L2341"><font color="white">02341</font>	function SetCamView( actor C, optional float F )
<a name="L2342"><font color="white">02342</font>	{
<a name="L2343"><font color="white">02343</font>	    if ( F==0 )
<a name="L2344"><font color="white">02344</font>	      F = 90;
<a name="L2345"><font color="white">02345</font>	    GotoState('CameraView');
<a name="L2346"><font color="white">02346</font>	    CamView = C;
<a name="L2347"><font color="white">02347</font>	    DT_mem = C.DrawType;
<a name="L2348"><font color="white">02348</font>	    C.SetDrawType(DT_none);
<a name="L2349"><font color="white">02349</font>	//    SetViewTarget(C);
<a name="L2350"><font color="white">02350</font>	    DesiredFOV = F;
<a name="L2351"><font color="white">02351</font>	    FOVAngle = F;
<a name="L2352"><font color="white">02352</font>	    DefaultFov = F;
<a name="L2353"><font color="white">02353</font>	}
<a name="L2354"><font color="white">02354</font>	
<a name="L2355"><font color="white">02355</font>	function SetCamViewPortal( actor C, optional float F )
<a name="L2356"><font color="white">02356</font>	{
<a name="L2357"><font color="white">02357</font>	  if (CamView != C)
<a name="L2358"><font color="white">02358</font>	  {
<a name="L2359"><font color="white">02359</font>	    if ( F == 0 )
<a name="L2360"><font color="white">02360</font>	      F = 90;
<a name="L2361"><font color="white">02361</font>	    CamView = C;
<a name="L2362"><font color="white">02362</font>	    CamView.Trigger(self, Pawn);
<a name="L2363"><font color="white">02363</font>	  }
<a name="L2364"><font color="white">02364</font>	}
<a name="L2365"><font color="white">02365</font>	
<a name="L2366"><font color="white">02366</font>	//_____________________________________________________________________________
<a name="L2367"><font color="white">02367</font>	function RestoreView()
<a name="L2368"><font color="white">02368</font>	{
<a name="L2369"><font color="white">02369</font>	//    SetViewTarget(Pawn);
<a name="L2370"><font color="white">02370</font>	    GotoState('PlayerWalking');
<a name="L2371"><font color="white">02371</font>	    CamView.SetDrawType(DT_mem);
<a name="L2372"><font color="white">02372</font>	    DefaultFOV = default.DefaultFOV;
<a name="L2373"><font color="white">02373</font>	    DesiredFOV = DefaultFOV;
<a name="L2374"><font color="white">02374</font>	    FOVAngle = DefaultFOV;
<a name="L2375"><font color="white">02375</font>	}
<a name="L2376"><font color="white">02376</font>	
<a name="L2377"><font color="white">02377</font>	//_____________________________________________________________________________
<a name="L2378"><font color="white">02378</font>	// ELR - Here we send the controller into hooked state
<a name="L2379"><font color="white">02379</font>	function GoHooking(Hook H)
<a name="L2380"><font color="white">02380</font>	{
<a name="L2381"><font color="white">02381</font>	    HookUsed = H;
<a name="L2382"><font color="white">02382</font>	    bHooked = true;
<a name="L2383"><font color="white">02383</font>	//    GotoState('Hooked');
<a name="L2384"><font color="white">02384</font>	}
<a name="L2385"><font color="white">02385</font>	
<a name="L2386"><font color="white">02386</font>	//_____________________________________________________________________________
<a name="L2387"><font color="white">02387</font>	// at top of a rope, climb up to the hooknavpoint
<a name="L2388"><font color="white">02388</font>	function GoClimbHookNavPoint(HookPoint HP, HookNavPoint HNP)
<a name="L2389"><font color="white">02389</font>	{
<a name="L2390"><font color="white">02390</font>	    ClimbHookPoint = HP;
<a name="L2391"><font color="white">02391</font>	    TargetHookClimb = HNP;
<a name="L2392"><font color="white">02392</font>	    bHooked = false;
<a name="L2393"><font color="white">02393</font>	    GotoState('ClimbToHookNavPoint');
<a name="L2394"><font color="white">02394</font>	}
<a name="L2395"><font color="white">02395</font>	
<a name="L2396"><font color="white">02396</font>	/*
<a name="L2397"><font color="white">02397</font>	//_____________________________________________________________________________
<a name="L2398"><font color="white">02398</font>	// ELR
<a name="L2399"><font color="white">02399</font>	function bool NearWall(float walldist)
<a name="L2400"><font color="white">02400</font>	{
<a name="L2401"><font color="white">02401</font>	    local actor HitActor;
<a name="L2402"><font color="white">02402</font>	    local vector HitLocation, HitNormal, ViewSpot, ViewDist, LookDir;
<a name="L2403"><font color="white">02403</font>	
<a name="L2404"><font color="white">02404</font>	    LookDir = vector(Rotation);
<a name="L2405"><font color="white">02405</font>	    ViewSpot = Pawn.Location + Pawn.BaseEyeHeight * vect(0,0,1);
<a name="L2406"><font color="white">02406</font>	    ViewDist = LookDir * walldist;
<a name="L2407"><font color="white">02407</font>	    HitActor = Trace(HitLocation, HitNormal, ViewSpot + ViewDist, ViewSpot, false);
<a name="L2408"><font color="white">02408</font>	    if ( HitActor == None )
<a name="L2409"><font color="white">02409</font>	      return false;
<a name="L2410"><font color="white">02410</font>	    return true;
<a name="L2411"><font color="white">02411</font>	}
<a name="L2412"><font color="white">02412</font>	*/
<a name="L2413"><font color="white">02413</font>	
<a name="L2414"><font color="white">02414</font>	//_____________________________________________________________________________
<a name="L2415"><font color="white">02415</font>	function bool TryClimbDoor(actor pDoorLocked, vector pDoorLockedPos, vector pDoorLockedNormal)
<a name="L2416"><font color="white">02416</font>	{
<a name="L2417"><font color="white">02417</font>	    local vector X, Y, Z, Start, End, HitLoc, HitNorm;
<a name="L2418"><font color="white">02418</font>	    local actor A;
<a name="L2419"><font color="white">02419</font>	
<a name="L2420"><font color="white">02420</font>	    if ( (XIIIPawn(Pawn).LHand.pOnShoulder != none) || Pawn.bIsCrouched || (XIIIPorte(pDoorLocked)==none) )
<a name="L2421"><font color="white">02421</font>	      return false;
<a name="L2422"><font color="white">02422</font>	
<a name="L2423"><font color="white">02423</font>	    if ( bWeaponMode &amp;&amp; (Pawn.Weapon.WHand == WHA_Deco) )
<a name="L2424"><font color="white">02424</font>	      return false;
<a name="L2425"><font color="white">02425</font>	
<a name="L2426"><font color="white">02426</font>	    if ( !XIIIPorte(pDoorLocked).bClimbAble )
<a name="L2427"><font color="white">02427</font>	      return false;
<a name="L2428"><font color="white">02428</font>	//    if ( !XIIIPorte(pDoorLocked).bOpened &amp;&amp; !XIIIPorte(pDoorLocked).bClosed) )
<a name="L2429"><font color="white">02429</font>	    if ( !XIIIPorte(pDoorLocked).bOpened )
<a name="L2430"><font color="white">02430</font>	      return false; // don't climb if the door is moving or not climbable.
<a name="L2431"><font color="white">02431</font>	
<a name="L2432"><font color="white">02432</font>	    GetAxes(Rotation,X,Y,Z);
<a name="L2433"><font color="white">02433</font>	//    if ( X.z &gt; -0.25 ) // ELR Just check we are not looking really down
<a name="L2434"><font color="white">02434</font>	//    {
<a name="L2435"><font color="white">02435</font>	      Start = pDoorLockedPos + pDoorLockedNormal;
<a name="L2436"><font color="white">02436</font>	      End = Start + vect(0,0,1) * Pawn.CollisionHeight;
<a name="L2437"><font color="white">02437</font>	      if ( FastTrace(End,Start) )
<a name="L2438"><font color="white">02438</font>	      {
<a name="L2439"><font color="white">02439</font>	        A=Trace(HitLoc, HitNorm, End, Start, false);
<a name="L2440"><font color="white">02440</font>	        return true;
<a name="L2441"><font color="white">02441</font>	      }
<a name="L2442"><font color="white">02442</font>	//    }
<a name="L2443"><font color="white">02443</font>	    return false;
<a name="L2444"><font color="white">02444</font>	}
<a name="L2445"><font color="white">02445</font>	
<a name="L2446"><font color="white">02446</font>	//_____________________________________________________________________________
<a name="L2447"><font color="white">02447</font>	// Normal gameplay execs
<a name="L2448"><font color="white">02448</font>	// Type the name of the exec function at the console to execute it
<a name="L2449"><font color="white">02449</font>	exec function Jump( optional float F )
<a name="L2450"><font color="white">02450</font>	{
<a name="L2451"><font color="white">02451</font>	    if ( LadderVolume(Pawn.PhysicsVolume) != none )
<a name="L2452"><font color="white">02452</font>	    { // Jumping in a ladder volume mean we do want to climb
<a name="L2453"><font color="white">02453</font>	      Pawn.PhysicsVolume.PawnEnteredVolume(Pawn);
<a name="L2454"><font color="white">02454</font>	      if (Pawn.Physics == PHYS_Ladder)
<a name="L2455"><font color="white">02455</font>	        return;
<a name="L2456"><font color="white">02456</font>	    }
<a name="L2457"><font color="white">02457</font>	
<a name="L2458"><font color="white">02458</font>	    if ( MyInteraction.bCanClimbDoor )
<a name="L2459"><font color="white">02459</font>	    {
<a name="L2460"><font color="white">02460</font>	      DoorToClimb = MyInteraction.TargetActor;
<a name="L2461"><font color="white">02461</font>	      DoorLockedNormal = MyInteraction.TargHitNorm;
<a name="L2462"><font color="white">02462</font>	      DoorLockedPos = MyInteraction.TargHitLoc;
<a name="L2463"><font color="white">02463</font>	
<a name="L2464"><font color="white">02464</font>	      GotoState('MayClimbDoor');
<a name="L2465"><font color="white">02465</font>	    }
<a name="L2466"><font color="white">02466</font>	
<a name="L2467"><font color="white">02467</font>	    bPressedJump = true;
<a name="L2468"><font color="white">02468</font>	}
<a name="L2469"><font color="white">02469</font>	
<a name="L2470"><font color="white">02470</font>	//_____________________________________________________________________________
<a name="L2471"><font color="white">02471</font>	event HearNoise( float Loudness, Actor NoiseMaker)
<a name="L2472"><font color="white">02472</font>	{
<a name="L2473"><font color="white">02473</font>	//    Log(&quot;__&quot;@self@&quot;Heard&quot;@NoiseMaker);
<a name="L2474"><font color="white">02474</font>	//    if ( XIIIPlayerPawn(Pawn).bSixSenseOn )
<a name="L2475"><font color="white">02475</font>	    if ( vSize(NoiseMaker.location - Pawn.Location) &lt; 2500/1.27 )
<a name="L2476"><font color="white">02476</font>	      XIIIPlayerPawn(Pawn).Heard(Loudness, NoiseMaker);
<a name="L2477"><font color="white">02477</font>	}
<a name="L2478"><font color="white">02478</font>	
<a name="L2479"><font color="white">02479</font>	//_____________________________________________________________________________
<a name="L2480"><font color="white">02480</font>	// called when gameplay actually starts
<a name="L2481"><font color="white">02481</font>	simulated function MatchStarting()
<a name="L2482"><font color="white">02482</font>	{
<a name="L2483"><font color="white">02483</font>	    Log(&quot;MP-] MatchStarting for&quot;@self);
<a name="L2484"><font color="white">02484</font>	    UseVignetteFilter = 0;
<a name="L2485"><font color="white">02485</font>	    UseVignetteHighlight = 0;
<a name="L2486"><font color="white">02486</font>	    bWeaponBlock = false;
<a name="L2487"><font color="white">02487</font>	    if ( Level.Game != none )
<a name="L2488"><font color="white">02488</font>	      Level.Game.RestartPlayer(Self);
<a name="L2489"><font color="white">02489</font>	    if ( PlayerInput != none )
<a name="L2490"><font color="white">02490</font>	    {
<a name="L2491"><font color="white">02491</font>	      PlayerInput.bDuckCheck = false;
<a name="L2492"><font color="white">02492</font>	      PlayerInput.iDuckMem = 0;
<a name="L2493"><font color="white">02493</font>	    }
<a name="L2494"><font color="white">02494</font>	}
<a name="L2495"><font color="white">02495</font>	
<a name="L2496"><font color="white">02496</font>	//_____________________________________________________________________________
<a name="L2497"><font color="white">02497</font>	event TeamMessage( PlayerReplicationInfo PRI, coerce string S, name Type )
<a name="L2498"><font color="white">02498</font>	{
<a name="L2499"><font color="white">02499</font>	    local string ConsoleString;
<a name="L2500"><font color="white">02500</font>	
<a name="L2501"><font color="white">02501</font>	//    log(&quot;Teammessage with PRI &quot;$PRI$&quot; hud &quot;$myHud$&quot; Player &quot;$Player$&quot; console &quot;$Player.console$&quot; string &quot;$S@&quot;Type &quot;$Type);
<a name="L2502"><font color="white">02502</font>	    ConsoleString = S;
<a name="L2503"><font color="white">02503</font>	    if ( (Type == 'Say') || (Type == 'TeamSay') )
<a name="L2504"><font color="white">02504</font>	      ConsoleString = PRI.PlayerName$&quot;: &quot;$ConsoleString;
<a name="L2505"><font color="white">02505</font>	
<a name="L2506"><font color="white">02506</font>	//    Player.Console.Message( ConsoleString, 6.0 );
<a name="L2507"><font color="white">02507</font>	    myHUD.Message( PRI, S, Type );
<a name="L2508"><font color="white">02508</font>	}
<a name="L2509"><font color="white">02509</font>	
<a name="L2510"><font color="white">02510</font>	//_____________________________________________________________________________
<a name="L2511"><font color="white">02511</font>	function StatUpdate();
<a name="L2512"><font color="white">02512</font>	
<a name="L2513"><font color="white">02513</font>	//_____________________________________________________________________________
<a name="L2514"><font color="white">02514</font>	function ClientGameEnded()
<a name="L2515"><font color="white">02515</font>	{
<a name="L2516"><font color="white">02516</font>	//    if ( (Role &lt; ROLE_Authority) || (Level.NetMode == NM_StandAlone) )
<a name="L2517"><font color="white">02517</font>	    if (Role &lt; ROLE_Authority)
<a name="L2518"><font color="white">02518</font>	      GotoState('GameEnded');
<a name="L2519"><font color="white">02519</font>	}
<a name="L2520"><font color="white">02520</font>	
<a name="L2521"><font color="white">02521</font>	//_____________________________________________________________________________
<a name="L2522"><font color="white">02522</font>	state PlayerClimbing
<a name="L2523"><font color="white">02523</font>	{
<a name="L2524"><font color="white">02524</font>	    event bool NotifyHitWall(vector HitNormal, actor Wall)
<a name="L2525"><font color="white">02525</font>	    { // ELR don't send HitWall to pawn while in ladder.
<a name="L2526"><font color="white">02526</font>	      return true;
<a name="L2527"><font color="white">02527</font>	    }
<a name="L2528"><font color="white">02528</font>	    function BeginState()
<a name="L2529"><font color="white">02529</font>	    {
<a name="L2530"><font color="white">02530</font>	      if ( Pawn != None )
<a name="L2531"><font color="white">02531</font>	      {
<a name="L2532"><font color="white">02532</font>	        Pawn.ShouldCrouch(false);
<a name="L2533"><font color="white">02533</font>	        bPressedJump = false;
<a name="L2534"><font color="white">02534</font>	        bDuck = 0;
<a name="L2535"><font color="white">02535</font>	        bPressedDuck = false;
<a name="L2536"><font color="white">02536</font>	        Pawn.ChangeAnimation();
<a name="L2537"><font color="white">02537</font>	      }
<a name="L2538"><font color="white">02538</font>	    }
<a name="L2539"><font color="white">02539</font>	    function EndState()
<a name="L2540"><font color="white">02540</font>	    {
<a name="L2541"><font color="white">02541</font>	      if ( Pawn != None )
<a name="L2542"><font color="white">02542</font>	      {
<a name="L2543"><font color="white">02543</font>	        Pawn.ShouldCrouch(false);
<a name="L2544"><font color="white">02544</font>	        bPressedJump = false;
<a name="L2545"><font color="white">02545</font>	        bDuck = 0;
<a name="L2546"><font color="white">02546</font>	        bPressedDuck = false;
<a name="L2547"><font color="white">02547</font>	        Pawn.ChangeAnimation();
<a name="L2548"><font color="white">02548</font>	        Pawn.PlaySound(hEndClimbLadderSound);
<a name="L2549"><font color="white">02549</font>	      }
<a name="L2550"><font color="white">02550</font>	    }
<a name="L2551"><font color="white">02551</font>	    function ProcessMove(float DeltaTime, vector NewAccel, eDoubleClickDir DoubleClickMove, rotator DeltaRot)
<a name="L2552"><font color="white">02552</font>	    {
<a name="L2553"><font color="white">02553</font>	      local vector OldAccel;
<a name="L2554"><font color="white">02554</font>	
<a name="L2555"><font color="white">02555</font>	      OldAccel = Pawn.Acceleration;
<a name="L2556"><font color="white">02556</font>	      if ( bAltDuck != 0 )
<a name="L2557"><font color="white">02557</font>	        NewAccel.Z = -2048.0;
<a name="L2558"><font color="white">02558</font>	      if ( bAltJump != 0 )
<a name="L2559"><font color="white">02559</font>	        NewAccel.Z = 2048.0;
<a name="L2560"><font color="white">02560</font>	
<a name="L2561"><font color="white">02561</font>	      Pawn.Acceleration = NewAccel;
<a name="L2562"><font color="white">02562</font>	//      Log(&quot;Accel=&quot;$Pawn.Acceleration@&quot;bIsCrouched=&quot;$Pawn.bIsCrouched$&quot;bIsWalking=&quot;$Pawn.bIsWalking);
<a name="L2563"><font color="white">02563</font>	/*
<a name="L2564"><font color="white">02564</font>	      if ( bPressedJump )
<a name="L2565"><font color="white">02565</font>	      {
<a name="L2566"><font color="white">02566</font>	        Pawn.DoJump(bUpdating);
<a name="L2567"><font color="white">02567</font>	        if ( Pawn.Physics == PHYS_Falling )
<a name="L2568"><font color="white">02568</font>	          GotoState('PlayerWalking');
<a name="L2569"><font color="white">02569</font>	      }
<a name="L2570"><font color="white">02570</font>	*/
<a name="L2571"><font color="white">02571</font>	    }
<a name="L2572"><font color="white">02572</font>	}
<a name="L2573"><font color="white">02573</font>	
<a name="L2574"><font color="white">02574</font>	//_____________________________________________________________________________
<a name="L2575"><font color="white">02575</font>	state PlayerWalking
<a name="L2576"><font color="white">02576</font>	{
<a name="L2577"><font color="white">02577</font>	    function ProcessMove(float DeltaTime, vector NewAccel, eDoubleClickDir DoubleClickMove, rotator DeltaRot)
<a name="L2578"><font color="white">02578</font>	    {
<a name="L2579"><font color="white">02579</font>	      local vector OldAccel, HookDir, HookMove, CenterDir;
<a name="L2580"><font color="white">02580</font>	      local bool OldCrouch;
<a name="L2581"><font color="white">02581</font>	
<a name="L2582"><font color="white">02582</font>	      if ( Pawn == none )
<a name="L2583"><font color="white">02583</font>	        return;
<a name="L2584"><font color="white">02584</font>	      // ELR Limit speed there ::FIXME:: but not for on-line because on serveur FOV don't change.
<a name="L2585"><font color="white">02585</font>	      if ( (Level.NetMode == NM_StandAlone) &amp;&amp; (DefaultFOV != DesiredFOV) )
<a name="L2586"><font color="white">02586</font>	      {
<a name="L2587"><font color="white">02587</font>	        NewAccel *= 0.01;
<a name="L2588"><font color="white">02588</font>	        XIIIPawn(Pawn).SetGroundspeed(Pawn.WalkingPct / 2.0);
<a name="L2589"><font color="white">02589</font>	      }
<a name="L2590"><font color="white">02590</font>	      else
<a name="L2591"><font color="white">02591</font>	      {
<a name="L2592"><font color="white">02592</font>	        if ( bWeaponMode )
<a name="L2593"><font color="white">02593</font>	        {
<a name="L2594"><font color="white">02594</font>	          if ( (XIIIWeapon(Pawn.Weapon) != none) &amp;&amp; XIIIWeapon(Pawn.Weapon).bHeavyWeapon )
<a name="L2595"><font color="white">02595</font>	            XIIIPawn(Pawn).SetGroundspeed(0.666);
<a name="L2596"><font color="white">02596</font>	          else if ( (XIIIPawn(Pawn).LHand != none) &amp;&amp; XIIIPawn(Pawn).LHand.bActive )
<a name="L2597"><font color="white">02597</font>	            XIIIPawn(Pawn).SetGroundspeed(0.333);
<a name="L2598"><font color="white">02598</font>	          else
<a name="L2599"><font color="white">02599</font>	            XIIIPawn(Pawn).SetGroundspeed(1.0);
<a name="L2600"><font color="white">02600</font>	        }
<a name="L2601"><font color="white">02601</font>	        else
<a name="L2602"><font color="white">02602</font>	        {
<a name="L2603"><font color="white">02603</font>	          if ( (XIIIPawn(Pawn).LHand != none) &amp;&amp; XIIIPawn(Pawn).LHand.bActive )
<a name="L2604"><font color="white">02604</font>	            XIIIPawn(Pawn).SetGroundspeed(0.333);
<a name="L2605"><font color="white">02605</font>	          else
<a name="L2606"><font color="white">02606</font>	            XIIIPawn(Pawn).SetGroundspeed(1.0);
<a name="L2607"><font color="white">02607</font>	        }
<a name="L2608"><font color="white">02608</font>	      }
<a name="L2609"><font color="white">02609</font>	
<a name="L2610"><font color="white">02610</font>	      if ( bHooked )
<a name="L2611"><font color="white">02611</font>	      {
<a name="L2612"><font color="white">02612</font>	        if ( (Pawn.Physics==PHYS_Walking) &amp;&amp; (Pawn.Location.z &gt; HookUsed.HookPoint.z) )
<a name="L2613"><font color="white">02613</font>	          HookUsed.HookLength = vSize(HookUsed.HookPoint - Pawn.Location) + 1.0;
<a name="L2614"><font color="white">02614</font>	        if ( (vSize(HookUsed.HookPoint - Pawn.Location) &gt; HookUsed.HookLength) &amp;&amp; (Pawn.Location.z &lt; HookUsed.HookPoint.z) )
<a name="L2615"><font color="white">02615</font>	        {
<a name="L2616"><font color="white">02616</font>	          Pawn.SetPhysics(PHYS_Falling);
<a name="L2617"><font color="white">02617</font>	          HookDir = normal(HookUsed.HookPoint - Pawn.Location);
<a name="L2618"><font color="white">02618</font>	          HookMove = HookDir * (vSize(HookUsed.HookPoint - Pawn.Location) - HookUsed.HookLength);
<a name="L2619"><font color="white">02619</font>	          Pawn.Move( HookMove );
<a name="L2620"><font color="white">02620</font>	          // Look for the speed to set the player (remove speed along rope axis).
<a name="L2621"><font color="white">02621</font>	          Pawn.Velocity -= HookDir * (HookDir dot Pawn.velocity);
<a name="L2622"><font color="white">02622</font>	        }
<a name="L2623"><font color="white">02623</font>	      }
<a name="L2624"><font color="white">02624</font>	
<a name="L2625"><font color="white">02625</font>	      OldAccel = Pawn.Acceleration;
<a name="L2626"><font color="white">02626</font>	      Pawn.Acceleration = NewAccel;
<a name="L2627"><font color="white">02627</font>	
<a name="L2628"><font color="white">02628</font>	//      Log(&quot;bDuck=&quot;$bDuck@&quot;bWantsToCrouch=&quot;$Pawn.bWantsToCrouch);
<a name="L2629"><font color="white">02629</font>	      if ( bPressedJump )
<a name="L2630"><font color="white">02630</font>	      {
<a name="L2631"><font color="white">02631</font>	        if ( bHooked &amp;&amp; !HookUsed.bGoUp &amp;&amp; !HookUsed.bGoDown &amp;&amp; (Hook(Pawn.SelectedItem) != none) )
<a name="L2632"><font color="white">02632</font>	        {
<a name="L2633"><font color="white">02633</font>	//          Log(&quot;Hook ActivatedByJump&quot;);
<a name="L2634"><font color="white">02634</font>	          Hook(Pawn.SelectedItem).ActivatedByJump = true;
<a name="L2635"><font color="white">02635</font>	          ActivateItem();
<a name="L2636"><font color="white">02636</font>	          return;
<a name="L2637"><font color="white">02637</font>	        }
<a name="L2638"><font color="white">02638</font>	        Pawn.DoJump(bUpdating);
<a name="L2639"><font color="white">02639</font>	      }
<a name="L2640"><font color="white">02640</font>	      if ( Pawn.Physics != PHYS_Falling )
<a name="L2641"><font color="white">02641</font>	      {
<a name="L2642"><font color="white">02642</font>	        OldCrouch = Pawn.bWantsToCrouch;
<a name="L2643"><font color="white">02643</font>	        if (bDuck == 0)
<a name="L2644"><font color="white">02644</font>	          Pawn.ShouldCrouch(false);
<a name="L2645"><font color="white">02645</font>	        else if ( Pawn.bCanCrouch )
<a name="L2646"><font color="white">02646</font>	          Pawn.ShouldCrouch(true);
<a name="L2647"><font color="white">02647</font>	      }
<a name="L2648"><font color="white">02648</font>	      else
<a name="L2649"><font color="white">02649</font>	      {
<a name="L2650"><font color="white">02650</font>	        // should reset Crouch
<a name="L2651"><font color="white">02651</font>	        if ( PlayerInput != none )
<a name="L2652"><font color="white">02652</font>	        {
<a name="L2653"><font color="white">02653</font>	          PlayerInput.bDuckCheck = false;
<a name="L2654"><font color="white">02654</font>	          PlayerInput.iDuckMem = 0;
<a name="L2655"><font color="white">02655</font>	        }
<a name="L2656"><font color="white">02656</font>	        Pawn.bWantsToCrouch = false;
<a name="L2657"><font color="white">02657</font>	        Pawn.ShouldCrouch(false);
<a name="L2658"><font color="white">02658</font>	        bDuck = 0;
<a name="L2659"><font color="white">02659</font>	        if ( !bHooked )
<a name="L2660"><font color="white">02660</font>	          bAltDuck = 0;
<a name="L2661"><font color="white">02661</font>	        if ( bHooked &amp;&amp; bPressedDuck &amp;&amp; !HookUsed.bGoUp &amp;&amp; !HookUsed.bGoDown &amp;&amp; (Hook(Pawn.SelectedItem) != none) )
<a name="L2662"><font color="white">02662</font>	        {
<a name="L2663"><font color="white">02663</font>	  //        Log(&quot;Hook ActivatedByDuck&quot;);
<a name="L2664"><font color="white">02664</font>	          HookUsed.ActivatedByDuck = true;
<a name="L2665"><font color="white">02665</font>	          ActivateItem();
<a name="L2666"><font color="white">02666</font>	          bPressedDuck = false;
<a name="L2667"><font color="white">02667</font>	          return;
<a name="L2668"><font color="white">02668</font>	        }
<a name="L2669"><font color="white">02669</font>	      }
<a name="L2670"><font color="white">02670</font>	      if ( (Hook(Pawn.SelectedItem) != none) &amp;&amp; (Pawn.SelectedItem.IsInState('Idle') || Pawn.SelectedItem.IsInState('DownItemRopeCut')) )
<a name="L2671"><font color="white">02671</font>	        bhooked = false;
<a name="L2672"><font color="white">02672</font>	    }
<a name="L2673"><font color="white">02673</font>	
<a name="L2674"><font color="white">02674</font>	    function PlayerMove( float DeltaTime )
<a name="L2675"><font color="white">02675</font>	    {
<a name="L2676"><font color="white">02676</font>	      local vector X,Y,Z, NewAccel;
<a name="L2677"><font color="white">02677</font>	      local eDoubleClickDir DoubleClickMove;
<a name="L2678"><font color="white">02678</font>	      local rotator OldRotation, ViewRotation;
<a name="L2679"><font color="white">02679</font>	      local float Speed2D;
<a name="L2680"><font color="white">02680</font>	      local bool bSaveJump;
<a name="L2681"><font color="white">02681</font>	
<a name="L2682"><font color="white">02682</font>	      if ( Pawn != none ) // May happen in on-line game
<a name="L2683"><font color="white">02683</font>	        GetAxes(Pawn.Rotation,X,Y,Z);
<a name="L2684"><font color="white">02684</font>	      else
<a name="L2685"><font color="white">02685</font>	        GetAxes(Rotation,X,Y,Z);
<a name="L2686"><font color="white">02686</font>	
<a name="L2687"><font color="white">02687</font>	      // ELR Add to avoid CenterView if mid-air
<a name="L2688"><font color="white">02688</font>	      if ( bHooked &amp;&amp; (Pawn.Physics != PHYS_Walking) )
<a name="L2689"><font color="white">02689</font>	        bCenterView = False;
<a name="L2690"><font color="white">02690</font>	
<a name="L2691"><font color="white">02691</font>	      // Update acceleration.
<a name="L2692"><font color="white">02692</font>	      NewAccel = aForward*X + aStrafe*Y;
<a name="L2693"><font color="white">02693</font>	      NewAccel.Z = 0;
<a name="L2694"><font color="white">02694</font>	      if ( VSize(NewAccel) &lt; 1.0 )
<a name="L2695"><font color="white">02695</font>	        NewAccel = vect(0,0,0);
<a name="L2696"><font color="white">02696</font>	//      DoubleClickMove = PlayerInput.CheckForDoubleClickMove(DeltaTime);
<a name="L2697"><font color="white">02697</font>	
<a name="L2698"><font color="white">02698</font>	      if ( bHooked &amp;&amp; (Pawn.Base == none) )
<a name="L2699"><font color="white">02699</font>	        NewAccel *= 0.03*1.5;
<a name="L2700"><font color="white">02700</font>	
<a name="L2701"><font color="white">02701</font>	      GroundPitch = 0;
<a name="L2702"><font color="white">02702</font>	      // ELR don't do snapview if zoomed
<a name="L2703"><font color="white">02703</font>	//      if ( (DefaultFov != DesiredFov) || (XIIIWeapon(Pawn.Weapon).bZoomed) )
<a name="L2704"><font color="white">02704</font>	//      {
<a name="L2705"><font color="white">02705</font>	//        Log(&quot;             ...reseting view because fov not ok or weapon zoom&quot;);
<a name="L2706"><font color="white">02706</font>	
<a name="L2707"><font color="white">02707</font>	/* ELR // take this back ;)
<a name="L2708"><font color="white">02708</font>	        bSnaptoLevel = false;
<a name="L2709"><font color="white">02709</font>	        bCenterView = false;
<a name="L2710"><font color="white">02710</font>	*/
<a name="L2711"><font color="white">02711</font>	
<a name="L2712"><font color="white">02712</font>	//      }
<a name="L2713"><font color="white">02713</font>	/*
<a name="L2714"><font color="white">02714</font>	      if ( bCenterView )
<a name="L2715"><font color="white">02715</font>	        log(&quot;Centering view&quot;);
<a name="L2716"><font color="white">02716</font>	*/
<a name="L2717"><font color="white">02717</font>	      if ( (Pawn != none) &amp;&amp; Pawn.Pressingfire() )
<a name="L2718"><font color="white">02718</font>	      {
<a name="L2719"><font color="white">02719</font>	        bSnaptoLevel = false;
<a name="L2720"><font color="white">02720</font>	        bCenterView = false;
<a name="L2721"><font color="white">02721</font>	      }
<a name="L2722"><font color="white">02722</font>	
<a name="L2723"><font color="white">02723</font>	      ViewRotation = Rotation;
<a name="L2724"><font color="white">02724</font>	      if ( (Pawn != none) &amp;&amp; (Pawn.Physics == PHYS_Walking) )
<a name="L2725"><font color="white">02725</font>	      {
<a name="L2726"><font color="white">02726</font>	//        Log(&quot;PlayerWalking...&quot;);
<a name="L2727"><font color="white">02727</font>	        // tell pawn about any direction changes to give it a chance to play appropriate animation
<a name="L2728"><font color="white">02728</font>	        //if walking, look up/down stairs - unless player is rotating view
<a name="L2729"><font color="white">02729</font>	//        GroundPitch = FindStairRotation(deltaTime);
<a name="L2730"><font color="white">02730</font>	//        if ( GroundPitch != 0 )
<a name="L2731"><font color="white">02731</font>	//          Log(&quot;GroundPitch=&quot;$GroundPitch@&quot;bLookUpStairs=&quot;$bLookUpStairs@&quot;bSnapToLevel=&quot;$bSnapToLevel);
<a name="L2732"><font color="white">02732</font>	        if ( (bLook == 0)
<a name="L2733"><font color="white">02733</font>	          &amp;&amp; (((Pawn.Acceleration != Vect(0,0,0)) &amp;&amp; bAlwaysLevel &amp;&amp; bSnapToLevel) || !bKeyboardLook) )
<a name="L2734"><font color="white">02734</font>	        {
<a name="L2735"><font color="white">02735</font>	//          Log(&quot;             ...aligning view&quot;);
<a name="L2736"><font color="white">02736</font>	          if ( bLookUpStairs &amp;&amp; bSnapToLevel )
<a name="L2737"><font color="white">02737</font>	          {
<a name="L2738"><font color="white">02738</font>	//            Log(&quot;             ...aligning view Setting GroundPitch ViewRotation.Pitch=&quot;$ViewRotation.Pitch@&quot;GroundPitch=&quot;$GroundPitch);
<a name="L2739"><font color="white">02739</font>	            ViewRotation.Pitch -= (GroundPitch / (DeltaTime*1000));
<a name="L2740"><font color="white">02740</font>	          }
<a name="L2741"><font color="white">02741</font>	          else if ( bCenterView &amp;&amp; (DefaultFOV == DesiredFOV) )
<a name="L2742"><font color="white">02742</font>	          {
<a name="L2743"><font color="white">02743</font>	//            Log(&quot;             ...aligning view Centering view&quot;);
<a name="L2744"><font color="white">02744</font>	            ViewRotation.Pitch = ViewRotation.Pitch &amp; 65535;
<a name="L2745"><font color="white">02745</font>	            if (ViewRotation.Pitch &gt; 32768)
<a name="L2746"><font color="white">02746</font>	              ViewRotation.Pitch -= 65536;
<a name="L2747"><font color="white">02747</font>	            ViewRotation.Pitch = ViewRotation.Pitch * (1 - 12 * FMin(0.0833, deltaTime));
<a name="L2748"><font color="white">02748</font>	            if ( Abs(ViewRotation.Pitch) &lt; 1000 )
<a name="L2749"><font color="white">02749</font>	              ViewRotation.Pitch = 0;
<a name="L2750"><font color="white">02750</font>	          }
<a name="L2751"><font color="white">02751</font>	        }
<a name="L2752"><font color="white">02752</font>	
<a name="L2753"><font color="white">02753</font>	        Speed2D = Sqrt(Pawn.Velocity.X * Pawn.Velocity.X + Pawn.Velocity.Y * Pawn.Velocity.Y);
<a name="L2754"><font color="white">02754</font>	        //add bobbing when walking
<a name="L2755"><font color="white">02755</font>	        CheckBob(DeltaTime, Speed2D, Y);
<a name="L2756"><font color="white">02756</font>	      }
<a name="L2757"><font color="white">02757</font>	      else
<a name="L2758"><font color="white">02758</font>	      {
<a name="L2759"><font color="white">02759</font>	        if ( !bKeyboardLook &amp;&amp; (bLook == 0) &amp;&amp; bCenterView )
<a name="L2760"><font color="white">02760</font>	        {
<a name="L2761"><font color="white">02761</font>	          ViewRotation.Pitch = ViewRotation.Pitch &amp; 65535;
<a name="L2762"><font color="white">02762</font>	          if (ViewRotation.Pitch &gt; 32768)
<a name="L2763"><font color="white">02763</font>	               ViewRotation.Pitch -= 65536;
<a name="L2764"><font color="white">02764</font>	          ViewRotation.Pitch = ViewRotation.Pitch * (1 - 12 * FMin(0.0833, deltaTime));
<a name="L2765"><font color="white">02765</font>	          if ( Abs(ViewRotation.Pitch) &lt; 1000 )
<a name="L2766"><font color="white">02766</font>	               ViewRotation.Pitch = 0;
<a name="L2767"><font color="white">02767</font>	        }
<a name="L2768"><font color="white">02768</font>	        BobTime = 0;
<a name="L2769"><font color="white">02769</font>	        WalkBob = WalkBob * (1 - FMin(1, 8 * deltatime));
<a name="L2770"><font color="white">02770</font>	      }
<a name="L2771"><font color="white">02771</font>	
<a name="L2772"><font color="white">02772</font>	      // Update rotation.
<a name="L2773"><font color="white">02773</font>	      SetRotation(ViewRotation);
<a name="L2774"><font color="white">02774</font>	      OldRotation = Rotation;
<a name="L2775"><font color="white">02775</font>	      // ELR Rotation Speed Down when holding corpse/Pawn
<a name="L2776"><font color="white">02776</font>	      if ( (Pawn != none) &amp;&amp; (XIIIPawn(Pawn).LHand!=none) &amp;&amp; (XIIIPawn(Pawn).LHand.pOnShoulder != none) )
<a name="L2777"><font color="white">02777</font>	        UpdateRotation(DeltaTime*0.75, 0);
<a name="L2778"><font color="white">02778</font>	      else
<a name="L2779"><font color="white">02779</font>	        UpdateRotation(DeltaTime, 0);
<a name="L2780"><font color="white">02780</font>	
<a name="L2781"><font color="white">02781</font>	      if ( bPressedJump &amp;&amp; Pawn.CannotJumpNow() )
<a name="L2782"><font color="white">02782</font>	      {
<a name="L2783"><font color="white">02783</font>	        bSaveJump = true;
<a name="L2784"><font color="white">02784</font>	        bPressedJump = false;
<a name="L2785"><font color="white">02785</font>	      }
<a name="L2786"><font color="white">02786</font>	      else
<a name="L2787"><font color="white">02787</font>	        bSaveJump = false;
<a name="L2788"><font color="white">02788</font>	
<a name="L2789"><font color="white">02789</font>	      if ( Role &lt; ROLE_Authority ) // then save this move and replicate it
<a name="L2790"><font color="white">02790</font>	        ReplicateMove(DeltaTime, NewAccel, DoubleClickMove, OldRotation - Rotation);
<a name="L2791"><font color="white">02791</font>	      else
<a name="L2792"><font color="white">02792</font>	        ProcessMove(DeltaTime, NewAccel, DoubleClickMove, OldRotation - Rotation);
<a name="L2793"><font color="white">02793</font>	      if ( (Pawn != none) &amp;&amp; (Pawn.ControllerPitch != Rotation.Pitch / 256) )
<a name="L2794"><font color="white">02794</font>	        Pawn.ControllerPitch = Rotation.Pitch / 256; // needed for ListenServer -&gt; Client
<a name="L2795"><font color="white">02795</font>	      bPressedJump = bSaveJump;
<a name="L2796"><font color="white">02796</font>	    }
<a name="L2797"><font color="white">02797</font>	}
<a name="L2798"><font color="white">02798</font>	
<a name="L2799"><font color="white">02799</font>	//_____________________________________________________________________________
<a name="L2800"><font color="white">02800</font>	// ELR
<a name="L2801"><font color="white">02801</font>	state PlayerSwimming
<a name="L2802"><font color="white">02802</font>	{
<a name="L2803"><font color="white">02803</font>	    function ProcessMove(float DeltaTime, vector NewAccel, eDoubleClickDir DoubleClickMove, rotator DeltaRot)
<a name="L2804"><font color="white">02804</font>	    {
<a name="L2805"><font color="white">02805</font>	      local vector X,Y,Z, OldAccel, HookDir, HookMove, CenterDir;
<a name="L2806"><font color="white">02806</font>	
<a name="L2807"><font color="white">02807</font>	      GetAxes(Rotation,X,Y,Z);
<a name="L2808"><font color="white">02808</font>	
<a name="L2809"><font color="white">02809</font>	      if ( bHooked )
<a name="L2810"><font color="white">02810</font>	      { // while swimming only update hooklength
<a name="L2811"><font color="white">02811</font>	        if ( (vSize(HookUsed.HookPoint - Pawn.Location) &gt; HookUsed.HookLength) &amp;&amp; (Pawn.Location.z &lt; HookUsed.HookPoint.z) )
<a name="L2812"><font color="white">02812</font>	        {
<a name="L2813"><font color="white">02813</font>	          HookDir = normal(HookUsed.HookPoint - Pawn.Location);
<a name="L2814"><font color="white">02814</font>	          HookMove = HookDir * (vSize(HookUsed.HookPoint - Pawn.Location) - HookUsed.HookLength);
<a name="L2815"><font color="white">02815</font>	          Pawn.Move( HookMove );
<a name="L2816"><font color="white">02816</font>	          // Look for the speed to set the player (remove speed along rope axis).
<a name="L2817"><font color="white">02817</font>	          Pawn.Velocity -= HookDir * (HookDir dot Pawn.velocity);
<a name="L2818"><font color="white">02818</font>	        }
<a name="L2819"><font color="white">02819</font>	      }
<a name="L2820"><font color="white">02820</font>	
<a name="L2821"><font color="white">02821</font>	      OldAccel = Pawn.Acceleration;
<a name="L2822"><font color="white">02822</font>	      Pawn.Acceleration = NewAccel;
<a name="L2823"><font color="white">02823</font>	
<a name="L2824"><font color="white">02824</font>	      Pawn.bUpAndOut = ((X Dot Pawn.Acceleration) &gt; 0) &amp;&amp; ((Pawn.Acceleration.Z &gt; 0) || (Rotation.Pitch &gt; 2048));
<a name="L2825"><font color="white">02825</font>	      if ( !Pawn.PhysicsVolume.bWaterVolume ) //check for waterjump
<a name="L2826"><font color="white">02826</font>	        NotifyPhysicsVolumeChange(Pawn.PhysicsVolume);
<a name="L2827"><font color="white">02827</font>	      if ( (Hook(Pawn.SelectedItem) != none) &amp;&amp; (Pawn.SelectedItem.IsInState('Idle') || Pawn.SelectedItem.IsInState('DownItemRopeCut')) )
<a name="L2828"><font color="white">02828</font>	        bhooked = false;
<a name="L2829"><font color="white">02829</font>	    }
<a name="L2830"><font color="white">02830</font>	
<a name="L2831"><font color="white">02831</font>	    function PlayerMove(float DeltaTime)
<a name="L2832"><font color="white">02832</font>	    {
<a name="L2833"><font color="white">02833</font>	      local rotator oldRotation;
<a name="L2834"><font color="white">02834</font>	      local vector X,Y,Z, NewAccel;
<a name="L2835"><font color="white">02835</font>	      local float Speed2D;
<a name="L2836"><font color="white">02836</font>	
<a name="L2837"><font color="white">02837</font>	      GetAxes(Rotation,X,Y,Z);
<a name="L2838"><font color="white">02838</font>	
<a name="L2839"><font color="white">02839</font>	      NewAccel = aForward*X + aStrafe*Y + aUp*vect(0,0,1);
<a name="L2840"><font color="white">02840</font>	      if ( VSize(NewAccel) &lt; 1.0 )
<a name="L2841"><font color="white">02841</font>	        NewAccel = vect(0,0,0);
<a name="L2842"><font color="white">02842</font>	
<a name="L2843"><font color="white">02843</font>	      //add bobbing when swimming
<a name="L2844"><font color="white">02844</font>	      Speed2D = Sqrt(Pawn.Velocity.X * Pawn.Velocity.X + Pawn.Velocity.Y * Pawn.Velocity.Y);
<a name="L2845"><font color="white">02845</font>	      WalkBob = Y * Bob *  0.5 * Speed2D * sin(4.0 * Level.TimeSeconds);
<a name="L2846"><font color="white">02846</font>	      WalkBob.Z = Bob * 1.5 * Speed2D * sin(8.0 * Level.TimeSeconds);
<a name="L2847"><font color="white">02847</font>	
<a name="L2848"><font color="white">02848</font>	      // Update rotation.
<a name="L2849"><font color="white">02849</font>	      oldRotation = Rotation;
<a name="L2850"><font color="white">02850</font>	      UpdateRotation(DeltaTime, 2);
<a name="L2851"><font color="white">02851</font>	
<a name="L2852"><font color="white">02852</font>	      if ( Role &lt; ROLE_Authority ) // then save this move and replicate it
<a name="L2853"><font color="white">02853</font>	        ReplicateMove(DeltaTime, NewAccel, DCLICK_None, OldRotation - Rotation);
<a name="L2854"><font color="white">02854</font>	      else
<a name="L2855"><font color="white">02855</font>	        ProcessMove(DeltaTime, NewAccel, DCLICK_None, OldRotation - Rotation);
<a name="L2856"><font color="white">02856</font>	      bPressedJump = false;
<a name="L2857"><font color="white">02857</font>	    }
<a name="L2858"><font color="white">02858</font>	    function bool NotifyPhysicsVolumeChange( PhysicsVolume NewVolume )
<a name="L2859"><font color="white">02859</font>	    {
<a name="L2860"><font color="white">02860</font>	      local actor HitActor;
<a name="L2861"><font color="white">02861</font>	      local vector HitLocation, HitNormal, checkpoint;
<a name="L2862"><font color="white">02862</font>	
<a name="L2863"><font color="white">02863</font>	      if ( !NewVolume.bWaterVolume )
<a name="L2864"><font color="white">02864</font>	      {
<a name="L2865"><font color="white">02865</font>	        Pawn.SetPhysics(PHYS_Falling);
<a name="L2866"><font color="white">02866</font>	        if (Pawn.bUpAndOut &amp;&amp; Pawn.CheckWaterJump(HitNormal)) //check for waterjump
<a name="L2867"><font color="white">02867</font>	        {
<a name="L2868"><font color="white">02868</font>	        // ONLY CHANGE HERE
<a name="L2869"><font color="white">02869</font>	          Pawn.velocity.Z = 400 + Pawn.CollisionHeight; //set here so physics uses this for remainder of tick
<a name="L2870"><font color="white">02870</font>	        // ONLY CHANGE HERE
<a name="L2871"><font color="white">02871</font>	//          Pawn.velocity.Z = 330 + 2 * Pawn.CollisionRadius; //set here so physics uses this for remainder of tick
<a name="L2872"><font color="white">02872</font>	          GotoState(Pawn.LandMovementState);
<a name="L2873"><font color="white">02873</font>	        }
<a name="L2874"><font color="white">02874</font>	        else if ( (Pawn.Velocity.Z &gt; 160) || !Pawn.TouchingWaterVolume() )
<a name="L2875"><font color="white">02875</font>	          GotoState(Pawn.LandMovementState);
<a name="L2876"><font color="white">02876</font>	        else //check if in deep water
<a name="L2877"><font color="white">02877</font>	        {
<a name="L2878"><font color="white">02878</font>	          checkpoint = Pawn.Location;
<a name="L2879"><font color="white">02879</font>	          checkpoint.Z -= (Pawn.CollisionHeight + 6.0);
<a name="L2880"><font color="white">02880</font>	          HitActor = Trace(HitLocation, HitNormal, checkpoint, Pawn.Location, false);
<a name="L2881"><font color="white">02881</font>	          if (HitActor != None)
<a name="L2882"><font color="white">02882</font>	            GotoState(Pawn.LandMovementState);
<a name="L2883"><font color="white">02883</font>	          else
<a name="L2884"><font color="white">02884</font>	          {
<a name="L2885"><font color="white">02885</font>	            Enable('Timer');
<a name="L2886"><font color="white">02886</font>	            SetTimer(0.7,false);
<a name="L2887"><font color="white">02887</font>	          }
<a name="L2888"><font color="white">02888</font>	        }
<a name="L2889"><font color="white">02889</font>	      }
<a name="L2890"><font color="white">02890</font>	      else
<a name="L2891"><font color="white">02891</font>	      {
<a name="L2892"><font color="white">02892</font>	        Disable('Timer');
<a name="L2893"><font color="white">02893</font>	        Pawn.SetPhysics(PHYS_Swimming);
<a name="L2894"><font color="white">02894</font>	      }
<a name="L2895"><font color="white">02895</font>	      return false;
<a name="L2896"><font color="white">02896</font>	    }
<a name="L2897"><font color="white">02897</font>	    function BeginState()
<a name="L2898"><font color="white">02898</font>	    {
<a name="L2899"><font color="white">02899</font>	      Disable('Timer');
<a name="L2900"><font color="white">02900</font>	      Pawn.SetPhysics(PHYS_Swimming);
<a name="L2901"><font color="white">02901</font>	//      Pawn.PlaySound(hEnteringWaterSound);
<a name="L2902"><font color="white">02902</font>	    }
<a name="L2903"><font color="white">02903</font>	    function EndState()
<a name="L2904"><font color="white">02904</font>	    {
<a name="L2905"><font color="white">02905</font>	//      Pawn.PlaySound(hExitingWaterSound);
<a name="L2906"><font color="white">02906</font>	    }
<a name="L2907"><font color="white">02907</font>	}
<a name="L2908"><font color="white">02908</font>	
<a name="L2909"><font color="white">02909</font>	/*
<a name="L2910"><font color="white">02910</font>	//_____________________________________________________________________________
<a name="L2911"><font color="white">02911</font>	// ELR
<a name="L2912"><font color="white">02912</font>	State Hooked extends PlayerWalking
<a name="L2913"><font color="white">02913</font>	{
<a name="L2914"><font color="white">02914</font>	    function BeginState()
<a name="L2915"><font color="white">02915</font>	    {
<a name="L2916"><font color="white">02916</font>	      Pawn.bCanCrouch=False;
<a name="L2917"><font color="white">02917</font>	      Pawn.bCanClimbLadders=False;
<a name="L2918"><font color="white">02918</font>	      bPressedDuck=false;
<a name="L2919"><font color="white">02919</font>	    }
<a name="L2920"><font color="white">02920</font>	    function EndState()
<a name="L2921"><font color="white">02921</font>	    {
<a name="L2922"><font color="white">02922</font>	      Pawn.bCanCrouch=True;
<a name="L2923"><font color="white">02923</font>	      Pawn.bCanClimbLadders=True;
<a name="L2924"><font color="white">02924</font>	    }
<a name="L2925"><font color="white">02925</font>	
<a name="L2926"><font color="white">02926</font>	    //_________________
<a name="L2927"><font color="white">02927</font>	    function PlayerMove( float DeltaTime )
<a name="L2928"><font color="white">02928</font>	    {
<a name="L2929"><font color="white">02929</font>	      local vector X,Y,Z, NewAccel;
<a name="L2930"><font color="white">02930</font>	      local eDoubleClickDir DoubleClickMove;
<a name="L2931"><font color="white">02931</font>	      local rotator OldRotation, ViewRotation;
<a name="L2932"><font color="white">02932</font>	      local float Speed2D;
<a name="L2933"><font color="white">02933</font>	      local bool bSaveJump;
<a name="L2934"><font color="white">02934</font>	
<a name="L2935"><font color="white">02935</font>	      GetAxes(Pawn.Rotation,X,Y,Z);
<a name="L2936"><font color="white">02936</font>	      // ELR Add to avoid CenterView if mid-air
<a name="L2937"><font color="white">02937</font>	      if ( Pawn.Physics != PHYS_Walking )
<a name="L2938"><font color="white">02938</font>	        bCenterView = False;
<a name="L2939"><font color="white">02939</font>	
<a name="L2940"><font color="white">02940</font>	//      Log(&quot;aForward=&quot;$aForward@&quot;aStrafe=&quot;$aStrafe);
<a name="L2941"><font color="white">02941</font>	
<a name="L2942"><font color="white">02942</font>	      // Update acceleration.
<a name="L2943"><font color="white">02943</font>	      NewAccel = aForward*4*X + aStrafe*4*Y;
<a name="L2944"><font color="white">02944</font>	      NewAccel.Z = 0;
<a name="L2945"><font color="white">02945</font>	//      if ( NewAccel == vect(0,0,0) )
<a name="L2946"><font color="white">02946</font>	//        NewAccel = -Pawn.Velocity*200;
<a name="L2947"><font color="white">02947</font>	      if ( Pawn.Base == none )
<a name="L2948"><font color="white">02948</font>	        NewAccel *= 0.0075;
<a name="L2949"><font color="white">02949</font>	
<a name="L2950"><font color="white">02950</font>	//      log(&quot;NewAccel=&quot;$NewAccel);
<a name="L2951"><font color="white">02951</font>	//      DoubleClickMove = PlayerInput.CheckForDoubleClickMove(DeltaTime);
<a name="L2952"><font color="white">02952</font>	
<a name="L2953"><font color="white">02953</font>	      GroundPitch = 0;
<a name="L2954"><font color="white">02954</font>	      ViewRotation = Rotation;
<a name="L2955"><font color="white">02955</font>	      if (Pawn.Physics == PHYS_Walking)
<a name="L2956"><font color="white">02956</font>	      {
<a name="L2957"><font color="white">02957</font>	        //if walking, look up/down stairs - unless player is rotating view
<a name="L2958"><font color="white">02958</font>	        GroundPitch = FindStairRotation(deltaTime);
<a name="L2959"><font color="white">02959</font>	        if (DefaultFov != DesiredFov)
<a name="L2960"><font color="white">02960</font>	        {
<a name="L2961"><font color="white">02961</font>	          bSnaptoLevel = false;
<a name="L2962"><font color="white">02962</font>	          bCenterView = false;
<a name="L2963"><font color="white">02963</font>	        }
<a name="L2964"><font color="white">02964</font>	
<a name="L2965"><font color="white">02965</font>	        if ( (bLook == 0)
<a name="L2966"><font color="white">02966</font>	          &amp;&amp; (((Pawn.Acceleration != Vect(0,0,0)) &amp;&amp; bAlwaysLevel &amp;&amp; bSnapToLevel) || !bKeyboardLook) )
<a name="L2967"><font color="white">02967</font>	        {
<a name="L2968"><font color="white">02968</font>	          if ( bLookUpStairs || bSnapToLevel )
<a name="L2969"><font color="white">02969</font>	          {
<a name="L2970"><font color="white">02970</font>	            ViewRotation.Pitch = GroundPitch;
<a name="L2971"><font color="white">02971</font>	          }
<a name="L2972"><font color="white">02972</font>	          else if ( bCenterView &amp;&amp; (DefaultFOV == DesiredFOV) )
<a name="L2973"><font color="white">02973</font>	          {
<a name="L2974"><font color="white">02974</font>	            ViewRotation.Pitch = ViewRotation.Pitch &amp; 65535;
<a name="L2975"><font color="white">02975</font>	            if (ViewRotation.Pitch &gt; 32768)
<a name="L2976"><font color="white">02976</font>	              ViewRotation.Pitch -= 65536;
<a name="L2977"><font color="white">02977</font>	            ViewRotation.Pitch = ViewRotation.Pitch * (1 - 12 * FMin(0.0833, deltaTime));
<a name="L2978"><font color="white">02978</font>	            if ( Abs(ViewRotation.Pitch) &lt; 1000 )
<a name="L2979"><font color="white">02979</font>	              ViewRotation.Pitch = 0;
<a name="L2980"><font color="white">02980</font>	          }
<a name="L2981"><font color="white">02981</font>	        }
<a name="L2982"><font color="white">02982</font>	        Speed2D = Sqrt(Pawn.Velocity.X * Pawn.Velocity.X + Pawn.Velocity.Y * Pawn.Velocity.Y);
<a name="L2983"><font color="white">02983</font>	        //add bobbing when walking
<a name="L2984"><font color="white">02984</font>	        CheckBob(DeltaTime, Speed2D, Y);
<a name="L2985"><font color="white">02985</font>	      }
<a name="L2986"><font color="white">02986</font>	
<a name="L2987"><font color="white">02987</font>	      // Update rotation.
<a name="L2988"><font color="white">02988</font>	      SetRotation(ViewRotation);
<a name="L2989"><font color="white">02989</font>	      OldRotation = Rotation;
<a name="L2990"><font color="white">02990</font>	      UpdateRotation(DeltaTime, 1);
<a name="L2991"><font color="white">02991</font>	
<a name="L2992"><font color="white">02992</font>	      if ( bPressedJump &amp;&amp; Pawn.CannotJumpNow() )
<a name="L2993"><font color="white">02993</font>	      {
<a name="L2994"><font color="white">02994</font>	        bSaveJump = true;
<a name="L2995"><font color="white">02995</font>	        bPressedJump = false;
<a name="L2996"><font color="white">02996</font>	      }
<a name="L2997"><font color="white">02997</font>	      else
<a name="L2998"><font color="white">02998</font>	        bSaveJump = false;
<a name="L2999"><font color="white">02999</font>	
<a name="L3000"><font color="white">03000</font>	      // ELR If jump pressed and colliding/facing a wall then impulse
<a name="L3001"><font color="white">03001</font>	      if ( NearWall(Pawn.CollisionRadius + 15.0) )
<a name="L3002"><font color="white">03002</font>	      {
<a name="L3003"><font color="white">03003</font>	//        Pawn.Velocity.Z = 0.0;
<a name="L3004"><font color="white">03004</font>	        if ( bPressedJump &amp;&amp; (Pawn.Physics == PHYS_Falling) )
<a name="L3005"><font color="white">03005</font>	        {
<a name="L3006"><font color="white">03006</font>	          Pawn.Velocity -= X * 300.0;
<a name="L3007"><font color="white">03007</font>	        }
<a name="L3008"><font color="white">03008</font>	      }
<a name="L3009"><font color="white">03009</font>	
<a name="L3010"><font color="white">03010</font>	      if ( Role &lt; ROLE_Authority ) // then save this move and replicate it
<a name="L3011"><font color="white">03011</font>	        ReplicateMove(DeltaTime, NewAccel, DoubleClickMove, OldRotation - Rotation);
<a name="L3012"><font color="white">03012</font>	      else
<a name="L3013"><font color="white">03013</font>	        ProcessMove(DeltaTime, NewAccel, DoubleClickMove, OldRotation - Rotation);
<a name="L3014"><font color="white">03014</font>	      bPressedJump = bSaveJump;
<a name="L3015"><font color="white">03015</font>	    }
<a name="L3016"><font color="white">03016</font>	
<a name="L3017"><font color="white">03017</font>	    //_________________
<a name="L3018"><font color="white">03018</font>	    // ELR 2nd ProcessMove, trying to get rid of vel/acc and setting the player's pos
<a name="L3019"><font color="white">03019</font>	    function ProcessMove(float DeltaTime, vector NewAccel, eDoubleClickDir DoubleClickMove, rotator DeltaRot)
<a name="L3020"><font color="white">03020</font>	    {
<a name="L3021"><font color="white">03021</font>	      local vector OldAccel, HookDir, HookMove, CenterDir;
<a name="L3022"><font color="white">03022</font>	      local bool OldCrouch;
<a name="L3023"><font color="white">03023</font>	
<a name="L3024"><font color="white">03024</font>	      OldAccel = Pawn.Acceleration;
<a name="L3025"><font color="white">03025</font>	
<a name="L3026"><font color="white">03026</font>	      // Not in Hook because need every frame treatment
<a name="L3027"><font color="white">03027</font>	      if ( Pawn.Physics==PHYS_Walking )
<a name="L3028"><font color="white">03028</font>	      {
<a name="L3029"><font color="white">03029</font>	        if ( Pawn.Location.z &gt; HookUsed.HookPoint.z )
<a name="L3030"><font color="white">03030</font>	        {
<a name="L3031"><font color="white">03031</font>	          HookUsed.HookLength = vSize(HookUsed.HookPoint - Pawn.Location) + 1.0;
<a name="L3032"><font color="white">03032</font>	        }
<a name="L3033"><font color="white">03033</font>	      }
<a name="L3034"><font color="white">03034</font>	
<a name="L3035"><font color="white">03035</font>	      if ( (vSize(HookUsed.HookPoint - Pawn.Location) &gt; HookUsed.HookLength) &amp;&amp; (Pawn.Location.z &lt; HookUsed.HookPoint.z) )
<a name="L3036"><font color="white">03036</font>	      {
<a name="L3037"><font color="white">03037</font>	        Pawn.SetPhysics(PHYS_Falling);
<a name="L3038"><font color="white">03038</font>	        HookDir = normal(HookUsed.HookPoint - Pawn.Location);
<a name="L3039"><font color="white">03039</font>	        HookMove = HookDir * (vSize(HookUsed.HookPoint - Pawn.Location) - HookUsed.HookLength);
<a name="L3040"><font color="white">03040</font>	        Pawn.Move( HookMove );
<a name="L3041"><font color="white">03041</font>	        // Look for the speed to set the player (remove speed along rope axis).
<a name="L3042"><font color="white">03042</font>	        Pawn.Velocity -= HookDir * (HookDir dot Pawn.velocity);
<a name="L3043"><font color="white">03043</font>	      }
<a name="L3044"><font color="white">03044</font>	
<a name="L3045"><font color="white">03045</font>	      Pawn.Acceleration = NewAccel;
<a name="L3046"><font color="white">03046</font>	
<a name="L3047"><font color="white">03047</font>	      if ( bPressedJump )
<a name="L3048"><font color="white">03048</font>	      {
<a name="L3049"><font color="white">03049</font>	        if ( !HookUsed.bGoUp &amp;&amp; !HookUsed.bGoDown )
<a name="L3050"><font color="white">03050</font>	        {
<a name="L3051"><font color="white">03051</font>	          Log(&quot;Hook ActivatedByJump&quot;);
<a name="L3052"><font color="white">03052</font>	          Hook(Pawn.SelectedItem).ActivatedByJump = true;
<a name="L3053"><font color="white">03053</font>	          ActivateItem();
<a name="L3054"><font color="white">03054</font>	          return;
<a name="L3055"><font color="white">03055</font>	        }
<a name="L3056"><font color="white">03056</font>	        else
<a name="L3057"><font color="white">03057</font>	          Pawn.DoJump(bUpdating);
<a name="L3058"><font color="white">03058</font>	      }
<a name="L3059"><font color="white">03059</font>	      if ( Pawn.Physics != PHYS_Falling )
<a name="L3060"><font color="white">03060</font>	      {
<a name="L3061"><font color="white">03061</font>	        OldCrouch = Pawn.bWantsToCrouch;
<a name="L3062"><font color="white">03062</font>	        if (bDuck == 0)
<a name="L3063"><font color="white">03063</font>	          Pawn.ShouldCrouch(false);
<a name="L3064"><font color="white">03064</font>	        else if ( Pawn.bCanCrouch )
<a name="L3065"><font color="white">03065</font>	          Pawn.ShouldCrouch(true);
<a name="L3066"><font color="white">03066</font>	      }
<a name="L3067"><font color="white">03067</font>	      else
<a name="L3068"><font color="white">03068</font>	      {
<a name="L3069"><font color="white">03069</font>	        if ( bPressedDuck &amp;&amp; !HookUsed.bGoUp &amp;&amp; !HookUsed.bGoDown )
<a name="L3070"><font color="white">03070</font>	        {
<a name="L3071"><font color="white">03071</font>	          Log(&quot;Hook ActivatedByDuck&quot;);
<a name="L3072"><font color="white">03072</font>	          HookUsed.ActivatedByDuck = true;
<a name="L3073"><font color="white">03073</font>	          ActivateItem();
<a name="L3074"><font color="white">03074</font>	          bPressedDuck=false;
<a name="L3075"><font color="white">03075</font>	          return;
<a name="L3076"><font color="white">03076</font>	        }
<a name="L3077"><font color="white">03077</font>	      }
<a name="L3078"><font color="white">03078</font>	
<a name="L3079"><font color="white">03079</font>	//      if ( !bWeaponMode &amp;&amp; (Hook(Pawn.SelectedItem) != none) &amp;&amp; Pawn.SelectedItem.isInState('Idle') )
<a name="L3080"><font color="white">03080</font>	    // ELR we can release hook while having weapon in hand, so...
<a name="L3081"><font color="white">03081</font>	      if ( (Hook(Pawn.SelectedItem) != none) &amp;&amp; Pawn.SelectedItem.isInState('Idle') )
<a name="L3082"><font color="white">03082</font>	      {
<a name="L3083"><font color="white">03083</font>	        GotoState('PlayerWalking');
<a name="L3084"><font color="white">03084</font>	      }
<a name="L3085"><font color="white">03085</font>	    }
<a name="L3086"><font color="white">03086</font>	}
<a name="L3087"><font color="white">03087</font>	*/
<a name="L3088"><font color="white">03088</font>	
<a name="L3089"><font color="white">03089</font>	//_____________________________________________________________________________
<a name="L3090"><font color="white">03090</font>	// ELR
<a name="L3091"><font color="white">03091</font>	State Tyroling extends PlayerWalking
<a name="L3092"><font color="white">03092</font>	{
<a name="L3093"><font color="white">03093</font>	    function BeginState()
<a name="L3094"><font color="white">03094</font>	    {
<a name="L3095"><font color="white">03095</font>	      Pawn.PlaySound(hTyrolStartSound);
<a name="L3096"><font color="white">03096</font>	    }
<a name="L3097"><font color="white">03097</font>	    function EndState()
<a name="L3098"><font color="white">03098</font>	    {
<a name="L3099"><font color="white">03099</font>	      Pawn.PlaySound(hTyrolEndSound);
<a name="L3100"><font color="white">03100</font>	      Pawn.SetPhysics(PHYS_Falling);
<a name="L3101"><font color="white">03101</font>	    }
<a name="L3102"><font color="white">03102</font>	
<a name="L3103"><font color="white">03103</font>	    //__________________
<a name="L3104"><font color="white">03104</font>	    function PlayerMove( float DeltaTime )
<a name="L3105"><font color="white">03105</font>	    {
<a name="L3106"><font color="white">03106</font>	      local vector X,Y,Z, NewAccel;
<a name="L3107"><font color="white">03107</font>	      local eDoubleClickDir DoubleClickMove;
<a name="L3108"><font color="white">03108</font>	      local rotator OldRotation, ViewRotation;
<a name="L3109"><font color="white">03109</font>	      local float Speed2D;
<a name="L3110"><font color="white">03110</font>	      local bool     bSaveJump;
<a name="L3111"><font color="white">03111</font>	
<a name="L3112"><font color="white">03112</font>	      if ( (vTyrolDir dot (Pawn.Location - vTyrolEnd) &gt; 0.0) || (vTyrolDir dot Pawn.Velocity &lt; 0.0) )
<a name="L3113"><font color="white">03113</font>	      {
<a name="L3114"><font color="white">03114</font>	        Gotostate('PlayerWalking');
<a name="L3115"><font color="white">03115</font>	        return;
<a name="L3116"><font color="white">03116</font>	      }
<a name="L3117"><font color="white">03117</font>	      GetAxes(Pawn.Rotation,X,Y,Z);
<a name="L3118"><font color="white">03118</font>	
<a name="L3119"><font color="white">03119</font>	      // Update acceleration.
<a name="L3120"><font color="white">03120</font>	//      NewAccel = aForward*X + aStrafe*Y;
<a name="L3121"><font color="white">03121</font>	      if ( vSize(vTyrolEnd - Pawn.Location) &gt; 512.0 )
<a name="L3122"><font color="white">03122</font>	        // SpeedUp
<a name="L3123"><font color="white">03123</font>	        NewAccel = vTyrolDir * 400.0;
<a name="L3124"><font color="white">03124</font>	      else
<a name="L3125"><font color="white">03125</font>	        //SlowDown
<a name="L3126"><font color="white">03126</font>	        NewAccel = - vTyrolDir * 200.0;
<a name="L3127"><font color="white">03127</font>	//      DoubleClickMove = PlayerInput.CheckForDoubleClickMove(DeltaTime);
<a name="L3128"><font color="white">03128</font>	
<a name="L3129"><font color="white">03129</font>	      GroundPitch = 0;
<a name="L3130"><font color="white">03130</font>	      ViewRotation = Rotation;
<a name="L3131"><font color="white">03131</font>	      if (Pawn.Physics == PHYS_Walking)
<a name="L3132"><font color="white">03132</font>	      {
<a name="L3133"><font color="white">03133</font>	        //if walking, look up/down stairs - unless player is rotating view
<a name="L3134"><font color="white">03134</font>	//        GroundPitch = FindStairRotation(deltaTime);
<a name="L3135"><font color="white">03135</font>	        if (DefaultFov != DesiredFov)
<a name="L3136"><font color="white">03136</font>	        {
<a name="L3137"><font color="white">03137</font>	          bSnaptoLevel = false;
<a name="L3138"><font color="white">03138</font>	          bCenterView = false;
<a name="L3139"><font color="white">03139</font>	        }
<a name="L3140"><font color="white">03140</font>	        if ( (bLook == 0)
<a name="L3141"><font color="white">03141</font>	          &amp;&amp; (((Pawn.Acceleration != Vect(0,0,0)) &amp;&amp; bAlwaysLevel &amp;&amp; bSnapToLevel) || !bKeyboardLook) )
<a name="L3142"><font color="white">03142</font>	        {
<a name="L3143"><font color="white">03143</font>	          if ( bLookUpStairs || bSnapToLevel )
<a name="L3144"><font color="white">03144</font>	          {
<a name="L3145"><font color="white">03145</font>	            ViewRotation.Pitch = GroundPitch;
<a name="L3146"><font color="white">03146</font>	          }
<a name="L3147"><font color="white">03147</font>	          else if ( bCenterView &amp;&amp; (DefaultFOV == DesiredFOV) )
<a name="L3148"><font color="white">03148</font>	          {
<a name="L3149"><font color="white">03149</font>	            ViewRotation.Pitch = ViewRotation.Pitch &amp; 65535;
<a name="L3150"><font color="white">03150</font>	            if (ViewRotation.Pitch &gt; 32768)
<a name="L3151"><font color="white">03151</font>	              ViewRotation.Pitch -= 65536;
<a name="L3152"><font color="white">03152</font>	            ViewRotation.Pitch = ViewRotation.Pitch * (1 - 12 * FMin(0.0833, deltaTime));
<a name="L3153"><font color="white">03153</font>	            if ( Abs(ViewRotation.Pitch) &lt; 1000 )
<a name="L3154"><font color="white">03154</font>	              ViewRotation.Pitch = 0;
<a name="L3155"><font color="white">03155</font>	          }
<a name="L3156"><font color="white">03156</font>	        }
<a name="L3157"><font color="white">03157</font>	
<a name="L3158"><font color="white">03158</font>	        Speed2D = Sqrt(Pawn.Velocity.X * Pawn.Velocity.X + Pawn.Velocity.Y * Pawn.Velocity.Y);
<a name="L3159"><font color="white">03159</font>	        //add bobbing when walking
<a name="L3160"><font color="white">03160</font>	        CheckBob(DeltaTime, Speed2D, Y);
<a name="L3161"><font color="white">03161</font>	      }
<a name="L3162"><font color="white">03162</font>	
<a name="L3163"><font color="white">03163</font>	      // Update rotation.
<a name="L3164"><font color="white">03164</font>	      SetRotation(ViewRotation);
<a name="L3165"><font color="white">03165</font>	      OldRotation = Rotation;
<a name="L3166"><font color="white">03166</font>	      UpdateRotation(DeltaTime, 1);
<a name="L3167"><font color="white">03167</font>	
<a name="L3168"><font color="white">03168</font>	      if ( bPressedJump &amp;&amp; Pawn.CannotJumpNow() )
<a name="L3169"><font color="white">03169</font>	      {
<a name="L3170"><font color="white">03170</font>	        bSaveJump = true;
<a name="L3171"><font color="white">03171</font>	        bPressedJump = false;
<a name="L3172"><font color="white">03172</font>	      }
<a name="L3173"><font color="white">03173</font>	      else
<a name="L3174"><font color="white">03174</font>	        bSaveJump = false;
<a name="L3175"><font color="white">03175</font>	
<a name="L3176"><font color="white">03176</font>	      if ( Role &lt; ROLE_Authority ) // then save this move and replicate it
<a name="L3177"><font color="white">03177</font>	        ReplicateMove(DeltaTime, NewAccel, DoubleClickMove, OldRotation - Rotation);
<a name="L3178"><font color="white">03178</font>	      else
<a name="L3179"><font color="white">03179</font>	        ProcessMove(DeltaTime, NewAccel, DoubleClickMove, OldRotation - Rotation);
<a name="L3180"><font color="white">03180</font>	      bPressedJump = bSaveJump;
<a name="L3181"><font color="white">03181</font>	    }
<a name="L3182"><font color="white">03182</font>	
<a name="L3183"><font color="white">03183</font>	    //__________________
<a name="L3184"><font color="white">03184</font>	    function ProcessMove(float DeltaTime, vector NewAccel, eDoubleClickDir DoubleClickMove, rotator DeltaRot)
<a name="L3185"><font color="white">03185</font>	    {
<a name="L3186"><font color="white">03186</font>	      local vector OldAccel;
<a name="L3187"><font color="white">03187</font>	      local bool OldCrouch;
<a name="L3188"><font color="white">03188</font>	
<a name="L3189"><font color="white">03189</font>	      OldAccel = Pawn.Acceleration;
<a name="L3190"><font color="white">03190</font>	      Pawn.Acceleration = NewAccel;
<a name="L3191"><font color="white">03191</font>	      Pawn.SetPhysics(PHYS_None);
<a name="L3192"><font color="white">03192</font>	      Pawn.Velocity += NewAccel * Deltatime;
<a name="L3193"><font color="white">03193</font>	      if ( vSize(Pawn.Velocity) &gt; fTyrolSpeed )
<a name="L3194"><font color="white">03194</font>	        Pawn.Velocity = normal(Pawn.Velocity) * fTyrolSpeed;
<a name="L3195"><font color="white">03195</font>	      Pawn.Move(Pawn.Velocity * Deltatime);
<a name="L3196"><font color="white">03196</font>	
<a name="L3197"><font color="white">03197</font>	      // ELR No more jump there
<a name="L3198"><font color="white">03198</font>	
<a name="L3199"><font color="white">03199</font>	      if ( Pawn.Physics != PHYS_Falling )
<a name="L3200"><font color="white">03200</font>	      {
<a name="L3201"><font color="white">03201</font>	        OldCrouch = Pawn.bWantsToCrouch;
<a name="L3202"><font color="white">03202</font>	        if (bDuck == 0)
<a name="L3203"><font color="white">03203</font>	          Pawn.ShouldCrouch(false);
<a name="L3204"><font color="white">03204</font>	        else if ( Pawn.bCanCrouch )
<a name="L3205"><font color="white">03205</font>	          Pawn.ShouldCrouch(true);
<a name="L3206"><font color="white">03206</font>	      }
<a name="L3207"><font color="white">03207</font>	    }
<a name="L3208"><font color="white">03208</font>	}
<a name="L3209"><font color="white">03209</font>	
<a name="L3210"><font color="white">03210</font>	//_____________________________________________________________________________
<a name="L3211"><font color="white">03211</font>	
<a name="L3212"><font color="white">03212</font>	state BossView
<a name="L3213"><font color="white">03213</font>	{
<a name="L3214"><font color="white">03214</font>	    ignores ReLoad, NextWeapon, cNextItem, AltFire, Jump;
<a name="L3215"><font color="white">03215</font>	
<a name="L3216"><font color="white">03216</font>	    function BeginState() {}
<a name="L3217"><font color="white">03217</font>	    function EndState() {}
<a name="L3218"><font color="white">03218</font>	
<a name="L3219"><font color="white">03219</font>	    event PlayerCalcView(out actor ViewActor, out vector CameraLocation, out rotator CameraRotation )
<a name="L3220"><font color="white">03220</font>	    {
<a name="L3221"><font color="white">03221</font>	//    	ViewActor = ViewTarget; // ELR don't set ViewActor else sound will come as heard from it
<a name="L3222"><font color="white">03222</font>	        CameraLocation = CamView.Location;
<a name="L3223"><font color="white">03223</font>	        CameraRotation = rotator( CamView.Location - CamView.Location);
<a name="L3224"><font color="white">03224</font>	    }
<a name="L3225"><font color="white">03225</font>	}
<a name="L3226"><font color="white">03226</font>	
<a name="L3227"><font color="white">03227</font>	//_____________________________________________________________________________
<a name="L3228"><font color="white">03228</font>	state CameraView
<a name="L3229"><font color="white">03229</font>	{
<a name="L3230"><font color="white">03230</font>	    ignores AltFire, Jump;
<a name="L3231"><font color="white">03231</font>	    ignores Reload, cNextItem, cPrevItem, PrevWeapon, NextWeapon;
<a name="L3232"><font color="white">03232</font>	
<a name="L3233"><font color="white">03233</font>	    function BeginState()
<a name="L3234"><font color="white">03234</font>	    {
<a name="L3235"><font color="white">03235</font>	      Pawn.Playsound(hCamViewBeginUseSound);
<a name="L3236"><font color="white">03236</font>	      Pawn.Playsound(hCamViewInUseSound);
<a name="L3237"><font color="white">03237</font>	      Pawn.Velocity = vect(0,0,0);
<a name="L3238"><font color="white">03238</font>	      Pawn.Acceleration = vect(0,0,0);
<a name="L3239"><font color="white">03239</font>	    }
<a name="L3240"><font color="white">03240</font>	    function EndState()
<a name="L3241"><font color="white">03241</font>	    {
<a name="L3242"><font color="white">03242</font>	      Pawn.StopSound(hCamViewInUseSound);
<a name="L3243"><font color="white">03243</font>	      Pawn.Playsound(hCamViewBeginUseSound);
<a name="L3244"><font color="white">03244</font>	      DefaultFOV = default.DefaultFOV;
<a name="L3245"><font color="white">03245</font>	      DesiredFOV = DefaultFOV;
<a name="L3246"><font color="white">03246</font>	      FOVAngle = DefaultFOV;
<a name="L3247"><font color="white">03247</font>	    }
<a name="L3248"><font color="white">03248</font>	    event PlayerCalcView(out actor ViewActor, out vector CameraLocation, out rotator CameraRotation )
<a name="L3249"><font color="white">03249</font>	    {
<a name="L3250"><font color="white">03250</font>	//    	ViewActor = ViewTarget; // ELR don't set ViewActor else sound will come as heard from it
<a name="L3251"><font color="white">03251</font>	      CameraLocation = CamView.Location;
<a name="L3252"><font color="white">03252</font>	      CameraRotation = CamView.Rotation;
<a name="L3253"><font color="white">03253</font>	    }
<a name="L3254"><font color="white">03254</font>	}
<a name="L3255"><font color="white">03255</font>	
<a name="L3256"><font color="white">03256</font>	//_____________________________________________________________________________
<a name="L3257"><font color="white">03257</font>	state MayClimbDoor extends PlayerWalking
<a name="L3258"><font color="white">03258</font>	{
<a name="L3259"><font color="white">03259</font>	    ignores NextWeapon, cNextItem, Grab;
<a name="L3260"><font color="white">03260</font>	
<a name="L3261"><font color="white">03261</font>	    function BeginState()
<a name="L3262"><font color="white">03262</font>	    {
<a name="L3263"><font color="white">03263</font>	      SetTimer(0.1, true);
<a name="L3264"><font color="white">03264</font>	      if ( bWeaponMode )
<a name="L3265"><font color="white">03265</font>	      {
<a name="L3266"><font color="white">03266</font>	        OldWeap = pawn.weapon.InventoryGroup;
<a name="L3267"><font color="white">03267</font>	        Pawn.Weapon.PutDown();
<a name="L3268"><font color="white">03268</font>	      }
<a name="L3269"><font color="white">03269</font>	      else
<a name="L3270"><font color="white">03270</font>	      {
<a name="L3271"><font color="white">03271</font>	        if ( OldItem != none )
<a name="L3272"><font color="white">03272</font>	        {
<a name="L3273"><font color="white">03273</font>	          cNextItem();
<a name="L3274"><font color="white">03274</font>	          XIIIPawn(Pawn).PendingItem = OldItem;
<a name="L3275"><font color="white">03275</font>	        }
<a name="L3276"><font color="white">03276</font>	        else
<a name="L3277"><font color="white">03277</font>	        {
<a name="L3278"><font color="white">03278</font>	          NextWeapon();
<a name="L3279"><font color="white">03279</font>	          Switchweapon( 0 );
<a name="L3280"><font color="white">03280</font>	        }
<a name="L3281"><font color="white">03281</font>	      }
<a name="L3282"><font color="white">03282</font>	      bWeaponBlock = true;
<a name="L3283"><font color="white">03283</font>	    }
<a name="L3284"><font color="white">03284</font>	    function Timer()
<a name="L3285"><font color="white">03285</font>	    {
<a name="L3286"><font color="white">03286</font>	      if (Pawn.Velocity.Z &lt; 0.0 )
<a name="L3287"><font color="white">03287</font>	      {
<a name="L3288"><font color="white">03288</font>	//        log(self$&quot; should try to climb&quot;);
<a name="L3289"><font color="white">03289</font>	        SetTimer(0.0, false);
<a name="L3290"><font color="white">03290</font>	        OldDoorClimbPos = Pawn.Location;
<a name="L3291"><font color="white">03291</font>	        DoorClimbMove = vect(0,0,1.0);
<a name="L3292"><font color="white">03292</font>	        Pawn.PlaySound(hClimbDoorSound);
<a name="L3293"><font color="white">03293</font>	        GotoState('ClimbDoor');
<a name="L3294"><font color="white">03294</font>	      }
<a name="L3295"><font color="white">03295</font>	    }
<a name="L3296"><font color="white">03296</font>	    event bool NotifyLanded(vector HitNormal)
<a name="L3297"><font color="white">03297</font>	    {
<a name="L3298"><font color="white">03298</font>	      GotoState('PlayerWalking');
<a name="L3299"><font color="white">03299</font>	      return true;
<a name="L3300"><font color="white">03300</font>	    }
<a name="L3301"><font color="white">03301</font>	}
<a name="L3302"><font color="white">03302</font>	
<a name="L3303"><font color="white">03303</font>	//_____________________________________________________________________________
<a name="L3304"><font color="white">03304</font>	state ClimbDoor extends PlayerWalking
<a name="L3305"><font color="white">03305</font>	{
<a name="L3306"><font color="white">03306</font>	    ignores NextWeapon, cNextItem, Grab;
<a name="L3307"><font color="white">03307</font>	
<a name="L3308"><font color="white">03308</font>	    function EndState()
<a name="L3309"><font color="white">03309</font>	    {
<a name="L3310"><font color="white">03310</font>	//      Pawn.PlaySound(hEndClimbDoorSound); // ELR don't play this anytime, just in case we could have succeeded
<a name="L3311"><font color="white">03311</font>	      bWeaponBlock = false;
<a name="L3312"><font color="white">03312</font>	      if ( bWeaponMode )
<a name="L3313"><font color="white">03313</font>	      {
<a name="L3314"><font color="white">03314</font>	        Switchweapon( OldWeap );
<a name="L3315"><font color="white">03315</font>	        Pawn.ChangedWeapon();
<a name="L3316"><font color="white">03316</font>	      }
<a name="L3317"><font color="white">03317</font>	      else
<a name="L3318"><font color="white">03318</font>	      {
<a name="L3319"><font color="white">03319</font>	        if ( OldItem != none )
<a name="L3320"><font color="white">03320</font>	        {
<a name="L3321"><font color="white">03321</font>	          cNextItem();
<a name="L3322"><font color="white">03322</font>	          XIIIPawn(Pawn).PendingItem = OldItem;
<a name="L3323"><font color="white">03323</font>	        }
<a name="L3324"><font color="white">03324</font>	        else
<a name="L3325"><font color="white">03325</font>	        {
<a name="L3326"><font color="white">03326</font>	          NextWeapon();
<a name="L3327"><font color="white">03327</font>	          Switchweapon( 0 );
<a name="L3328"><font color="white">03328</font>	        }
<a name="L3329"><font color="white">03329</font>	        Pawn.ChangedWeapon();
<a name="L3330"><font color="white">03330</font>	      }
<a name="L3331"><font color="white">03331</font>	    }
<a name="L3332"><font color="white">03332</font>	
<a name="L3333"><font color="white">03333</font>	    function ProcessMove(float DeltaTime, vector NewAccel, eDoubleClickDir DoubleClickMove, rotator DeltaRot)
<a name="L3334"><font color="white">03334</font>	    {
<a name="L3335"><font color="white">03335</font>	      local vector OldAccel;
<a name="L3336"><font color="white">03336</font>	      local vector Start,End,HitLoc,HitNorm;
<a name="L3337"><font color="white">03337</font>	      local actor A;
<a name="L3338"><font color="white">03338</font>	
<a name="L3339"><font color="white">03339</font>	      DoorClimbMove = Pawn.Location - OldDoorClimbPos;
<a name="L3340"><font color="white">03340</font>	      if ( DoorClimbMove.z == 0.0 )
<a name="L3341"><font color="white">03341</font>	      {
<a name="L3342"><font color="white">03342</font>	//        log(self$&quot; ending the climb because no more vertical speed.&quot;);
<a name="L3343"><font color="white">03343</font>	        Pawn.Acceleration = vect(0,0,0);
<a name="L3344"><font color="white">03344</font>	        Pawn.Velocity = - DoorLockedNormal * 200.0;
<a name="L3345"><font color="white">03345</font>	        GotoState('PlayerWalking');
<a name="L3346"><font color="white">03346</font>	        return;
<a name="L3347"><font color="white">03347</font>	      }
<a name="L3348"><font color="white">03348</font>	      DoorClimbMove.z = 0.0;
<a name="L3349"><font color="white">03349</font>	      if ( vSize(DoorClimbMove) &gt; 1.0 )
<a name="L3350"><font color="white">03350</font>	      {
<a name="L3351"><font color="white">03351</font>	//        log(self$&quot; ending the climb because the move is not the one predicted&quot;);
<a name="L3352"><font color="white">03352</font>	        Pawn.Acceleration = vect(0,0,0);
<a name="L3353"><font color="white">03353</font>	        Pawn.Velocity = - DoorLockedNormal * 200.0;
<a name="L3354"><font color="white">03354</font>	        Pawn.PlaySound(hEndClimbDoorSound); // ELR don't play this anytime, just in case we could have succeeded
<a name="L3355"><font color="white">03355</font>	        GotoState('PlayerWalking');
<a name="L3356"><font color="white">03356</font>	        return;
<a name="L3357"><font color="white">03357</font>	      }
<a name="L3358"><font color="white">03358</font>	
<a name="L3359"><font color="white">03359</font>	      Start = Pawn.Location;
<a name="L3360"><font color="white">03360</font>	      End = Start - DoorLockedNormal * Pawn.CollisionRadius * 1.5;
<a name="L3361"><font color="white">03361</font>	      A = Trace(HitLoc, HitNorm, End, Start);
<a name="L3362"><font color="white">03362</font>	      if ( (A != DoorToClimb) &amp;&amp; (A != none) )
<a name="L3363"><font color="white">03363</font>	      {
<a name="L3364"><font color="white">03364</font>	//        log(self$&quot; ending the climb because there is obstacle in front&quot;);
<a name="L3365"><font color="white">03365</font>	//        log(&quot;DoorNormal=&quot;$DoorLockedNormal);
<a name="L3366"><font color="white">03366</font>	        Pawn.Acceleration = vect(0,0,0);
<a name="L3367"><font color="white">03367</font>	        Pawn.Velocity = - DoorLockedNormal * 200.0;
<a name="L3368"><font color="white">03368</font>	        GotoState('PlayerWalking');
<a name="L3369"><font color="white">03369</font>	        return;
<a name="L3370"><font color="white">03370</font>	      }
<a name="L3371"><font color="white">03371</font>	
<a name="L3372"><font color="white">03372</font>	      OldDoorClimbPos = Pawn.Location;
<a name="L3373"><font color="white">03373</font>	      OldAccel = Pawn.Acceleration;
<a name="L3374"><font color="white">03374</font>	      Pawn.Acceleration = vect(0,0,0);
<a name="L3375"><font color="white">03375</font>	      Pawn.Velocity = - DoorLockedNormal * 400.0 + vect(0,0,1) * 150.0;
<a name="L3376"><font color="white">03376</font>	
<a name="L3377"><font color="white">03377</font>	      if ( bPressedJump )
<a name="L3378"><font color="white">03378</font>	        GotoState('PlayerWalking');
<a name="L3379"><font color="white">03379</font>	    }
<a name="L3380"><font color="white">03380</font>	}
<a name="L3381"><font color="white">03381</font>	
<a name="L3382"><font color="white">03382</font>	//_____________________________________________________________________________
<a name="L3383"><font color="white">03383</font>	// Player is controlling orientation of a gun turret.
<a name="L3384"><font color="white">03384</font>	state PlayerGunning
<a name="L3385"><font color="white">03385</font>	{
<a name="L3386"><font color="white">03386</font>	    ignores Reload, cNextItem, cPrevItem, PrevWeapon, NextWeapon;
<a name="L3387"><font color="white">03387</font>	
<a name="L3388"><font color="white">03388</font>	    function BeginState()
<a name="L3389"><font color="white">03389</font>	    {
<a name="L3390"><font color="white">03390</font>	      local MitraillTop GunnedTurret;
<a name="L3391"><font color="white">03391</font>	      Local vector V,W;
<a name="L3392"><font color="white">03392</font>	
<a name="L3393"><font color="white">03393</font>	      GunnedTurret = MitraillTop(Pawn.ControlledActor);
<a name="L3394"><font color="white">03394</font>	      V = GunnedTurret.location;
<a name="L3395"><font color="white">03395</font>	      W = vector(GunnedTurret.owner.Rotation);
<a name="L3396"><font color="white">03396</font>	      W.z = 0.0;
<a name="L3397"><font color="white">03397</font>	      W = Normal(W);
<a name="L3398"><font color="white">03398</font>	      V -= GunnedTurret.CollisionRadius * W;
<a name="L3399"><font color="white">03399</font>	      V -= Pawn.CollisionRadius * W;
<a name="L3400"><font color="white">03400</font>	      V.z = Pawn.Location.z;
<a name="L3401"><font color="white">03401</font>	      Pawn.SetCollision(false,false,false);
<a name="L3402"><font color="white">03402</font>	      Pawn.Velocity = vect(0,0,0);
<a name="L3403"><font color="white">03403</font>	      Pawn.Acceleration = vect(0,0,0);
<a name="L3404"><font color="white">03404</font>	      Pawn.SetLocation(V);
<a name="L3405"><font color="white">03405</font>	      Pawn.SetCollision(true,true,true);
<a name="L3406"><font color="white">03406</font>	      Pawn.bHidden = true;
<a name="L3407"><font color="white">03407</font>	      Pawn.RefreshDisplaying();
<a name="L3408"><font color="white">03408</font>	      Pawn.bStasis = true;
<a name="L3409"><font color="white">03409</font>	      if ( bWeaponMode )
<a name="L3410"><font color="white">03410</font>	      {
<a name="L3411"><font color="white">03411</font>	        OldWeap = pawn.weapon.InventoryGroup;
<a name="L3412"><font color="white">03412</font>	        Pawn.Weapon.PutDown();
<a name="L3413"><font color="white">03413</font>	      }
<a name="L3414"><font color="white">03414</font>	      else
<a name="L3415"><font color="white">03415</font>	      {
<a name="L3416"><font color="white">03416</font>	        OldItem = XIIIItems(Pawn.SelectedItem);
<a name="L3417"><font color="white">03417</font>	        OldItem.PutDown();
<a name="L3418"><font color="white">03418</font>	      }
<a name="L3419"><font color="white">03419</font>	      bWeaponBlock = true;
<a name="L3420"><font color="white">03420</font>	      SetViewTarget(Pawn.ControlledActor);
<a name="L3421"><font color="white">03421</font>	      DesiredFOV = 70;
<a name="L3422"><font color="white">03422</font>	      FOVAngle = 70;
<a name="L3423"><font color="white">03423</font>	    }
<a name="L3424"><font color="white">03424</font>	    function EndState()
<a name="L3425"><font color="white">03425</font>	    {
<a name="L3426"><font color="white">03426</font>	      Pawn.bHidden = false;
<a name="L3427"><font color="white">03427</font>	      Pawn.RefreshDisplaying();
<a name="L3428"><font color="white">03428</font>	      Pawn.bStasis = false;
<a name="L3429"><font color="white">03429</font>	      SetViewTarget(Pawn);
<a name="L3430"><font color="white">03430</font>	      DesiredFOV = DefaultFOV;
<a name="L3431"><font color="white">03431</font>	      FOVAngle = DefaultFOV;
<a name="L3432"><font color="white">03432</font>	      bWeaponBlock = false;
<a name="L3433"><font color="white">03433</font>	      DebugLog(&quot;GUNNING EndState OldItem=&quot;$OldItem@&quot;bWeaponMode=&quot;$bWeaponMode);
<a name="L3434"><font color="white">03434</font>	      if ( bWeaponMode )
<a name="L3435"><font color="white">03435</font>	      {
<a name="L3436"><font color="white">03436</font>	        Switchweapon( OldWeap );
<a name="L3437"><font color="white">03437</font>	        Pawn.ChangedWeapon();
<a name="L3438"><font color="white">03438</font>	      }
<a name="L3439"><font color="white">03439</font>	      else
<a name="L3440"><font color="white">03440</font>	      {
<a name="L3441"><font color="white">03441</font>	        if ( OldItem != none )
<a name="L3442"><font color="white">03442</font>	        {
<a name="L3443"><font color="white">03443</font>	          cNextItem();
<a name="L3444"><font color="white">03444</font>	          XIIIPawn(Pawn).PendingItem = OldItem;
<a name="L3445"><font color="white">03445</font>	        }
<a name="L3446"><font color="white">03446</font>	        else
<a name="L3447"><font color="white">03447</font>	        {
<a name="L3448"><font color="white">03448</font>	          bWaitForWeaponMode = true;
<a name="L3449"><font color="white">03449</font>	          bWeaponMode = true;
<a name="L3450"><font color="white">03450</font>	          SwitchWeapon( 0 );
<a name="L3451"><font color="white">03451</font>	        }
<a name="L3452"><font color="white">03452</font>	        Pawn.ChangedWeapon();
<a name="L3453"><font color="white">03453</font>	      }
<a name="L3454"><font color="white">03454</font>	      DebugLog(&quot;GUNNING AFTER EndState OldItem=&quot;$OldItem@&quot;bWeaponMode=&quot;$bWeaponMode);
<a name="L3455"><font color="white">03455</font>	    }
<a name="L3456"><font color="white">03456</font>	
<a name="L3457"><font color="white">03457</font>	    event PlayerCalcView(out actor ViewActor, out vector CameraLocation, out rotator CameraRotation )
<a name="L3458"><font color="white">03458</font>	    {
<a name="L3459"><font color="white">03459</font>	      Local vector X,Y,Z;
<a name="L3460"><font color="white">03460</font>	
<a name="L3461"><font color="white">03461</font>	      GetAxes(ViewTarget.rotation, X,Y,Z);
<a name="L3462"><font color="white">03462</font>	      ViewActor = ViewTarget;
<a name="L3463"><font color="white">03463</font>	      CameraLocation = ViewActor.Location - X * 60 + Z * 20.0; // + ShakeOffset;
<a name="L3464"><font color="white">03464</font>	      CameraRotation = ViewActor.Rotation;
<a name="L3465"><font color="white">03465</font>	      CalcFirstPersonView( CameraLocation, CameraRotation );
<a name="L3466"><font color="white">03466</font>	      CameraLocation -= Pawn.EyePosition();
<a name="L3467"><font color="white">03467</font>	    }
<a name="L3468"><font color="white">03468</font>	
<a name="L3469"><font color="white">03469</font>	    function Leave()
<a name="L3470"><font color="white">03470</font>	    {
<a name="L3471"><font color="white">03471</font>	      local MitraillTop GunnedTurret;
<a name="L3472"><font color="white">03472</font>	
<a name="L3473"><font color="white">03473</font>	      GunnedTurret = MitraillTop(Pawn.ControlledActor);
<a name="L3474"><font color="white">03474</font>	      GotoState('PlayerWalking');
<a name="L3475"><font color="white">03475</font>	      Pawn.SetPhysics(PHYS_Falling);
<a name="L3476"><font color="white">03476</font>	      GunnedTurret.LeaveControl();
<a name="L3477"><font color="white">03477</font>	    }
<a name="L3478"><font color="white">03478</font>	    function PlayerMove( float DeltaTime )
<a name="L3479"><font color="white">03479</font>	    {
<a name="L3480"><font color="white">03480</font>	      local MitraillTop GunnedTurret;
<a name="L3481"><font color="white">03481</font>	
<a name="L3482"><font color="white">03482</font>	      GunnedTurret = MitraillTop(Pawn.ControlledActor);
<a name="L3483"><font color="white">03483</font>	      UpdateRotation(DeltaTime, 1);
<a name="L3484"><font color="white">03484</font>	      GunnedTurret.TrySetRotation(Rotation);
<a name="L3485"><font color="white">03485</font>	      SetRotation(GunnedTurret.Rotation);
<a name="L3486"><font color="white">03486</font>	      if ( bPressedJump )
<a name="L3487"><font color="white">03487</font>	        Leave();
<a name="L3488"><font color="white">03488</font>	    }
<a name="L3489"><font color="white">03489</font>	    exec function Grab() { Leave(); }
<a name="L3490"><font color="white">03490</font>	    exec function AltFire(float value) { Leave(); }
<a name="L3491"><font color="white">03491</font>	
<a name="L3492"><font color="white">03492</font>	    exec function Fire(float value)
<a name="L3493"><font color="white">03493</font>	    {
<a name="L3494"><font color="white">03494</font>	      Mitrailltop(Pawn.ControlledActor).Fire();
<a name="L3495"><font color="white">03495</font>	    }
<a name="L3496"><font color="white">03496</font>	
<a name="L3497"><font color="white">03497</font>	    simulated event RenderOverlays( canvas C )
<a name="L3498"><font color="white">03498</font>	    {
<a name="L3499"><font color="white">03499</font>	      Pawn.ControlledActor.RenderOverlays(C);
<a name="L3500"><font color="white">03500</font>	    }
<a name="L3501"><font color="white">03501</font>	}
<a name="L3502"><font color="white">03502</font>	
<a name="L3503"><font color="white">03503</font>	//_____________________________________________________________________________
<a name="L3504"><font color="white">03504</font>	state ClimbToHookNavPoint extends PlayerWalking
<a name="L3505"><font color="white">03505</font>	{
<a name="L3506"><font color="white">03506</font>	    function BeginState()
<a name="L3507"><font color="white">03507</font>	    {
<a name="L3508"><font color="white">03508</font>	      Pawn.SetCollision(false,false,false);
<a name="L3509"><font color="white">03509</font>	      SetPhysics(PHYS_None);
<a name="L3510"><font color="white">03510</font>	    }
<a name="L3511"><font color="white">03511</font>	    function EndState()
<a name="L3512"><font color="white">03512</font>	    {
<a name="L3513"><font color="white">03513</font>	      Pawn.SetCollision(true,true,true);
<a name="L3514"><font color="white">03514</font>	      SetPhysics(PHYS_Walking);
<a name="L3515"><font color="white">03515</font>	    }
<a name="L3516"><font color="white">03516</font>	    function ProcessMove(float DeltaTime, vector NewAccel, eDoubleClickDir DoubleClickMove, rotator DeltaRot)
<a name="L3517"><font color="white">03517</font>	    {
<a name="L3518"><font color="white">03518</font>	//      Log(&quot;ClimbToHookNavPoint ProcessMove&quot;);
<a name="L3519"><font color="white">03519</font>	      Pawn.Acceleration = vect(0,0,0);
<a name="L3520"><font color="white">03520</font>	      if ( Pawn.Location.Z &lt; (TargetHookClimb.Location.Z) )
<a name="L3521"><font color="white">03521</font>	      {
<a name="L3522"><font color="white">03522</font>	//        Log(&quot;                    ProcessMove going up&quot;);
<a name="L3523"><font color="white">03523</font>	        Pawn.Velocity = vect(0,0,256);
<a name="L3524"><font color="white">03524</font>	      }
<a name="L3525"><font color="white">03525</font>	      else
<a name="L3526"><font color="white">03526</font>	      {
<a name="L3527"><font color="white">03527</font>	//        Log(&quot;                    ProcessMove going to nav point&quot;);
<a name="L3528"><font color="white">03528</font>	        Pawn.Velocity = normal(TargetHookClimb.Location - Pawn.Location)*256;
<a name="L3529"><font color="white">03529</font>	      }
<a name="L3530"><font color="white">03530</font>	      if ( vSize(TargetHookClimb.Location - Pawn.Location) &lt; 20.0 )
<a name="L3531"><font color="white">03531</font>	      {
<a name="L3532"><font color="white">03532</font>	//        Log(&quot;                    GOTO PlayerWalking because reached target&quot;);
<a name="L3533"><font color="white">03533</font>	        GotoState('PlayerWalking');
<a name="L3534"><font color="white">03534</font>	      }
<a name="L3535"><font color="white">03535</font>	    }
<a name="L3536"><font color="white">03536</font>	}
<a name="L3537"><font color="white">03537</font>	
<a name="L3538"><font color="white">03538</font>	//_____________________________________________________________________________
<a name="L3539"><font color="white">03539</font>	state GameEnded
<a name="L3540"><font color="white">03540</font>	{
<a name="L3541"><font color="white">03541</font>	    ignores SeePlayer, HearNoise, KilledBy, NotifyBump, HitWall, NotifyHeadVolumeChange,
<a name="L3542"><font color="white">03542</font>	      NotifyPhysicsVolumeChange, Falling, TakeDamage, Suicide, Reload, cNextItem, NextWeapon, PrevWeapon, cPrevItem, Grab;
<a name="L3543"><font color="white">03543</font>	
<a name="L3544"><font color="white">03544</font>	    simulated event RenderOverlays( canvas C ) {}
<a name="L3545"><font color="white">03545</font>	    function PawnDied() {}
<a name="L3546"><font color="white">03546</font>	    exec function ThrowWeapon() {}
<a name="L3547"><font color="white">03547</font>	
<a name="L3548"><font color="white">03548</font>	    function bool IsInLethalVolume(out optional volume Vol)
<a name="L3549"><font color="white">03549</font>	    {
<a name="L3550"><font color="white">03550</font>	      local Volume V;
<a name="L3551"><font color="white">03551</font>	
<a name="L3552"><font color="white">03552</font>	      ForEach Pawn.TouchingActors(class'Volume',V)
<a name="L3553"><font color="white">03553</font>	        if ( V.IsA('Lethalvolume') )
<a name="L3554"><font color="white">03554</font>	        {
<a name="L3555"><font color="white">03555</font>	          Vol = V;
<a name="L3556"><font color="white">03556</font>	          return true;
<a name="L3557"><font color="white">03557</font>	        }
<a name="L3558"><font color="white">03558</font>	      return false;
<a name="L3559"><font color="white">03559</font>	    }
<a name="L3560"><font color="white">03560</font>	
<a name="L3561"><font color="white">03561</font>	    function ServerReStartGame()
<a name="L3562"><font color="white">03562</font>	    {
<a name="L3563"><font color="white">03563</font>	      Level.Game.RestartGame();
<a name="L3564"><font color="white">03564</font>	    }
<a name="L3565"><font color="white">03565</font>	
<a name="L3566"><font color="white">03566</font>	// ELR E3 CHEAT
<a name="L3567"><font color="white">03567</font>	    exec function Fire( optional float F )
<a name="L3568"><font color="white">03568</font>	    {
<a name="L3569"><font color="white">03569</font>	//      ConsoleCommand(&quot;RestartLevel&quot;);
<a name="L3570"><font color="white">03570</font>	    }
<a name="L3571"><font color="white">03571</font>	    exec function AltFire( optional float F )
<a name="L3572"><font color="white">03572</font>	    {
<a name="L3573"><font color="white">03573</font>	//      ConsoleCommand(&quot;RestartLevel&quot;);
<a name="L3574"><font color="white">03574</font>	    }
<a name="L3575"><font color="white">03575</font>	// ELR END E3 CHEATS
<a name="L3576"><font color="white">03576</font>	/*
<a name="L3577"><font color="white">03577</font>	    exec function Fire( optional float F )
<a name="L3578"><font color="white">03578</font>	    {
<a name="L3579"><font color="white">03579</font>	      if ( Role &lt; ROLE_Authority)
<a name="L3580"><font color="white">03580</font>	        return;
<a name="L3581"><font color="white">03581</font>	      if ( !bFrozen )
<a name="L3582"><font color="white">03582</font>	        ServerReStartGame();
<a name="L3583"><font color="white">03583</font>	      else if ( TimerRate &lt;= 0 )
<a name="L3584"><font color="white">03584</font>	        SetTimer(1.5, false);
<a name="L3585"><font color="white">03585</font>	    }
<a name="L3586"><font color="white">03586</font>	
<a name="L3587"><font color="white">03587</font>	    exec function AltFire( optional float F )
<a name="L3588"><font color="white">03588</font>	    {
<a name="L3589"><font color="white">03589</font>	      Fire(F);
<a name="L3590"><font color="white">03590</font>	    }
<a name="L3591"><font color="white">03591</font>	*/
<a name="L3592"><font color="white">03592</font>	
<a name="L3593"><font color="white">03593</font>	    function PlayerMove(float DeltaTime)
<a name="L3594"><font color="white">03594</font>	    {
<a name="L3595"><font color="white">03595</font>	      local vector X,Y,Z;
<a name="L3596"><font color="white">03596</font>	      local Rotator ViewRotation;
<a name="L3597"><font color="white">03597</font>	
<a name="L3598"><font color="white">03598</font>	      GetAxes(Rotation,X,Y,Z);
<a name="L3599"><font color="white">03599</font>	      // Update view rotation.
<a name="L3600"><font color="white">03600</font>	
<a name="L3601"><font color="white">03601</font>	      if ( !bFixedCamera )
<a name="L3602"><font color="white">03602</font>	      {
<a name="L3603"><font color="white">03603</font>	        ViewRotation = Rotation;
<a name="L3604"><font color="white">03604</font>	        ViewRotation.Yaw += 32.0 * DeltaTime * aTurn;
<a name="L3605"><font color="white">03605</font>	        ViewRotation.Pitch += 32.0 * DeltaTime * aLookUp;
<a name="L3606"><font color="white">03606</font>	        ViewRotation.Pitch = ViewRotation.Pitch &amp; 65535;
<a name="L3607"><font color="white">03607</font>	        If ((ViewRotation.Pitch &gt; 18000) &amp;&amp; (ViewRotation.Pitch &lt; 49152))
<a name="L3608"><font color="white">03608</font>	        {
<a name="L3609"><font color="white">03609</font>	          If (aLookUp &gt; 0)
<a name="L3610"><font color="white">03610</font>	            ViewRotation.Pitch = 18000;
<a name="L3611"><font color="white">03611</font>	          else
<a name="L3612"><font color="white">03612</font>	            ViewRotation.Pitch = 49152;
<a name="L3613"><font color="white">03613</font>	        }
<a name="L3614"><font color="white">03614</font>	        SetRotation(ViewRotation);
<a name="L3615"><font color="white">03615</font>	      }
<a name="L3616"><font color="white">03616</font>	      else if ( ViewTarget != None )
<a name="L3617"><font color="white">03617</font>	        SetRotation(ViewTarget.Rotation);
<a name="L3618"><font color="white">03618</font>	
<a name="L3619"><font color="white">03619</font>	      ViewShake(DeltaTime);
<a name="L3620"><font color="white">03620</font>	      ViewFlash(DeltaTime);
<a name="L3621"><font color="white">03621</font>	
<a name="L3622"><font color="white">03622</font>	      if ( Role &lt; ROLE_Authority ) // then save this move and replicate it
<a name="L3623"><font color="white">03623</font>	        ReplicateMove(DeltaTime, vect(0,0,0), DCLICK_None, rot(0,0,0));
<a name="L3624"><font color="white">03624</font>	      else
<a name="L3625"><font color="white">03625</font>	        ProcessMove(DeltaTime, vect(0,0,0), DCLICK_None, rot(0,0,0));
<a name="L3626"><font color="white">03626</font>	      bPressedJump = false;
<a name="L3627"><font color="white">03627</font>	    }
<a name="L3628"><font color="white">03628</font>	
<a name="L3629"><font color="white">03629</font>	    function ServerMove
<a name="L3630"><font color="white">03630</font>	    (
<a name="L3631"><font color="white">03631</font>	      float TimeStamp,
<a name="L3632"><font color="white">03632</font>	      vector InAccel,
<a name="L3633"><font color="white">03633</font>	      vector ClientLoc,
<a name="L3634"><font color="white">03634</font>	      bool NewbRun,
<a name="L3635"><font color="white">03635</font>	      bool NewbDuck,
<a name="L3636"><font color="white">03636</font>	      bool NewbJumpStatus,
<a name="L3637"><font color="white">03637</font>	      eDoubleClickDir DoubleClickMove,
<a name="L3638"><font color="white">03638</font>	      byte ClientRoll,
<a name="L3639"><font color="white">03639</font>	      int View,
<a name="L3640"><font color="white">03640</font>	      optional byte OldTimeDelta,
<a name="L3641"><font color="white">03641</font>	      optional int OldAccel
<a name="L3642"><font color="white">03642</font>	    )
<a name="L3643"><font color="white">03643</font>	    {
<a name="L3644"><font color="white">03644</font>	      Global.ServerMove(TimeStamp, InAccel, ClientLoc, NewbRun, NewbDuck, NewbJumpStatus,
<a name="L3645"><font color="white">03645</font>	        DoubleClickMove, ClientRoll, (32767 &amp; (Rotation.Pitch/2)) * 32768 + (32767 &amp; (Rotation.Yaw/2)) );
<a name="L3646"><font color="white">03646</font>	
<a name="L3647"><font color="white">03647</font>	    }
<a name="L3648"><font color="white">03648</font>	
<a name="L3649"><font color="white">03649</font>	    event PlayerCalcView(out actor ViewActor, out vector CameraLocation, out rotator CameraRotation )
<a name="L3650"><font color="white">03650</font>	    {
<a name="L3651"><font color="white">03651</font>	      ViewActor = ViewTarget;
<a name="L3652"><font color="white">03652</font>	      CameraLocation = vGameEndedCamLoc;
<a name="L3653"><font color="white">03653</font>	      CameraRotation = rGameEndedCamRot;
<a name="L3654"><font color="white">03654</font>	    }
<a name="L3655"><font color="white">03655</font>	
<a name="L3656"><font color="white">03656</font>	    function FindGoodView()
<a name="L3657"><font color="white">03657</font>	    {
<a name="L3658"><font color="white">03658</font>	      local vector cameraLoc;
<a name="L3659"><font color="white">03659</font>	      local rotator cameraRot, ViewRotation;
<a name="L3660"><font color="white">03660</font>	      local int tries, besttry;
<a name="L3661"><font color="white">03661</font>	      local float bestdist, newdist;
<a name="L3662"><font color="white">03662</font>	      local int startYaw;
<a name="L3663"><font color="white">03663</font>	      local actor ViewActor;
<a name="L3664"><font color="white">03664</font>	
<a name="L3665"><font color="white">03665</font>	      ViewRotation = Rotation;
<a name="L3666"><font color="white">03666</font>	      ViewRotation.Pitch = 56000;
<a name="L3667"><font color="white">03667</font>	      tries = 0;
<a name="L3668"><font color="white">03668</font>	      besttry = 0;
<a name="L3669"><font color="white">03669</font>	      bestdist = 0.0;
<a name="L3670"><font color="white">03670</font>	      startYaw = ViewRotation.Yaw;
<a name="L3671"><font color="white">03671</font>	
<a name="L3672"><font color="white">03672</font>	      for (tries=0; tries&lt;16; tries++)
<a name="L3673"><font color="white">03673</font>	      {
<a name="L3674"><font color="white">03674</font>	        cameraLoc = ViewTarget.Location;
<a name="L3675"><font color="white">03675</font>	        PlayerCalcView(ViewActor, cameraLoc, cameraRot);
<a name="L3676"><font color="white">03676</font>	        newdist = VSize(cameraLoc - ViewTarget.Location);
<a name="L3677"><font color="white">03677</font>	        if (newdist &gt; bestdist)
<a name="L3678"><font color="white">03678</font>	        {
<a name="L3679"><font color="white">03679</font>	          bestdist = newdist;
<a name="L3680"><font color="white">03680</font>	          besttry = tries;
<a name="L3681"><font color="white">03681</font>	        }
<a name="L3682"><font color="white">03682</font>	        ViewRotation.Yaw += 4096;
<a name="L3683"><font color="white">03683</font>	      }
<a name="L3684"><font color="white">03684</font>	
<a name="L3685"><font color="white">03685</font>	      ViewRotation.Yaw = startYaw + besttry * 4096;
<a name="L3686"><font color="white">03686</font>	      SetRotation(ViewRotation);
<a name="L3687"><font color="white">03687</font>	    }
<a name="L3688"><font color="white">03688</font>	
<a name="L3689"><font color="white">03689</font>	    function Timer()
<a name="L3690"><font color="white">03690</font>	    {
<a name="L3691"><font color="white">03691</font>	      bFrozen = false;
<a name="L3692"><font color="white">03692</font>	    }
<a name="L3693"><font color="white">03693</font>	
<a name="L3694"><font color="white">03694</font>	    function BeginState()
<a name="L3695"><font color="white">03695</font>	    {
<a name="L3696"><font color="white">03696</font>	      local Pawn P;
<a name="L3697"><font color="white">03697</font>	      Local Actor A;
<a name="L3698"><font color="white">03698</font>	      Local Volume V;
<a name="L3699"><font color="white">03699</font>	      local int XIIIEndGameType;
<a name="L3700"><font color="white">03700</font>	
<a name="L3701"><font color="white">03701</font>	      bFixedCamera = true;
<a name="L3702"><font color="white">03702</font>	      DesiredFOV = DefaultFOV;
<a name="L3703"><font color="white">03703</font>	      FOVAngle = DefaultFOV;
<a name="L3704"><font color="white">03704</font>	
<a name="L3705"><font color="white">03705</font>	      if ( Level.Game != none )
<a name="L3706"><font color="white">03706</font>	        XIIIEndGameType = XIIIGameInfo(Level.Game).XIIIEndGameType;
<a name="L3707"><font color="white">03707</font>	      else
<a name="L3708"><font color="white">03708</font>	        XIIIEndGameType = 0;
<a name="L3709"><font color="white">03709</font>	
<a name="L3710"><font color="white">03710</font>	      Log(&quot;Game Ended for &quot;$self$&quot; w/ mode &quot;$XIIIEndGameType);
<a name="L3711"><font color="white">03711</font>	
<a name="L3712"><font color="white">03712</font>	      // Hide all inventory that should be rendered
<a name="L3713"><font color="white">03713</font>	      if ( Pawn != none )
<a name="L3714"><font color="white">03714</font>	      {
<a name="L3715"><font color="white">03715</font>	        Pawn.bCanClimbLadders = false; // no more ladder climb (in case player jumps in a laddervolume just before gameended
<a name="L3716"><font color="white">03716</font>	        Pawn.bCanJump = false;
<a name="L3717"><font color="white">03717</font>	        bWeaponBlock = true;
<a name="L3718"><font color="white">03718</font>	/*
<a name="L3719"><font color="white">03719</font>	        Pawn.PendingWeapon = none;
<a name="L3720"><font color="white">03720</font>	        Pawn.PendingItem = none;
<a name="L3721"><font color="white">03721</font>	        if ( pawn.weapon != none )
<a name="L3722"><font color="white">03722</font>	        {
<a name="L3723"><font color="white">03723</font>	          OldWeap = pawn.weapon.InventoryGroup;
<a name="L3724"><font color="white">03724</font>	          Pawn.Weapon.PutDown();
<a name="L3725"><font color="white">03725</font>	        }
<a name="L3726"><font color="white">03726</font>	        if ( Pawn.SelectedItem != none )
<a name="L3727"><font color="white">03727</font>	        {
<a name="L3728"><font color="white">03728</font>	          OldItem = XIIIItems(Pawn.SelectedItem);
<a name="L3729"><font color="white">03729</font>	          OldItem.PutDown();
<a name="L3730"><font color="white">03730</font>	        }
<a name="L3731"><font color="white">03731</font>	*/
<a name="L3732"><font color="white">03732</font>	        if ( Pawn.Weapon != none )
<a name="L3733"><font color="white">03733</font>	        {
<a name="L3734"><font color="white">03734</font>	          Pawn.Weapon.bOwnerNoSee = true;
<a name="L3735"><font color="white">03735</font>	          Pawn.Weapon.bHidden = true;
<a name="L3736"><font color="white">03736</font>	          Pawn.Weapon.Refreshdisplaying();
<a name="L3737"><font color="white">03737</font>	          if ( Pawn.Weapon.MySlave != none )
<a name="L3738"><font color="white">03738</font>	          {
<a name="L3739"><font color="white">03739</font>	            Pawn.Weapon.MySlave.bOwnerNoSee = true;
<a name="L3740"><font color="white">03740</font>	            Pawn.Weapon.MySlave.bHidden = true;
<a name="L3741"><font color="white">03741</font>	            Pawn.Weapon.MySlave.Refreshdisplaying();
<a name="L3742"><font color="white">03742</font>	          }
<a name="L3743"><font color="white">03743</font>	        }
<a name="L3744"><font color="white">03744</font>	        if ( Pawn.SelectedItem != none )
<a name="L3745"><font color="white">03745</font>	        {
<a name="L3746"><font color="white">03746</font>	          Pawn.SelectedItem.bOwnerNoSee = true;
<a name="L3747"><font color="white">03747</font>	          Pawn.SelectedItem.bHidden = true;
<a name="L3748"><font color="white">03748</font>	          Pawn.SelectedItem.Refreshdisplaying();
<a name="L3749"><font color="white">03749</font>	        }
<a name="L3750"><font color="white">03750</font>	        if ( XIIIPawn(Pawn).LHand != none )
<a name="L3751"><font color="white">03751</font>	        {
<a name="L3752"><font color="white">03752</font>	          XIIIPawn(Pawn).LHand.bOwnerNoSee = true;
<a name="L3753"><font color="white">03753</font>	          XIIIPawn(Pawn).LHand.bHidden = true;
<a name="L3754"><font color="white">03754</font>	          XIIIPawn(Pawn).LHand.Refreshdisplaying();
<a name="L3755"><font color="white">03755</font>	        }
<a name="L3756"><font color="white">03756</font>	      }
<a name="L3757"><font color="white">03757</font>	
<a name="L3758"><font color="white">03758</font>	      Global.PlayerCalcView(A, vGameEndedCamLoc, rGameEndedCamRot);
<a name="L3759"><font color="white">03759</font>	
<a name="L3760"><font color="white">03760</font>	      if ( XIIIEndGameType == 1 ) // SoloDeath
<a name="L3761"><font color="white">03761</font>	      {
<a name="L3762"><font color="white">03762</font>	        if ( fRand() &lt; 0.5 )
<a name="L3763"><font color="white">03763</font>	          iGameEndedRandEffect = 1;
<a name="L3764"><font color="white">03764</font>	        else
<a name="L3765"><font color="white">03765</font>	          iGameEndedRandEffect = -1;
<a name="L3766"><font color="white">03766</font>	        if ( XIIIPawn(pawn).HitDamageType != class'XIII.DTDrowned' )
<a name="L3767"><font color="white">03767</font>	          GotoState('GameEndedDeath');
<a name="L3768"><font color="white">03768</font>	        else
<a name="L3769"><font color="white">03769</font>	          GotoState('GameEndedDrown');
<a name="L3770"><font color="white">03770</font>	      }
<a name="L3771"><font color="white">03771</font>	      else if ( XIIIEndGameType == 3 ) // Falling
<a name="L3772"><font color="white">03772</font>	      {
<a name="L3773"><font color="white">03773</font>	        if ( IsInLethalVolume(V) )
<a name="L3774"><font color="white">03774</font>	        {
<a name="L3775"><font color="white">03775</font>	//          Log(&quot;I'm in Lethalvolume V=&quot;$V);
<a name="L3776"><font color="white">03776</font>	          OnoF = Spawn(class'OnoFalling', Pawn,,Pawn.Location);
<a name="L3777"><font color="white">03777</font>	          vGameEndedCamLoc = Lethalvolume(V).PointOfViewWhenFalling.Location;
<a name="L3778"><font color="white">03778</font>	        }
<a name="L3779"><font color="white">03779</font>	//        Log(&quot;Volume V=&quot;$V$&quot; PointOfViewWhenFalling=&quot;$Lethalvolume(V).PointOfViewWhenFalling);
<a name="L3780"><font color="white">03780</font>	        iGameEndedRandEffect = 1;
<a name="L3781"><font color="white">03781</font>	        bBehindView = true;
<a name="L3782"><font color="white">03782</font>	        GotoState('GameEndedFalling');
<a name="L3783"><font color="white">03783</font>	      }
<a name="L3784"><font color="white">03784</font>	      else if ( XIIIEndGameType == 4 ) // Success
<a name="L3785"><font color="white">03785</font>	      {
<a name="L3786"><font color="white">03786</font>	        GotoState('GameEndedSuccess');
<a name="L3787"><font color="white">03787</font>	      }
<a name="L3788"><font color="white">03788</font>	
<a name="L3789"><font color="white">03789</font>	      EndZoom();
<a name="L3790"><font color="white">03790</font>	      bFire = 0;
<a name="L3791"><font color="white">03791</font>	      bAltFire = 0;
<a name="L3792"><font color="white">03792</font>	      if ( Pawn != None )
<a name="L3793"><font color="white">03793</font>	      {
<a name="L3794"><font color="white">03794</font>	        Pawn.SimAnim.AnimRate = 0;
<a name="L3795"><font color="white">03795</font>	        Pawn.bPhysicsAnimUpdate = false;
<a name="L3796"><font color="white">03796</font>	        Pawn.StopAnimating();
<a name="L3797"><font color="white">03797</font>	        Pawn.SetCollision(false,false,false);
<a name="L3798"><font color="white">03798</font>	      }
<a name="L3799"><font color="white">03799</font>	      myHUD.bShowScores = true;
<a name="L3800"><font color="white">03800</font>	      bFrozen = true;
<a name="L3801"><font color="white">03801</font>	      if ( !bFixedCamera )
<a name="L3802"><font color="white">03802</font>	      {
<a name="L3803"><font color="white">03803</font>	        FindGoodView();
<a name="L3804"><font color="white">03804</font>	        bBehindView = true;
<a name="L3805"><font color="white">03805</font>	      }
<a name="L3806"><font color="white">03806</font>	      SetTimer(1.5, false);
<a name="L3807"><font color="white">03807</font>	      SetPhysics(PHYS_None);
<a name="L3808"><font color="white">03808</font>	      ForEach DynamicActors(class'Pawn', P)
<a name="L3809"><font color="white">03809</font>	      {
<a name="L3810"><font color="white">03810</font>	        P.Velocity = vect(0,0,0);
<a name="L3811"><font color="white">03811</font>	        P.SetPhysics(PHYS_None);
<a name="L3812"><font color="white">03812</font>	      }
<a name="L3813"><font color="white">03813</font>	    }
<a name="L3814"><font color="white">03814</font>	begin:
<a name="L3815"><font color="white">03815</font>	      if ( !Level.bLonePlayer || XIIIGameInfo(Level.Game).XIIIEndGameType==4)
<a name="L3816"><font color="white">03816</font>			  stop;
<a name="L3817"><font color="white">03817</font>		  Sleep(4);
<a name="L3818"><font color="white">03818</font>	      ConsoleCommand(&quot;ShowTheMenu &quot;$self);
<a name="L3819"><font color="white">03819</font>	}
<a name="L3820"><font color="white">03820</font>	
<a name="L3821"><font color="white">03821</font>	//_____________________________________________________________________________
<a name="L3822"><font color="white">03822</font>	state GameEndedDeath Extends GameEnded
<a name="L3823"><font color="white">03823</font>	{
<a name="L3824"><font color="white">03824</font>	    event PlayerTick(float dT)
<a name="L3825"><font color="white">03825</font>	    {
<a name="L3826"><font color="white">03826</font>	      DeltaT = dT;
<a name="L3827"><font color="white">03827</font>	//      Log(&quot;DeltaT=&quot;$DeltaT);
<a name="L3828"><font color="white">03828</font>	      Pawn.region.Zone.FlashEffectDesc.LayerBrightness = min(255, Pawn.region.Zone.FlashEffectDesc.LayerBrightness + DeltaT*200.0);
<a name="L3829"><font color="white">03829</font>	      Pawn.region.Zone.FlashEffectDesc.Brightness = max(10, Pawn.region.Zone.FlashEffectDesc.Brightness - DeltaT*0.05);
<a name="L3830"><font color="white">03830</font>	    }
<a name="L3831"><font color="white">03831</font>	//      Global.PlayerCalcView(A, vGameEndedCamLoc, rGameEndedCamRot);
<a name="L3832"><font color="white">03832</font>	    event PlayerCalcView(out actor ViewActor, out vector CameraLocation, out rotator CameraRotation )
<a name="L3833"><font color="white">03833</font>	    {
<a name="L3834"><font color="white">03834</font>	      Local vector TargetCamLoc;
<a name="L3835"><font color="white">03835</font>	
<a name="L3836"><font color="white">03836</font>	      TargetCamLoc = Pawn.Location - Pawn.CollisionHeight * 0.75 * vect(0,0,1);
<a name="L3837"><font color="white">03837</font>	
<a name="L3838"><font color="white">03838</font>	      if (rGameEndedCamRot.Pitch &lt;= 15500)
<a name="L3839"><font color="white">03839</font>	        rGameEndedCamRot.Pitch = max(0, rGameEndedCamRot.Pitch - (DeltaT * 300.0));
<a name="L3840"><font color="white">03840</font>	//        rGameEndedCamRot.Pitch = max(0, rGameEndedCamRot.Pitch*0.97);
<a name="L3841"><font color="white">03841</font>	      else if (rGameEndedCamRot.Pitch &gt;= 50000)
<a name="L3842"><font color="white">03842</font>	        rGameEndedCamRot.Pitch = min(65535, rGameEndedCamRot.Pitch + (DeltaT * 300.0));
<a name="L3843"><font color="white">03843</font>	//        rGameEndedCamRot.Pitch = min(65535, rGameEndedCamRot.Pitch*1.007);
<a name="L3844"><font color="white">03844</font>	
<a name="L3845"><font color="white">03845</font>	      rGameEndedCamRot.Roll += 150.0 * (DeltaT*30.0) * iGameEndedRandEffect;
<a name="L3846"><font color="white">03846</font>	      if ( iGameEndedRandEffect &gt; 0 )
<a name="L3847"><font color="white">03847</font>	        rGameEndedCamRot.Roll = min(rGameEndedCamRot.Roll, 12000);
<a name="L3848"><font color="white">03848</font>	      else
<a name="L3849"><font color="white">03849</font>	        rGameEndedCamRot.Roll = max(rGameEndedCamRot.Roll, -12000);
<a name="L3850"><font color="white">03850</font>	      vGameEndedCamLoc = (vGameEndedCamLoc*45.0*(DeltaT*30.0) + TargetCamLoc)/(45.0*(DeltaT*30.0)+1);
<a name="L3851"><font color="white">03851</font>	
<a name="L3852"><font color="white">03852</font>	      ViewActor = ViewTarget;
<a name="L3853"><font color="white">03853</font>	      CameraLocation = vGameEndedCamLoc;
<a name="L3854"><font color="white">03854</font>	      CameraRotation = rGameEndedCamRot;
<a name="L3855"><font color="white">03855</font>	    }
<a name="L3856"><font color="white">03856</font>	
<a name="L3857"><font color="white">03857</font>	    function BeginState()
<a name="L3858"><font color="white">03858</font>	    {
<a name="L3859"><font color="white">03859</font>	      Log(&quot;GameEndedDeath BeginState&quot;);
<a name="L3860"><font color="white">03860</font>	      Pawn.region.Zone.FlashEffectDesc.IsActivated = true;
<a name="L3861"><font color="white">03861</font>	      Pawn.region.Zone.FlashEffectDesc.NoGrey = true;
<a name="L3862"><font color="white">03862</font>	      Pawn.region.Zone.FlashEffectDesc.Contrast = 255;
<a name="L3863"><font color="white">03863</font>	      Pawn.region.Zone.FlashEffectDesc.LayerBrightness = 0;
<a name="L3864"><font color="white">03864</font>	      Pawn.region.Zone.FlashEffectDesc.Brightness = 128;
<a name="L3865"><font color="white">03865</font>	      Pawn.region.Zone.FlashEffectDesc.LayerColor = class'canvas'.static.makecolor(255,0,0,0);
<a name="L3866"><font color="white">03866</font>	      DeltaT = 1.0/30.0;  // init to 30 fps
<a name="L3867"><font color="white">03867</font>	      enable('Tick');
<a name="L3868"><font color="white">03868</font>	      bStasis = false;
<a name="L3869"><font color="white">03869</font>	//      SetTimer(1.5, false);
<a name="L3870"><font color="white">03870</font>	//      Log(&quot;GameEndedDeath BeginState&quot;);
<a name="L3871"><font color="white">03871</font>	    } // dont replay the GameEnded BeginState()
<a name="L3872"><font color="white">03872</font>	/*
<a name="L3873"><font color="white">03873</font>	    event Timer()
<a name="L3874"><font color="white">03874</font>	    {
<a name="L3875"><font color="white">03875</font>				ShakeView(5.0, 300, vect(0,0,10), 120000, vect(50,50,50), 3);
<a name="L3876"><font color="white">03876</font>	    }
<a name="L3877"><font color="white">03877</font>	*/
<a name="L3878"><font color="white">03878</font>	}
<a name="L3879"><font color="white">03879</font>	
<a name="L3880"><font color="white">03880</font>	//_____________________________________________________________________________
<a name="L3881"><font color="white">03881</font>	state GameEndedDrown Extends GameEnded
<a name="L3882"><font color="white">03882</font>	{
<a name="L3883"><font color="white">03883</font>	//      Global.PlayerCalcView(A, vGameEndedCamLoc, rGameEndedCamRot);
<a name="L3884"><font color="white">03884</font>	    event PlayerCalcView(out actor ViewActor, out vector CameraLocation, out rotator CameraRotation )
<a name="L3885"><font color="white">03885</font>	    {
<a name="L3886"><font color="white">03886</font>	      Local vector TargetCamLoc;
<a name="L3887"><font color="white">03887</font>	
<a name="L3888"><font color="white">03888</font>	      TargetCamLoc = Pawn.Location; // - Pawn.CollisionHeight * 0.8 * vect(0,0,1);
<a name="L3889"><font color="white">03889</font>	
<a name="L3890"><font color="white">03890</font>	//      if ( (rGameEndedCamRot.Pitch &gt; 15500) &amp;&amp; (rGameEndedCamRot.Pitch &lt; 50000))
<a name="L3891"><font color="white">03891</font>	      if (rGameEndedCamRot.Pitch &lt;= 15500)
<a name="L3892"><font color="white">03892</font>	        rGameEndedCamRot.Pitch = min(15500, rGameEndedCamRot.Pitch + 300);
<a name="L3893"><font color="white">03893</font>	      else if (rGameEndedCamRot.Pitch &gt;= 50000)
<a name="L3894"><font color="white">03894</font>	      {
<a name="L3895"><font color="white">03895</font>	        rGameEndedCamRot.Pitch = rGameEndedCamRot.Pitch + 300;
<a name="L3896"><font color="white">03896</font>	        rGameEndedCamRot.Pitch = rGameEndedCamRot.Pitch &amp; 65535;
<a name="L3897"><font color="white">03897</font>	      }
<a name="L3898"><font color="white">03898</font>	
<a name="L3899"><font color="white">03899</font>	/*
<a name="L3900"><font color="white">03900</font>	      rGameEndedCamRot.Roll += 160*iGameEndedRandEffect;
<a name="L3901"><font color="white">03901</font>	      if ( iGameEndedRandEffect &gt; 0 )
<a name="L3902"><font color="white">03902</font>	        rGameEndedCamRot.Roll = min(rGameEndedCamRot.Roll, 12000);
<a name="L3903"><font color="white">03903</font>	      else
<a name="L3904"><font color="white">03904</font>	        rGameEndedCamRot.Roll = max(rGameEndedCamRot.Roll, -12000);
<a name="L3905"><font color="white">03905</font>	*/
<a name="L3906"><font color="white">03906</font>	
<a name="L3907"><font color="white">03907</font>	      vGameEndedCamLoc = (vGameEndedCamLoc*24.0 + TargetCamLoc)/25.0;
<a name="L3908"><font color="white">03908</font>	
<a name="L3909"><font color="white">03909</font>	      ViewActor = ViewTarget;
<a name="L3910"><font color="white">03910</font>	      CameraLocation = vGameEndedCamLoc;
<a name="L3911"><font color="white">03911</font>	      CameraRotation = rGameEndedCamRot;
<a name="L3912"><font color="white">03912</font>	    }
<a name="L3913"><font color="white">03913</font>	
<a name="L3914"><font color="white">03914</font>	    function BeginState()
<a name="L3915"><font color="white">03915</font>	    {
<a name="L3916"><font color="white">03916</font>	//      Log(&quot;GameEndedDeath BeginState&quot;);
<a name="L3917"><font color="white">03917</font>	    } // dont replay the GameEnded BeginState()
<a name="L3918"><font color="white">03918</font>	}
<a name="L3919"><font color="white">03919</font>	
<a name="L3920"><font color="white">03920</font>	//_____________________________________________________________________________
<a name="L3921"><font color="white">03921</font>	state GameEndedFalling Extends GameEnded
<a name="L3922"><font color="white">03922</font>	{
<a name="L3923"><font color="white">03923</font>	    event PlayerCalcView(out actor ViewActor, out vector CameraLocation, out rotator CameraRotation )
<a name="L3924"><font color="white">03924</font>	    {
<a name="L3925"><font color="white">03925</font>	      ViewActor = ViewTarget;
<a name="L3926"><font color="white">03926</font>	      CameraLocation = vGameEndedCamLoc;
<a name="L3927"><font color="white">03927</font>	      CameraRotation = Rotator(ViewActor.Location - vGameEndedCamLoc);
<a name="L3928"><font color="white">03928</font>	    }
<a name="L3929"><font color="white">03929</font>	
<a name="L3930"><font color="white">03930</font>	    function BeginState()
<a name="L3931"><font color="white">03931</font>	    {
<a name="L3932"><font color="white">03932</font>	//      Log(&quot;GameEndedFalling BeginState&quot;);
<a name="L3933"><font color="white">03933</font>	      FilterColorWanted=class'canvas'.static.makecolor(0,0,0,0);
<a name="L3934"><font color="white">03934</font>	      FilterColorSpeed=0.5;
<a name="L3935"><font color="white">03935</font>	/*
<a name="L3936"><font color="white">03936</font>	var color FilterColor;                // La couleur courante.
<a name="L3937"><font color="white">03937</font>	var color FilterColorWanted;          // La couleur vers laquelle le moteur doit converger.
<a name="L3938"><font color="white">03938</font>	var float FilterColorSpeed;           // La vitesse de convergence.
<a name="L3939"><font color="white">03939</font>	*/
<a name="L3940"><font color="white">03940</font>	    } // dont replay the GameEnded BeginState()
<a name="L3941"><font color="white">03941</font>	
<a name="L3942"><font color="white">03942</font>	    function EndState()
<a name="L3943"><font color="white">03943</font>	    {
<a name="L3944"><font color="white">03944</font>	      FilterColorWanted=class'canvas'.static.makecolor(128,128,128,128);
<a name="L3945"><font color="white">03945</font>	      FilterColorSpeed=10.0;
<a name="L3946"><font color="white">03946</font>	    }
<a name="L3947"><font color="white">03947</font>	
<a name="L3948"><font color="white">03948</font>	    Event bool NotifyLanded(vector HitNorm)
<a name="L3949"><font color="white">03949</font>	    {
<a name="L3950"><font color="white">03950</font>	      OnoF.OnoEnd();
<a name="L3951"><font color="white">03951</font>	      FilterColor=class'canvas'.static.makecolor(200,0,0,64);
<a name="L3952"><font color="white">03952</font>	      FilterColorWanted=class'canvas'.static.makecolor(200,0,0,64);
<a name="L3953"><font color="white">03953</font>	      Settimer(0.10, false);
<a name="L3954"><font color="white">03954</font>	      return true;
<a name="L3955"><font color="white">03955</font>	    }
<a name="L3956"><font color="white">03956</font>	
<a name="L3957"><font color="white">03957</font>	    event Timer()
<a name="L3958"><font color="white">03958</font>	    {
<a name="L3959"><font color="white">03959</font>	      FilterColorWanted=class'canvas'.static.makecolor(0,0,0,0);
<a name="L3960"><font color="white">03960</font>	      FilterColorSpeed=5.0;
<a name="L3961"><font color="white">03961</font>	    }
<a name="L3962"><font color="white">03962</font>	}
<a name="L3963"><font color="white">03963</font>	
<a name="L3964"><font color="white">03964</font>	//_____________________________________________________________________________
<a name="L3965"><font color="white">03965</font>	// the mission is a success, play video if available then travel
<a name="L3966"><font color="white">03966</font>	state GameEndedSuccess extends GameEnded
<a name="L3967"><font color="white">03967</font>	{
<a name="L3968"><font color="white">03968</font>	    event BeginState()
<a name="L3969"><font color="white">03969</font>	    {
<a name="L3970"><font color="white">03970</font>	//      Log(&quot;GameEndedSucess BeginState&quot;);
<a name="L3971"><font color="white">03971</font>	      SetTimer(3.0, false);
<a name="L3972"><font color="white">03972</font>	    }
<a name="L3973"><font color="white">03973</font>	    event Timer()
<a name="L3974"><font color="white">03974</font>	    {
<a name="L3975"><font color="white">03975</font>	//      Log(&quot;GameEndedSucess Timer&quot;);
<a name="L3976"><font color="white">03976</font>	      if ( (XIIIGameInfo(Level.Game).MapInfo != none) &amp;&amp; (XIIIGameInfo(Level.Game).MapInfo.EndMapVideo != &quot;&quot;) )
<a name="L3977"><font color="white">03977</font>	      { // Play video
<a name="L3978"><font color="white">03978</font>	        if ( VP == none )
<a name="L3979"><font color="white">03979</font>	          VP = new class'VideoPlayer';
<a name="L3980"><font color="white">03980</font>	        if ( VP != none )
<a name="L3981"><font color="white">03981</font>	          VP.Open(XIIIGameInfo(Level.Game).MapInfo.EndMapVideo);
<a name="L3982"><font color="white">03982</font>	        GotoState('PlayingVideo');
<a name="L3983"><font color="white">03983</font>	      }
<a name="L3984"><font color="white">03984</font>	      else
<a name="L3985"><font color="white">03985</font>	      { // travel
<a name="L3986"><font color="white">03986</font>	        GotoState('GameEndedSuccess', 'DoTravel');
<a name="L3987"><font color="white">03987</font>	      }
<a name="L3988"><font color="white">03988</font>	    }
<a name="L3989"><font color="white">03989</font>	Begin:
<a name="L3990"><font color="white">03990</font>	  Stop;
<a name="L3991"><font color="white">03991</font>	DoTravel:
<a name="L3992"><font color="white">03992</font>	//  Log(&quot;GameEndedSucess DoTravel... Sleep 0.3&quot;);
<a name="L3993"><font color="white">03993</font>	  sleep(1.0);
<a name="L3994"><font color="white">03994</font>	//  Log(&quot;GameEndedSucess DoTravel... End sleep&quot;);
<a name="L3995"><font color="white">03995</font>	  Level.ServerTravel(XIIIGameInfo(Level.Game).MapInfo.NextMapLevelWithUnr, true);
<a name="L3996"><font color="white">03996</font>	}
<a name="L3997"><font color="white">03997</font>	
<a name="L3998"><font color="white">03998</font>	//_____________________________________________________________________________
<a name="L3999"><font color="white">03999</font>	state PlayingVideo
<a name="L4000"><font color="white">04000</font>	{
<a name="L4001"><font color="white">04001</font>	    event BeginState()
<a name="L4002"><font color="white">04002</font>	    {
<a name="L4003"><font color="white">04003</font>	      KillAllSounds();
<a name="L4004"><font color="white">04004</font>	      VP.Play();
<a name="L4005"><font color="white">04005</font>	      StopAllSounds();
<a name="L4006"><font color="white">04006</font>	    }
<a name="L4007"><font color="white">04007</font>	    event PlayerTick(float dT)
<a name="L4008"><font color="white">04008</font>	    {
<a name="L4009"><font color="white">04009</font>	      if ( VP == none )
<a name="L4010"><font color="white">04010</font>	        Level.ServerTravel(XIIIGameInfo(Level.Game).MapInfo.NextMapLevelWithUnr, true);
<a name="L4011"><font color="white">04011</font>	      else
<a name="L4012"><font color="white">04012</font>	      {
<a name="L4013"><font color="white">04013</font>	        switch (VP.GetStatus())
<a name="L4014"><font color="white">04014</font>	        {
<a name="L4015"><font color="white">04015</font>	          Case 0: // End video or no play
<a name="L4016"><font color="white">04016</font>	            Log(&quot;End video or no play&quot;);
<a name="L4017"><font color="white">04017</font>	            Level.ServerTravel(XIIIGameInfo(Level.Game).MapInfo.NextMapLevelWithUnr, true);
<a name="L4018"><font color="white">04018</font>	            break;
<a name="L4019"><font color="white">04019</font>	          Case 2: // Error while playing
<a name="L4020"><font color="white">04020</font>	            Log(&quot;Error playing video&quot;);
<a name="L4021"><font color="white">04021</font>	            Level.ServerTravel(XIIIGameInfo(Level.Game).MapInfo.NextMapLevelWithUnr, true);
<a name="L4022"><font color="white">04022</font>	            break;
<a name="L4023"><font color="white">04023</font>	          Case 1: // continue playing
<a name="L4024"><font color="white">04024</font>	        }
<a name="L4025"><font color="white">04025</font>	      }
<a name="L4026"><font color="white">04026</font>	    }
<a name="L4027"><font color="white">04027</font>	    exec function Fire( optional float F );
<a name="L4028"><font color="white">04028</font>	}
<a name="L4029"><font color="white">04029</font>	
<a name="L4030"><font color="white">04030</font>	//_____________________________________________________________________________
<a name="L4031"><font color="white">04031</font>	State NoControl extends PlayerWalking
<a name="L4032"><font color="white">04032</font>	{
<a name="L4033"><font color="white">04033</font>	    ignores ReLoad, NextWeapon, PrevWeapon, cNextItem, cPrevItem, Fire, AltFire, Jump, Grab, QuickHeal;
<a name="L4034"><font color="white">04034</font>	
<a name="L4035"><font color="white">04035</font>	//    simulated event RenderOverlays( canvas C ) {}
<a name="L4036"><font color="white">04036</font>	
<a name="L4037"><font color="white">04037</font>	    event BeginState()
<a name="L4038"><font color="white">04038</font>	    {
<a name="L4039"><font color="white">04039</font>	      Pawn.bCanCrouch=false;
<a name="L4040"><font color="white">04040</font>	//      Log(&quot;NoControl Begin State&quot;);
<a name="L4041"><font color="white">04041</font>	      Super.BeginState();
<a name="L4042"><font color="white">04042</font>	      velocity=vect(0,0,0);
<a name="L4043"><font color="white">04043</font>	      if (!bMenuIsActive)
<a name="L4044"><font color="white">04044</font>	      Level.bCineFrame = true;
<a name="L4045"><font color="white">04045</font>	//      PlayerInput.bForceCrouch = true;
<a name="L4046"><font color="white">04046</font>	    }
<a name="L4047"><font color="white">04047</font>	
<a name="L4048"><font color="white">04048</font>	    event EndState()
<a name="L4049"><font color="white">04049</font>	    {
<a name="L4050"><font color="white">04050</font>	      Pawn.bCanCrouch=true;
<a name="L4051"><font color="white">04051</font>	      Level.bCineFrame = false;
<a name="L4052"><font color="white">04052</font>	      MyInteraction.TargetActor = none; // Anticrash if target actor was a breakable mover
<a name="L4053"><font color="white">04053</font>	//      Log(&quot;NoControl End State&quot;);
<a name="L4054"><font color="white">04054</font>	//      PlayerInput.bForceCrouch = false;
<a name="L4055"><font color="white">04055</font>	    }
<a name="L4056"><font color="white">04056</font>	
<a name="L4057"><font color="white">04057</font>	    function UpdateRotation(float DeltaTime, float maxPitch)
<a name="L4058"><font color="white">04058</font>	    {
<a name="L4059"><font color="white">04059</font>	      local Rotator r;
<a name="L4060"><font color="white">04060</font>	      r=Rotation;
<a name="L4061"><font color="white">04061</font>	      //		DesiredRotation=Rotation;
<a name="L4062"><font color="white">04062</font>	      ViewShake(deltaTime);
<a name="L4063"><font color="white">04063</font>	      SetRotation(r); // Force Rotation even if shaking camera
<a name="L4064"><font color="white">04064</font>	      ViewFlash(deltaTime);
<a name="L4065"><font color="white">04065</font>	    }
<a name="L4066"><font color="white">04066</font>	/*
<a name="L4067"><font color="white">04067</font>	    event Playertick(float dT)
<a name="L4068"><font color="white">04068</font>	    {
<a name="L4069"><font color="white">04069</font>	//      Log(&quot;NoControl End State&quot;);
<a name="L4070"><font color="white">04070</font>	    }
<a name="L4071"><font color="white">04071</font>	
<a name="L4072"><font color="white">04072</font>	
<a name="L4073"><font color="white">04073</font>	    event PlayerCalcView(out actor ViewActor, out vector CameraLocation, out rotator CameraRotation )
<a name="L4074"><font color="white">04074</font>	    {
<a name="L4075"><font color="white">04075</font>	      Log(&quot;NoControl PlayerCalcView&quot;);
<a name="L4076"><font color="white">04076</font>	    	ViewActor = ViewTarget;
<a name="L4077"><font color="white">04077</font>	      CameraLocation = Location;
<a name="L4078"><font color="white">04078</font>	      CameraRotation = Rotation;
<a name="L4079"><font color="white">04079</font>	    }
<a name="L4080"><font color="white">04080</font>	*/
<a name="L4081"><font color="white">04081</font>	
<a name="L4082"><font color="white">04082</font>	    function PlayerMove( float DeltaTime )
<a name="L4083"><font color="white">04083</font>	    {
<a name="L4084"><font color="white">04084</font>	      local vector X,Y,Z, NewAccel;
<a name="L4085"><font color="white">04085</font>	      local eDoubleClickDir DoubleClickMove;
<a name="L4086"><font color="white">04086</font>	      local rotator OldRotation; //, ViewRotation;
<a name="L4087"><font color="white">04087</font>	      //local float Speed2D;
<a name="L4088"><font color="white">04088</font>	      //local bool bSaveJump;
<a name="L4089"><font color="white">04089</font>	
<a name="L4090"><font color="white">04090</font>	//      Log(&quot;NoControl PlayerMove&quot;);
<a name="L4091"><font color="white">04091</font>	      GetAxes(Pawn.Rotation,X,Y,Z);
<a name="L4092"><font color="white">04092</font>	
<a name="L4093"><font color="white">04093</font>	      // Update acceleration.
<a name="L4094"><font color="white">04094</font>	      NewAccel = vect(0,0,0);
<a name="L4095"><font color="white">04095</font>	//      DoubleClickMove = PlayerInput.CheckForDoubleClickMove(DeltaTime);
<a name="L4096"><font color="white">04096</font>	
<a name="L4097"><font color="white">04097</font>	      GroundPitch = 0;
<a name="L4098"><font color="white">04098</font>	      bSnaptoLevel = false;
<a name="L4099"><font color="white">04099</font>	      bCenterView = false;
<a name="L4100"><font color="white">04100</font>	      OldRotation = Rotation;
<a name="L4101"><font color="white">04101</font>	      // MLK: Otherwise the player moves while in menu
<a name="L4102"><font color="white">04102</font>	      if (!(Left(Level.GetLocalURL(), 7) ~= &quot;mapmenu&quot;))
<a name="L4103"><font color="white">04103</font>	  		UpdateRotation(DeltaTime, 1);
<a name="L4104"><font color="white">04104</font>	//      ViewShake(deltaTime);
<a name="L4105"><font color="white">04105</font>	//      ViewFlash(deltaTime);
<a name="L4106"><font color="white">04106</font>	
<a name="L4107"><font color="white">04107</font>	      if ( Pawn.Physics != PHYS_Falling )
<a name="L4108"><font color="white">04108</font>	      {
<a name="L4109"><font color="white">04109</font>	        Pawn.bWantsToCrouch = PlayerInput.bForceCrouch;
<a name="L4110"><font color="white">04110</font>	        Pawn.ShouldCrouch(PlayerInput.bForceCrouch);
<a name="L4111"><font color="white">04111</font>	      }
<a name="L4112"><font color="white">04112</font>	
<a name="L4113"><font color="white">04113</font>	      if ( Role &lt; ROLE_Authority ) // then save this move and replicate it
<a name="L4114"><font color="white">04114</font>	        ReplicateMove(DeltaTime, NewAccel, DoubleClickMove, OldRotation - Rotation);
<a name="L4115"><font color="white">04115</font>	      else
<a name="L4116"><font color="white">04116</font>	        ProcessMove(DeltaTime, NewAccel, DoubleClickMove, OldRotation - Rotation);
<a name="L4117"><font color="white">04117</font>	      bPressedJump = false;
<a name="L4118"><font color="white">04118</font>	    }
<a name="L4119"><font color="white">04119</font>	}
<a name="L4120"><font color="white">04120</font>	
<a name="L4121"><font color="white">04121</font>	//_____________________________________________________________________________
<a name="L4122"><font color="white">04122</font>	// waiting for first display to give controls to the player (else can trigger unwanted/unseen events)
<a name="L4123"><font color="white">04123</font>	// by moving while engine init (w/out screen refresh)
<a name="L4124"><font color="white">04124</font>	state WaitForFirstDisplay
<a name="L4125"><font color="white">04125</font>	{
<a name="L4126"><font color="white">04126</font>	    simulated event RenderOverLays(Canvas C)
<a name="L4127"><font color="white">04127</font>	    {
<a name="L4128"><font color="white">04128</font>	      if ( !bOkForMoving )
<a name="L4129"><font color="white">04129</font>	      {
<a name="L4130"><font color="white">04130</font>	        bOkForMoving = true;
<a name="L4131"><font color="white">04131</font>	        SetTimer(0.2, false);
<a name="L4132"><font color="white">04132</font>	      }
<a name="L4133"><font color="white">04133</font>	    }
<a name="L4134"><font color="white">04134</font>	    simulated event Timer()
<a name="L4135"><font color="white">04135</font>	    {
<a name="L4136"><font color="white">04136</font>	      EnterStartState();
<a name="L4137"><font color="white">04137</font>	    }
<a name="L4138"><font color="white">04138</font>	    function UpdateRotation(float DeltaTime, float maxPitch);
<a name="L4139"><font color="white">04139</font>	    function PlayerMove( float DeltaTime );
<a name="L4140"><font color="white">04140</font>	}
<a name="L4141"><font color="white">04141</font>	
<a name="L4142"><font color="white">04142</font>	
<a name="L4143"><font color="white">04143</font>	//_____________________________________________________________________________
<a name="L4144"><font color="white">04144</font>	/*State NoRotation extends PlayerWalking
<a name="L4145"><font color="white">04145</font>	{
<a name="L4146"><font color="white">04146</font>	    ignores ReLoad, NextWeapon, PrevWeapon, cNextItem, cPrevItem, Fire, AltFire, Jump, Grab, QuickHeal;
<a name="L4147"><font color="white">04147</font>	
<a name="L4148"><font color="white">04148</font>	    simulated event RenderOverlays( canvas C ) {}
<a name="L4149"><font color="white">04149</font>	
<a name="L4150"><font color="white">04150</font>	    event BeginState()
<a name="L4151"><font color="white">04151</font>	    {
<a name="L4152"><font color="white">04152</font>	//      Log(&quot;NoControl Begin State&quot;);
<a name="L4153"><font color="white">04153</font>	      Super.BeginState();
<a name="L4154"><font color="white">04154</font>	      velocity=vect(0,0,0);
<a name="L4155"><font color="white">04155</font>	    }
<a name="L4156"><font color="white">04156</font>	
<a name="L4157"><font color="white">04157</font>	    event EndState()
<a name="L4158"><font color="white">04158</font>	    {
<a name="L4159"><font color="white">04159</font>	      MyInteraction.TargetActor = none; // Anticrash if target actor was a breakable mover
<a name="L4160"><font color="white">04160</font>	//      Log(&quot;NoControl End State&quot;);
<a name="L4161"><font color="white">04161</font>	    }
<a name="L4162"><font color="white">04162</font>	
<a name="L4163"><font color="white">04163</font>	    function UpdateRotation(float DeltaTime, float maxPitch)
<a name="L4164"><font color="white">04164</font>	    {
<a name="L4165"><font color="white">04165</font>			LOCAL Rotator r;
<a name="L4166"><font color="white">04166</font>			r=Rotation;
<a name="L4167"><font color="white">04167</font>			ViewShake(deltaTime);
<a name="L4168"><font color="white">04168</font>			SetRotation(r); // Force Rotation even if shaking camera
<a name="L4169"><font color="white">04169</font>			ViewFlash(deltaTime);
<a name="L4170"><font color="white">04170</font>	    }
<a name="L4171"><font color="white">04171</font>	}*/
<a name="L4172"><font color="white">04172</font>	//_____________________________________________________________________________
<a name="L4173"><font color="white">04173</font>	State NoMove extends PlayerWalking
<a name="L4174"><font color="white">04174</font>	{
<a name="L4175"><font color="white">04175</font>	    ignores ReLoad, NextWeapon, PrevWeapon, cNextItem, cPrevItem, Fire, AltFire, Jump, Grab, QuickHeal;
<a name="L4176"><font color="white">04176</font>	    event BeginState()
<a name="L4177"><font color="white">04177</font>	    {
<a name="L4178"><font color="white">04178</font>	      Super.BeginState();
<a name="L4179"><font color="white">04179</font>	      velocity=vect(0,0,0);
<a name="L4180"><font color="white">04180</font>	  	  rGameEndedCamRot=Rotation;
<a name="L4181"><font color="white">04181</font>	      Pawn.bCanCrouch=false;
<a name="L4182"><font color="white">04182</font>	    }
<a name="L4183"><font color="white">04183</font>	    event EndState()
<a name="L4184"><font color="white">04184</font>	    {
<a name="L4185"><font color="white">04185</font>	      MyInteraction.TargetActor = none; // Anticrash if target actor was a breakable mover
<a name="L4186"><font color="white">04186</font>	      Pawn.bCanCrouch=true;
<a name="L4187"><font color="white">04187</font>	//      Log(&quot;NoMove End State&quot;);
<a name="L4188"><font color="white">04188</font>	    }
<a name="L4189"><font color="white">04189</font>	
<a name="L4190"><font color="white">04190</font>	    function PlayerMove( float DeltaTime )
<a name="L4191"><font color="white">04191</font>	    {
<a name="L4192"><font color="white">04192</font>	      local vector NewAccel;
<a name="L4193"><font color="white">04193</font>	      local eDoubleClickDir DoubleClickMove;
<a name="L4194"><font color="white">04194</font>	      local rotator OldRotation,r;
<a name="L4195"><font color="white">04195</font>	
<a name="L4196"><font color="white">04196</font>	      NewAccel = vect(0,0,0);
<a name="L4197"><font color="white">04197</font>	
<a name="L4198"><font color="white">04198</font>	      GroundPitch = 0;
<a name="L4199"><font color="white">04199</font>	      bSnaptoLevel = false;
<a name="L4200"><font color="white">04200</font>	      bCenterView = false;
<a name="L4201"><font color="white">04201</font>	      OldRotation = Rotation;
<a name="L4202"><font color="white">04202</font>	  	  r=Rotation-rGameEndedCamRot;
<a name="L4203"><font color="white">04203</font>	
<a name="L4204"><font color="white">04204</font>	      DesiredRotation = r; //save old rotation
<a name="L4205"><font color="white">04205</font>	      r.Yaw += 32.0 * DeltaTime * aTurn;
<a name="L4206"><font color="white">04206</font>	      r.Pitch += 32.0 * DeltaTime * aLookUp;
<a name="L4207"><font color="white">04207</font>	
<a name="L4208"><font color="white">04208</font>	      r.Pitch = r.Pitch &amp; 65535;
<a name="L4209"><font color="white">04209</font>	      if ((r.Pitch &gt; 15500) &amp;&amp; (r.Pitch &lt; 50000))
<a name="L4210"><font color="white">04210</font>	      {
<a name="L4211"><font color="white">04211</font>	        if (aLookUp &gt; 0)
<a name="L4212"><font color="white">04212</font>	          r.Pitch = 15500;
<a name="L4213"><font color="white">04213</font>	        else
<a name="L4214"><font color="white">04214</font>	          r.Pitch = 50000;
<a name="L4215"><font color="white">04215</font>	      }
<a name="L4216"><font color="white">04216</font>	
<a name="L4217"><font color="white">04217</font>	      r.yaw=Clamp(((r.yaw+32768)&amp;65535)-32768,-6144,6144);
<a name="L4218"><font color="white">04218</font>	      r.Roll=0;
<a name="L4219"><font color="white">04219</font>	      r.Pitch=Clamp(((r.Pitch+32768)&amp;65535)-32768,-3072,3072);
<a name="L4220"><font color="white">04220</font>	      SetRotation(r+rGameEndedCamRot);
<a name="L4221"><font color="white">04221</font>	      ViewShake(deltaTime);
<a name="L4222"><font color="white">04222</font>	      ViewFlash(deltaTime);
<a name="L4223"><font color="white">04223</font>	
<a name="L4224"><font color="white">04224</font>	      if ( Role &lt; ROLE_Authority ) // then save this move and replicate it
<a name="L4225"><font color="white">04225</font>	        ReplicateMove(DeltaTime, NewAccel, DoubleClickMove, OldRotation - Rotation);
<a name="L4226"><font color="white">04226</font>	      else
<a name="L4227"><font color="white">04227</font>	        ProcessMove(DeltaTime, NewAccel, DoubleClickMove, OldRotation - Rotation);
<a name="L4228"><font color="white">04228</font>	      bPressedJump = false;
<a name="L4229"><font color="white">04229</font>	    }
<a name="L4230"><font color="white">04230</font>	}
<a name="L4231"><font color="white">04231</font>	
<a name="L4232"><font color="white">04232</font>	//_____________________________________________________________________________
<a name="L4233"><font color="white">04233</font>	simulated State Kicked
<a name="L4234"><font color="white">04234</font>	{
<a name="L4235"><font color="white">04235</font>	    ignores ReLoad, NextWeapon, PrevWeapon, cNextItem, cPrevItem, Fire, AltFire, Jump, Grab, QuickHeal;
<a name="L4236"><font color="white">04236</font>	    simulated event BeginState()
<a name="L4237"><font color="white">04237</font>	    {
<a name="L4238"><font color="white">04238</font>	      //Log(&quot;KICKED&quot;@self@&quot;BeginState&quot;);
<a name="L4239"><font color="white">04239</font>	    }
<a name="L4240"><font color="white">04240</font>	    simulated event EndState()
<a name="L4241"><font color="white">04241</font>	    { // kicked are not allowed to go out of this state
<a name="L4242"><font color="white">04242</font>	      //Log(&quot;KICKED&quot;@self@&quot;EndState&quot;);
<a name="L4243"><font color="white">04243</font>	      SetTimer3(0.01, false);
<a name="L4244"><font color="white">04244</font>	    }
<a name="L4245"><font color="white">04245</font>	    function UpdateRotation(float DeltaTime, float maxPitch);
<a name="L4246"><font color="white">04246</font>	    function PlayerMove( float DeltaTime );
<a name="L4247"><font color="white">04247</font>	Begin:
<a name="L4248"><font color="white">04248</font>	  Sleep(4);
<a name="L4249"><font color="white">04249</font>	}
<a name="L4250"><font color="white">04250</font>	
<a name="L4251"><font color="white">04251</font>	//_____________________________________________________________________________
<a name="L4252"><font color="white">04252</font>	// use to force player in Kicked State (else will go to dead after kicked
<a name="L4253"><font color="white">04253</font>	simulated event timer3()
<a name="L4254"><font color="white">04254</font>	{
<a name="L4255"><font color="white">04255</font>	//    Log(&quot;KICKED&quot;@self@&quot;timer3&quot;);
<a name="L4256"><font color="white">04256</font>	    GotoState('Kicked');
<a name="L4257"><font color="white">04257</font>	}
<a name="L4258"><font color="white">04258</font>	
<a name="L4259"><font color="white">04259</font>	FUNCTION ClientSetHUD(class&lt;HUD&gt; newHUDType, class&lt;Scoreboard&gt; newScoringType)
<a name="L4260"><font color="white">04260</font>	{
<a name="L4261"><font color="white">04261</font>		SUPER.ClientSetHUD( newHUDType, newScoringType);
<a name="L4262"><font color="white">04262</font>	
<a name="L4263"><font color="white">04263</font>		if ( int(ConsoleCommand(&quot;Get GameInfo GoreLevel&quot;) ) != 0 )
<a name="L4264"><font color="white">04264</font>	    {
<a name="L4265"><font color="white">04265</font>	// PARENTAL LOCL ON
<a name="L4266"><font color="white">04266</font>			ReplaceATextureByAnOther( Texture'XIIICine.effets.blodspotA', Texture'XIIICine.effets.blodspotAPL' );
<a name="L4267"><font color="white">04267</font>			ReplaceATextureByAnOther( Texture'XIIICine.effets.bloodheadshotA', Texture'XIIICine.effets.bloodheadshotAPL' );
<a name="L4268"><font color="white">04268</font>			ReplaceATextureByAnOther( Texture'XIIICine.effets.bloodprojM', Texture'XIIICine.effets.bloodprojMPL' );
<a name="L4269"><font color="white">04269</font>			ReplaceATextureByAnOther( Texture'XIIICine.effets.goutteblood', Texture'XIIICine.effets.gouttebloodPL' );
<a name="L4270"><font color="white">04270</font>			ReplaceATextureByAnOther( Texture'XIIICine.effets.jikleblood', Texture'XIIICine.effets.jiklebloodPL' );
<a name="L4271"><font color="white">04271</font>			ReplaceATextureByAnOther( Texture'XIIICine.effets.projectionblodA', Texture'XIIICine.effets.projectionblodAPL' );
<a name="L4272"><font color="white">04272</font>			ReplaceATextureByAnOther( Texture'XIIICine.effets.vignetteblood', Texture'XIIICine.effets.vignettebloodPL' );
<a name="L4273"><font color="white">04273</font>		}
<a name="L4274"><font color="white">04274</font>		else
<a name="L4275"><font color="white">04275</font>		{
<a name="L4276"><font color="white">04276</font>	// PARENTAL LOCL OFF
<a name="L4277"><font color="white">04277</font>			ReplaceATextureByAnOther( Texture'XIIICine.effets.blodspotAPL', Texture'XIIICine.effets.blodspotA' );
<a name="L4278"><font color="white">04278</font>			ReplaceATextureByAnOther( Texture'XIIICine.effets.bloodheadshotAPL', Texture'XIIICine.effets.bloodheadshotA' );
<a name="L4279"><font color="white">04279</font>			ReplaceATextureByAnOther( Texture'XIIICine.effets.bloodprojMPL', Texture'XIIICine.effets.bloodprojM' );
<a name="L4280"><font color="white">04280</font>			ReplaceATextureByAnOther( Texture'XIIICine.effets.gouttebloodPL', Texture'XIIICine.effets.goutteblood' );
<a name="L4281"><font color="white">04281</font>			ReplaceATextureByAnOther( Texture'XIIICine.effets.jiklebloodPL', Texture'XIIICine.effets.jikleblood' );
<a name="L4282"><font color="white">04282</font>			ReplaceATextureByAnOther( Texture'XIIICine.effets.projectionblodAPL', Texture'XIIICine.effets.projectionblodA' );
<a name="L4283"><font color="white">04283</font>			ReplaceATextureByAnOther( Texture'XIIICine.effets.vignettebloodPL', Texture'XIIICine.effets.vignetteblood' );
<a name="L4284"><font color="white">04284</font>		}
<a name="L4285"><font color="white">04285</font>	
<a name="L4286"><font color="white">04286</font>	
<a name="L4287"><font color="white">04287</font>	}
<a name="L4288"><font color="white">04288</font>	
<a name="L4289"><font color="white">04289</font>	
<a name="L4290"><font color="white">04290</font>	defaultproperties
<a name="L4291"><font color="white">04291</font>	{
<a name="L4292"><font color="white">04292</font>	     bWeaponMode=True
<a name="L4293"><font color="white">04293</font>	     bWaitForWeaponMode=True
<a name="L4294"><font color="white">04294</font>	     bAltZoomingSystem=True
<a name="L4295"><font color="white">04295</font>	     bFixedCrosshair=True
<a name="L4296"><font color="white">04296</font>	     hCLimbDoorSound=Sound'XIIIsound.SpecActions.LeonClimb1'
<a name="L4297"><font color="white">04297</font>	     hEndClimbDoorSound=Sound'XIIIsound.SpecActions.LeonClimb2'
<a name="L4298"><font color="white">04298</font>	     hCamViewBeginUseSound=Sound'XIIIsound.Items.CameraOn'
<a name="L4299"><font color="white">04299</font>	     hCamViewInUseSound=Sound'XIIIsound.Items.CameraRumble'
<a name="L4300"><font color="white">04300</font>	     hEndClimbLadderSound=Sound'XIIIsound.SpecActions__LadderClimb.LadderClimb__hEndClimbLadder'
<a name="L4301"><font color="white">04301</font>	     MyInteractionClass=&quot;XIII.XIIIPlayerInteraction&quot;
<a name="L4302"><font color="white">04302</font>	     hTyrolStartSound=Sound'XIIIsound.Movers__TyrolCable.TyrolCable__hCableStart'
<a name="L4303"><font color="white">04303</font>	     hTyrolEndSound=Sound'XIIIsound.Movers__TyrolCable.TyrolCable__hCableEnded'
<a name="L4304"><font color="white">04304</font>	     iCrosshairMode=1
<a name="L4305"><font color="white">04305</font>	     fCrosshairSize=2.000000
<a name="L4306"><font color="white">04306</font>	     fLookSpeed=1.000000
<a name="L4307"><font color="white">04307</font>	     bUseRumble=True
<a name="L4308"><font color="white">04308</font>	     CheatClass=Class'XIII.XIIICheatManager'
<a name="L4309"><font color="white">04309</font>	     PlayerReplicationInfoClass=Class'XIII.XIIIPlayerReplicationInfo'
<a name="L4310"><font color="white">04310</font>	     bHasRollOff=False
<a name="L4311"><font color="white">04311</font>	     bHasPosition=False
<a name="L4312"><font color="white">04312</font>	}
</code></pre></font></td></tr></table></center>
<hr/><center><FONT SIZE="-1">
End Source Code</FONT>
</center><hr/>
</BODY>
</HTML>
