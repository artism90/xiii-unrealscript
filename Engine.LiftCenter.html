<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Frameset//EN""http://www.w3.org/TR/REC-html40/frameset.dtd">
<HTML>
<HEAD>
<!--Generated by UnDox 1.0.3 Copyright (c) 2000 Epic Games. UnDox created and mainteained by Bruce Shankle - bruce@epicgames.com -->
<TITLE>
Engine.LiftCenter
</TITLE>
<LINK REL ="stylesheet" TYPE="text/css" HREF="stylesheet.css" TITLE="Style">
</HEAD>
<BODY BGCOLOR="white" vlink="#0000FF" alink="#0000FF">
<H2>
<FONT SIZE="-1">
Engine</FONT>
<BR>
Class  LiftCenter</H2>
<FONT SIZE="-1">source: C:\XIII\Engine\Classes\LiftCenter.uc</FONT>
<PRE>
<a href="Core.Object.html">Core.Object</a>
   |
   +--<a href="Engine.Actor.html">Engine.Actor</a>
      |
      +--<a href="Engine.NavigationPoint.html">Engine.NavigationPoint</a>
         |
         +--<b>Engine.LiftCenter</b>
</PRE>
<TABLE><TR><TD><B>Direct Known Subclasses:</B><b>None</b>
</TD></TR></TABLE>
<hr/>class <b>LiftCenter</b><br>
extends <a href="Engine.NavigationPoint.html">Engine.NavigationPoint</a>
<p/>
<xmp>//=============================================================================
// LiftCenter.
//=============================================================================
</xmp><br><TABLE BORDER="1" CELLPADDING="3" CELLSPACING="0" WIDTH="100%">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TD COLSPAN=2><FONT SIZE="+2">
<B>Variables</B></FONT></TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;vector</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L14">LiftOffset </A></B></CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   starting vector between MyLift location and LiftCenter location </TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;name</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L9">LiftTag </A></B></CODE></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;name</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L11">LiftTrigger </A></B></CODE></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;float</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L13">MaxDist2D </A></B></CODE></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<a href="Engine.Trigger.html">Trigger</a></CODE></FONT></TD>
<TD><CODE><B><A HREF="#L12">RecommendedTrigger </A></B></CODE></TD></TR>
</TD></TR><TABLE><br>
<A NAME="function_summary"/>
<TABLE BORDER="1" CELLPADDING="3" CELLSPACING="0" WIDTH="100%">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TD COLSPAN=2><FONT SIZE="+2">
<B>Function Summary</B></FONT></TD>
</TR>
<br><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L16">PostBeginPlay</A></B>()</CODE></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;bool</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L73">ProceedWithMove</A></B>(<a href="Engine.Pawn.html">Pawn</a> Other)</CODE></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<a href="Engine.Actor.html">Actor</a></CODE></FONT></TD>
<TD><CODE><B><A HREF="#L31">SpecialHandling</A></B>(<a href="Engine.Pawn.html">Pawn</a> Other)</CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<pre>/* SpecialHandling is called by the navigation code when the next path has been found.  
It gives that path an opportunity to modify the result based on any special considerations

Here, we check if the mover needs to be triggered
*/</pre></TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;bool</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L53">SuggestMovePreparation</A></B>(<a href="Engine.Pawn.html">Pawn</a> Other)</CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<pre>/* 
Check if mover is positioned to allow Pawn to get on
*/</pre></TD></TR>
</table>

<br><br><center>
<hr/><center><FONT SIZE="-1">
Source Code</FONT>
</center><hr/>
<table width="90%" bgcolor="#000000"><tr><td><font color="#00FF00"><pre><code>
<a name="L1"><font color="white">00001</font>	//=============================================================================
<a name="L2"><font color="white">00002</font>	// LiftCenter.
<a name="L3"><font color="white">00003</font>	//=============================================================================
<a name="L4"><font color="white">00004</font>	class LiftCenter extends NavigationPoint
<a name="L5"><font color="white">00005</font>		placeable
<a name="L6"><font color="white">00006</font>		native;
<a name="L7"><font color="white">00007</font>	
<a name="L8"><font color="white">00008</font>	#exec Texture Import File=Textures\Lift_center.pcx Name=S_LiftCenter Mips=Off MASKED=1 COMPRESS=DXT1
<a name="L9"><font color="white">00009</font>	
<a name="L10"><font color="white">00010</font>	var() name LiftTag;
<a name="L11"><font color="white">00011</font>	var	 mover MyLift;
<a name="L12"><font color="white">00012</font>	var() name LiftTrigger;
<a name="L13"><font color="white">00013</font>	var trigger RecommendedTrigger;
<a name="L14"><font color="white">00014</font>	var float MaxDist2D;
<a name="L15"><font color="white">00015</font>	var vector LiftOffset;	// starting vector between MyLift location and LiftCenter location
<a name="L16"><font color="white">00016</font>	
<a name="L17"><font color="white">00017</font>	function PostBeginPlay()
<a name="L18"><font color="white">00018</font>	{
<a name="L19"><font color="white">00019</font>		// log(self$&quot; attached to &quot;$MyLift);
<a name="L20"><font color="white">00020</font>		if ( LiftTrigger != '' )
<a name="L21"><font color="white">00021</font>			ForEach DynamicActors(class'Trigger', RecommendedTrigger, LiftTrigger )
<a name="L22"><font color="white">00022</font>				break;
<a name="L23"><font color="white">00023</font>		Super.PostBeginPlay();
<a name="L24"><font color="white">00024</font>	}
<a name="L25"><font color="white">00025</font>	
<a name="L26"><font color="white">00026</font>	/* SpecialHandling is called by the navigation code when the next path has been found.  
<a name="L27"><font color="white">00027</font>	It gives that path an opportunity to modify the result based on any special considerations
<a name="L28"><font color="white">00028</font>	
<a name="L29"><font color="white">00029</font>	Here, we check if the mover needs to be triggered
<a name="L30"><font color="white">00030</font>	*/
<a name="L31"><font color="white">00031</font>	
<a name="L32"><font color="white">00032</font>	function Actor SpecialHandling(Pawn Other)
<a name="L33"><font color="white">00033</font>	{
<a name="L34"><font color="white">00034</font>		// if no lift, no special handling
<a name="L35"><font color="white">00035</font>		if ( MyLift == None )
<a name="L36"><font color="white">00036</font>			return self;
<a name="L37"><font color="white">00037</font>	
<a name="L38"><font color="white">00038</font>		// check whether or not need to trigger the lift
<a name="L39"><font color="white">00039</font>		if ( !MyLift.IsInState('StandOpenTimed') )
<a name="L40"><font color="white">00040</font>		{
<a name="L41"><font color="white">00041</font>			if ( MyLift.bClosed 
<a name="L42"><font color="white">00042</font>				&amp;&amp; (RecommendedTrigger != None) )
<a name="L43"><font color="white">00043</font>				return RecommendedTrigger;
<a name="L44"><font color="white">00044</font>		}	
<a name="L45"><font color="white">00045</font>		else if ( MyLift.BumpType == BT_PlayerBump &amp;&amp; !Other.IsPlayerPawn() )
<a name="L46"><font color="white">00046</font>			return None;
<a name="L47"><font color="white">00047</font>	
<a name="L48"><font color="white">00048</font>		return self;
<a name="L49"><font color="white">00049</font>	}
<a name="L50"><font color="white">00050</font>	
<a name="L51"><font color="white">00051</font>	/* 
<a name="L52"><font color="white">00052</font>	Check if mover is positioned to allow Pawn to get on
<a name="L53"><font color="white">00053</font>	*/
<a name="L54"><font color="white">00054</font>	function bool SuggestMovePreparation(Pawn Other)
<a name="L55"><font color="white">00055</font>	{
<a name="L56"><font color="white">00056</font>		// if already on lift, no problem 
<a name="L57"><font color="white">00057</font>		if ( Other.base == MyLift )
<a name="L58"><font color="white">00058</font>			return false;
<a name="L59"><font color="white">00059</font>	
<a name="L60"><font color="white">00060</font>		// make sure LiftCenter is correctly positioned on the lift
<a name="L61"><font color="white">00061</font>		SetLocation(MyLift.Location + LiftOffset);
<a name="L62"><font color="white">00062</font>		SetBase(MyLift);
<a name="L63"><font color="white">00063</font>	
<a name="L64"><font color="white">00064</font>		// if mover is moving, wait
<a name="L65"><font color="white">00065</font>		if ( MyLift.bInterpolating || !ProceedWithMove(Other) )
<a name="L66"><font color="white">00066</font>		{
<a name="L67"><font color="white">00067</font>			Other.Controller.WaitForMover(MyLift);
<a name="L68"><font color="white">00068</font>			return true;
<a name="L69"><font color="white">00069</font>		}
<a name="L70"><font color="white">00070</font>	
<a name="L71"><font color="white">00071</font>		return false;
<a name="L72"><font color="white">00072</font>	}
<a name="L73"><font color="white">00073</font>	
<a name="L74"><font color="white">00074</font>	function bool ProceedWithMove(Pawn Other)
<a name="L75"><font color="white">00075</font>	{
<a name="L76"><font color="white">00076</font>		local LiftExit Start;
<a name="L77"><font color="white">00077</font>		local float dist2D;
<a name="L78"><font color="white">00078</font>		local vector dir;
<a name="L79"><font color="white">00079</font>	
<a name="L80"><font color="white">00080</font>		// see if mover is at appropriate location/keyframe
<a name="L81"><font color="white">00081</font>		Start = LiftExit(Other.Anchor);
<a name="L82"><font color="white">00082</font>	
<a name="L83"><font color="white">00083</font>		if ( (Start != None) &amp;&amp; (Start.KeyFrame != 255) )
<a name="L84"><font color="white">00084</font>		{
<a name="L85"><font color="white">00085</font>			if ( MyLift.KeyNum == Start.KeyFrame )
<a name="L86"><font color="white">00086</font>				return true;
<a name="L87"><font color="white">00087</font>		}
<a name="L88"><font color="white">00088</font>		else
<a name="L89"><font color="white">00089</font>		{
<a name="L90"><font color="white">00090</font>			//check distance directly - make sure close
<a name="L91"><font color="white">00091</font>			dir = Location - Other.Location;
<a name="L92"><font color="white">00092</font>			dir.Z = 0;
<a name="L93"><font color="white">00093</font>			dist2d = vsize(dir);
<a name="L94"><font color="white">00094</font>			if ( (Location.Z - CollisionHeight &lt; Other.Location.Z - Other.CollisionHeight + MAXSTEPHEIGHT)
<a name="L95"><font color="white">00095</font>				&amp;&amp; (Location.Z - CollisionHeight &gt; Other.Location.Z - Other.CollisionHeight - 1200)
<a name="L96"><font color="white">00096</font>				&amp;&amp; ( dist2D &lt; MaxDist2D) )
<a name="L97"><font color="white">00097</font>			{
<a name="L98"><font color="white">00098</font>				return true;
<a name="L99"><font color="white">00099</font>			}
<a name="L100"><font color="white">00100</font>		}
<a name="L101"><font color="white">00101</font>	
<a name="L102"><font color="white">00102</font>		// if mover not operating, need to start it
<a name="L103"><font color="white">00103</font>		if ( MyLift.bClosed )
<a name="L104"><font color="white">00104</font>		{
<a name="L105"><font color="white">00105</font>			Other.SetMoveTarget(SpecialHandling(Other));
<a name="L106"><font color="white">00106</font>			return true;
<a name="L107"><font color="white">00107</font>		}
<a name="L108"><font color="white">00108</font>	
<a name="L109"><font color="white">00109</font>		return false;
<a name="L110"><font color="white">00110</font>	}
<a name="L111"><font color="white">00111</font>	
<a name="L112"><font color="white">00112</font>	defaultproperties
<a name="L113"><font color="white">00113</font>	{
<a name="L114"><font color="white">00114</font>	     MaxDist2D=400.000000
<a name="L115"><font color="white">00115</font>	     ExtraCost=400
<a name="L116"><font color="white">00116</font>	     bSpecialMove=True
<a name="L117"><font color="white">00117</font>	     bNoAutoConnect=True
<a name="L118"><font color="white">00118</font>	     bStatic=False
<a name="L119"><font color="white">00119</font>	     bNoDelete=True
<a name="L120"><font color="white">00120</font>	     RemoteRole=ROLE_None
<a name="L121"><font color="white">00121</font>	     Texture=Texture'Engine.S_LiftCenter'
<a name="L122"><font color="white">00122</font>	}
</code></pre></font></td></tr></table></center>
<hr/><center><FONT SIZE="-1">
End Source Code</FONT>
</center><hr/>
</BODY>
</HTML>
