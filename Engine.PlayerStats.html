<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Frameset//EN""http://www.w3.org/TR/REC-html40/frameset.dtd">
<HTML>
<HEAD>
<!--Generated by UnDox 1.0.3 Copyright (c) 2000 Epic Games. UnDox created and mainteained by Bruce Shankle - bruce@epicgames.com -->
<TITLE>
Engine.PlayerStats
</TITLE>
<LINK REL ="stylesheet" TYPE="text/css" HREF="stylesheet.css" TITLE="Style">
</HEAD>
<BODY BGCOLOR="white" vlink="#0000FF" alink="#0000FF">
<H2>
<FONT SIZE="-1">
Engine</FONT>
<BR>
Class  PlayerStats</H2>
<FONT SIZE="-1">source: C:\XIII\Engine\Classes\PlayerStats.uc</FONT>
<PRE>
<a href="Core.Object.html">Core.Object</a>
   |
   +--<a href="Engine.Actor.html">Engine.Actor</a>
      |
      +--<a href="Engine.Info.html">Engine.Info</a>
         |
         +--<b>Engine.PlayerStats</b>
</PRE>
<TABLE><TR><TD><B>Direct Known Subclasses:</B><b>None</b>
</TD></TR></TABLE>
<hr/>class <b>PlayerStats</b><br>
extends <a href="Engine.Info.html">Engine.Info</a>
<p/>
<xmp>//-----------------------------------------------------------
// Server class used to store player stats and updating rank/ladder at logout
//-----------------------------------------------------------
</xmp><br><TABLE BORDER="1" CELLPADDING="3" CELLSPACING="0" WIDTH="100%">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TD COLSPAN=2><FONT SIZE="+2">
<B>Variables</B></FONT></TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;float</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L14">EnterTimeSeconds </A></B></CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   Number of matches played </TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;float</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L15">LeaveTimeSeconds </A></B></CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   Number of matches played </TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L7">StatDeaths </A></B></CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   Number of deaths (ALL) </TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L11">StatFlagsR </A></B></CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   Flags Returned (CTF) </TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L10">StatFlagsS </A></B></CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   Flags Scored (CTF) </TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L6">StatKills </A></B></CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   Number of kills (ALL) </TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L12">StatMatchesPlayed </A></B></CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   Number of matches played </TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L9">StatMinutes </A></B></CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   Minutes Played (ALL) </TD></TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L8">StatSuicides </A></B></CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   Number of suicides (ALL) </TD></TR>
</TD></TR><TABLE><br>
<A NAME="function_summary"/>
<TABLE BORDER="1" CELLPADDING="3" CELLSPACING="0" WIDTH="100%">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TD COLSPAN=2><FONT SIZE="+2">
<B>Function Summary</B></FONT></TD>
</TR>
<br><TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="#L29">LogStats</A></B>()</CODE><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<pre>//_____________________________________________________________________________
</pre></TD></TR>
</table>

<br><br><center>
<hr/><center><FONT SIZE="-1">
Source Code</FONT>
</center><hr/>
<table width="90%" bgcolor="#000000"><tr><td><font color="#00FF00"><pre><code>
<a name="L1"><font color="white">00001</font>	//-----------------------------------------------------------
<a name="L2"><font color="white">00002</font>	// Server class used to store player stats and updating rank/ladder at logout
<a name="L3"><font color="white">00003</font>	//-----------------------------------------------------------
<a name="L4"><font color="white">00004</font>	class PlayerStats extends Info
<a name="L5"><font color="white">00005</font>	    native;
<a name="L6"><font color="white">00006</font>	
<a name="L7"><font color="white">00007</font>	var int StatKills;          // Number of kills (ALL)
<a name="L8"><font color="white">00008</font>	var int StatDeaths;         // Number of deaths (ALL)
<a name="L9"><font color="white">00009</font>	var int StatSuicides;       // Number of suicides (ALL)
<a name="L10"><font color="white">00010</font>	var int StatMinutes;        // Minutes Played (ALL)
<a name="L11"><font color="white">00011</font>	var int StatFlagsS;         // Flags Scored (CTF)
<a name="L12"><font color="white">00012</font>	var int StatFlagsR;         // Flags Returned (CTF)
<a name="L13"><font color="white">00013</font>	var int StatMatchesPlayed;  // Number of matches played
<a name="L14"><font color="white">00014</font>	
<a name="L15"><font color="white">00015</font>	var float EnterTimeSeconds;
<a name="L16"><font color="white">00016</font>	var float LeaveTimeSeconds;
<a name="L17"><font color="white">00017</font>	
<a name="L18"><font color="white">00018</font>	//var XboxLiveManager xboxlive; // ELR Useless as the controller will do the update (must be made on clients, this don't exists elsewhere than server
<a name="L19"><font color="white">00019</font>	//StatsUpdateMyStats(kills, deaths, suicides, minutes, games, gameswon, flagscapt, flagsret)
<a name="L20"><font color="white">00020</font>	
<a name="L21"><font color="white">00021</font>	//_____________________________________________________________________________
<a name="L22"><font color="white">00022</font>	event PostBeginPlay()
<a name="L23"><font color="white">00023</font>	{
<a name="L24"><font color="white">00024</font>	    Super.PostBeginPlay();
<a name="L25"><font color="white">00025</font>	    SetTimer(50.0 + frand()*20, false); // client update timer, stats will be updated on clients in this timer
<a name="L26"><font color="white">00026</font>	}
<a name="L27"><font color="white">00027</font>	
<a name="L28"><font color="white">00028</font>	/*
<a name="L29"><font color="white">00029</font>	//_____________________________________________________________________________
<a name="L30"><font color="white">00030</font>	function LogStats()
<a name="L31"><font color="white">00031</font>	{
<a name="L32"><font color="white">00032</font>	    StatMinutes = int((LeaveTimeSeconds - EnterTimeSeconds)/60.0);
<a name="L33"><font color="white">00033</font>	    Log(&quot;STATS for&quot;@Owner@&quot;::&quot;);
<a name="L34"><font color="white">00034</font>	    Log(&quot;  Kills +=&quot;@StatKills);
<a name="L35"><font color="white">00035</font>	    Log(&quot;  Deaths +=&quot;@StatDeaths);
<a name="L36"><font color="white">00036</font>	    Log(&quot;  Suicides +=&quot;@StatSuicides);
<a name="L37"><font color="white">00037</font>	    Log(&quot;  Minutes +=&quot;@StatMinutes);
<a name="L38"><font color="white">00038</font>	    Log(&quot;  Flags Scored +=&quot;@StatFlagsS);
<a name="L39"><font color="white">00039</font>	    Log(&quot;  Flags Returned +=&quot;@StatFlagsR);
<a name="L40"><font color="white">00040</font>	//    Log(&quot;  Matchs Won +=&quot;@StatMatchWon);
<a name="L41"><font color="white">00041</font>	//    Log(&quot;  Matchs Losed +=&quot;@StatMatchLost);
<a name="L42"><font color="white">00042</font>	
<a name="L43"><font color="white">00043</font>	    // ELR Don't use line below, system changed (see StatUpdate in XIIIMPPlayercontroller.uc
<a name="L44"><font color="white">00044</font>	    //xboxlive.StatsUpdateMyStats(StatKills, StatDeaths, StatSuicides, StatMinutes, 1, StatMatchWon, StatFlagsS, StatFlagsR);
<a name="L45"><font color="white">00045</font>	}
<a name="L46"><font color="white">00046</font>	*/
<a name="L47"><font color="white">00047</font>	
<a name="L48"><font color="white">00048</font>	//_____________________________________________________________________________
<a name="L49"><font color="white">00049</font>	event Timer()
<a name="L50"><font color="white">00050</font>	{ // Send stats to client playercontroller
<a name="L51"><font color="white">00051</font>	    Local string StatStr;
<a name="L52"><font color="white">00052</font>	
<a name="L53"><font color="white">00053</font>	    // the string that will be parsed on client for update
<a name="L54"><font color="white">00054</font>	    StatMinutes = int((Level.TimeSeconds - EnterTimeSeconds)/60.0);
<a name="L55"><font color="white">00055</font>	    StatStr = &quot;?KI=&quot;$StatKills
<a name="L56"><font color="white">00056</font>	      $&quot;?DE=&quot;$StatDeaths
<a name="L57"><font color="white">00057</font>	      $&quot;?SU=&quot;$StatSuicides
<a name="L58"><font color="white">00058</font>	      $&quot;?MI=&quot;$StatMinutes
<a name="L59"><font color="white">00059</font>	      $&quot;?FS=&quot;$StatFlagsS
<a name="L60"><font color="white">00060</font>	      $&quot;?FR=&quot;$StatFlagsR
<a name="L61"><font color="white">00061</font>	      $&quot;?MP=&quot;$StatMatchesPlayed;
<a name="L62"><font color="white">00062</font>	    // Send message to store stats
<a name="L63"><font color="white">00063</font>	//    Log(&quot;STATS Sending update '&quot;$StatStr$&quot;'&quot;);
<a name="L64"><font color="white">00064</font>	    PlayerController(Owner).ClientMessage(StatStr, 'STATS');
<a name="L65"><font color="white">00065</font>	
<a name="L66"><font color="white">00066</font>	    SetTimer(50.0 + frand()*20, false); // Next update
<a name="L67"><font color="white">00067</font>	}
<a name="L68"><font color="white">00068</font>	
<a name="L69"><font color="white">00069</font>	defaultproperties
<a name="L70"><font color="white">00070</font>	{
<a name="L71"><font color="white">00071</font>	     RemoteRole=ROLE_None
<a name="L72"><font color="white">00072</font>	}
</code></pre></font></td></tr></table></center>
<hr/><center><FONT SIZE="-1">
End Source Code</FONT>
</center><hr/>
</BODY>
</HTML>
